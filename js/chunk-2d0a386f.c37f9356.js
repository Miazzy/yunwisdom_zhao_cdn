(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a386f","chunk-2d0a386f","chunk-2d0a386f"],{"030f":function(n,t,e){(function(n){(function(t){"use strict";var e=function(){},o=function(n){return function(){return n()}},r=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return n(t.apply(null,e))}},i=function(n){return function(){return n}},u=function(n){return n};function a(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=t.concat(e);return n.apply(null,r)}}var c=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!n.apply(null,t)}},s=function(n){return function(){throw new Error(n)}},f=i(!1),l=i(!0),d=tinymce.util.Tools.resolve("tinymce.ThemeManager"),m=function(){return m=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var r in t=arguments[e],t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n},m.apply(this,arguments)};function g(n,t){var e={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&t.indexOf(o)<0&&(e[o]=n[o]);if(null!=n&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(e[o[r]]=n[o[r]])}return e}function p(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var o=Array(n),r=0;for(t=0;t<e;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var h,v=function(){return b},b=function(){var n=function(n){return n.isNone()},t=function(n){return n()},o=function(n){return n},r={fold:function(n,t){return n()},is:f,isSome:f,isNone:l,getOr:o,getOrThunk:t,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:o,orThunk:t,map:v,each:e,bind:v,exists:f,forall:l,filter:v,equals:n,equals_:n,toArray:function(){return[]},toString:i("none()")};return Object.freeze&&Object.freeze(r),r}(),y=function(n){var t=i(n),e=function(){return r},o=function(t){return t(n)},r={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:l,isNone:f,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return y(t(n))},each:function(t){t(n)},bind:o,exists:o,forall:o,filter:function(t){return t(n)?r:b},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(f,(function(t){return e(n,t)}))}};return r},x=function(n){return null===n||void 0===n?b:y(n)},w={some:y,none:v,from:x},S=function(n){var t=function(t){return n===t},e=function(t){return S(n)},o=function(t){return S(n)},r=function(t){return S(t(n))},u=function(t){return S(n)},a=function(t){t(n)},c=function(t){return t(n)},s=function(t,e){return e(n)},d=function(t){return t(n)},m=function(t){return t(n)},g=function(){return w.some(n)};return{is:t,isValue:l,isError:f,getOr:i(n),getOrThunk:i(n),getOrDie:i(n),or:e,orThunk:o,fold:s,map:r,mapError:u,each:a,bind:c,exists:d,forall:m,toOption:g}},C=function(n){var t=function(n){return n()},o=function(){return s(String(n))()},r=function(n){return n},i=function(n){return n()},a=function(t){return C(n)},c=function(t){return C(t(n))},d=function(t){return C(n)},m=function(t,e){return t(n)};return{is:f,isValue:f,isError:l,getOr:u,getOrThunk:t,getOrDie:o,or:r,orThunk:i,fold:m,map:a,mapError:c,each:e,bind:d,exists:f,forall:l,toOption:w.none}},k=function(n,t){return n.fold((function(){return C(t)}),S)},O={value:S,error:C,fromOption:k},_=function(n){if(null===n)return"null";var t=typeof n;return"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t},T=function(n){return function(t){return _(t)===n}},E=T("string"),B=T("object"),D=T("array"),A=T("boolean"),M=T("function"),F=T("number"),I=function(n,t){if(D(n)){for(var e=0,o=n.length;e<o;++e)if(!0!==t(n[e]))return!1;return!0}return!1},R=Array.prototype.slice,V=Array.prototype.indexOf,N=Array.prototype.push,H=function(n,t){return V.call(n,t)},P=function(n,t){var e=H(n,t);return-1===e?w.none():w.some(e)},z=function(n,t){return H(n,t)>-1},L=function(n,t){for(var e=0,o=n.length;e<o;e++){var r=n[e];if(t(r,e))return!0}return!1},j=function(n,t){for(var e=[],o=0;o<n;o++)e.push(t(o));return e},U=function(n,t){for(var e=[],o=0;o<n.length;o+=t){var r=R.call(n,o,o+t);e.push(r)}return e},W=function(n,t){for(var e=n.length,o=new Array(e),r=0;r<e;r++){var i=n[r];o[r]=t(i,r)}return o},G=function(n,t){for(var e=0,o=n.length;e<o;e++){var r=n[e];t(r,e)}},X=function(n,t){for(var e=n.length-1;e>=0;e--){var o=n[e];t(o,e)}},Y=function(n,t){for(var e=[],o=[],r=0,i=n.length;r<i;r++){var u=n[r],a=t(u,r)?e:o;a.push(u)}return{pass:e,fail:o}},q=function(n,t){for(var e=[],o=0,r=n.length;o<r;o++){var i=n[o];t(i,o)&&e.push(i)}return e},K=function(n,t,e){return X(n,(function(n){e=t(e,n)})),e},J=function(n,t,e){return G(n,(function(n){e=t(e,n)})),e},$=function(n,t){for(var e=0,o=n.length;e<o;e++){var r=n[e];if(t(r,e))return w.some(r)}return w.none()},Q=function(n,t){for(var e=0,o=n.length;e<o;e++){var r=n[e];if(t(r,e))return w.some(e)}return w.none()},Z=function(n){for(var t=[],e=0,o=n.length;e<o;++e){if(!D(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);N.apply(t,n[e])}return t},nn=function(n,t){return Z(W(n,t))},tn=function(n,t){for(var e=0,o=n.length;e<o;++e){var r=n[e];if(!0!==t(r,e))return!1}return!0},en=function(n){var t=R.call(n,0);return t.reverse(),t},on=function(n,t){return q(n,(function(n){return!z(t,n)}))},rn=function(n,t){for(var e={},o=0,r=n.length;o<r;o++){var i=n[o];e[String(i)]=t(i,o)}return e},un=function(n){return[n]},an=function(n,t){var e=R.call(n,0);return e.sort(t),e},cn=function(n){return 0===n.length?w.none():w.some(n[0])},sn=function(n){return 0===n.length?w.none():w.some(n[n.length-1])},fn=M(Array.from)?Array.from:function(n){return R.call(n)},ln=function(n,t){for(var e=0;e<n.length;e++){var o=t(n[e],e);if(o.isSome())return o}return w.none()},dn=Object.keys,mn=Object.hasOwnProperty,gn=function(n,t){for(var e=dn(n),o=0,r=e.length;o<r;o++){var i=e[o],u=n[i];t(u,i)}},pn=function(n,t){return hn(n,(function(n,e){return{k:e,v:t(n,e)}}))},hn=function(n,t){var e={};return gn(n,(function(n,o){var r=t(n,o);e[r.k]=r.v})),e},vn=function(n,t){var e=[];return gn(n,(function(n,o){e.push(t(n,o))})),e},bn=function(n,t){for(var e=dn(n),o=0,r=e.length;o<r;o++){var i=e[o],u=n[i];if(t(u,i,n))return w.some(u)}return w.none()},yn=function(n){return vn(n,(function(n){return n}))},xn=function(n,t){return wn(n,t)?w.from(n[t]):w.none()},wn=function(n,t){return mn.call(n,t)},Sn=function(n,t){return wn(n,t)&&void 0!==n[t]&&null!==n[t]},Cn=function(n){if(!D(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var e=[],o={};return G(n,(function(r,i){var u=dn(r);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=r[a];if(void 0!==o[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!D(c))throw new Error("case arguments must be an array");e.push(a),o[a]=function(){var o=arguments.length;if(o!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+o);for(var r=new Array(o),u=0;u<r.length;u++)r[u]=arguments[u];var s=function(n){var t=dn(n);if(e.length!==t.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+t.join(","));var o=tn(e,(function(n){return z(t,n)}));if(!o)throw new Error("Not all branches were specified when using match. Specified: "+t.join(", ")+"\nRequired: "+e.join(", "));return n[a].apply(null,r)};return{fold:function(){if(arguments.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+arguments.length);var t=arguments[i];return t.apply(null,r)},match:s,log:function(n){t.console.log(n,{constructors:e,constructor:a,params:r})}}}})),o},kn={generate:Cn},On=Object.prototype.hasOwnProperty,_n=function(n,t){return t},Tn=function(n,t){var e=B(n)&&B(t);return e?Bn(n,t):t},En=function(n){return function(){for(var t=new Array(arguments.length),e=0;e<t.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<t.length;r++){var i=t[r];for(var u in i)On.call(i,u)&&(o[u]=n(o[u],i[u]))}return o}},Bn=En(Tn),Dn=En(_n),An=function(n){var t,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,t=n.apply(null,o)),t}};(function(n){n[n["Error"]=0]="Error",n[n["Value"]=1]="Value"})(h||(h={}));var Mn=function(n,t,e){return n.stype===h.Error?t(n.serror):e(n.svalue)},Fn=function(n){var t=[],e=[];return G(n,(function(n){Mn(n,(function(n){return e.push(n)}),(function(n){return t.push(n)}))})),{values:t,errors:e}},In=function(n,t){return n.stype===h.Error?{stype:h.Error,serror:t(n.serror)}:n},Rn=function(n,t){return n.stype===h.Value?{stype:h.Value,svalue:t(n.svalue)}:n},Vn=function(n,t){return n.stype===h.Value?t(n.svalue):n},Nn=function(n,t){return n.stype===h.Error?t(n.serror):n},Hn=function(n){return{stype:h.Value,svalue:n}},Pn=function(n){return{stype:h.Error,serror:n}},zn=function(n){return Mn(n,O.error,O.value)},Ln=function(n){return n.fold(Pn,Hn)},jn={fromResult:Ln,toResult:zn,svalue:Hn,partition:Fn,serror:Pn,bind:Vn,bindError:Nn,map:Rn,mapError:In,fold:Mn},Un=kn.generate([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Wn=function(n){return Un.defaultedThunk(i(n))},Gn=function(n){return Un.mergeWithThunk(i(n))},Xn=Un.strict,Yn=Un.asOption,qn=Un.defaultedThunk,Kn=(Un.asDefaultedOptionThunk,Un.mergeWithThunk),Jn=function(n,t){var e={};return gn(n,(function(n,o){z(t,o)||(e[o]=n)})),e},$n=function(n,t){var e;return e={},e[n]=t,e},Qn=function(n){var t={};return G(n,(function(n){t[n.key]=n.value})),t},Zn=(kn.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n){var t=[],e=[];return G(n,(function(n){n.fold((function(n){t.push(n)}),(function(n){e.push(n)}))})),{errors:t,values:e}}),nt=function(n,t){return Jn(n,t)},tt=function(n,t){return $n(n,t)},et=function(n){return Qn(n)},ot=function(n,t){return 0===n.length?O.value(t):O.value(Bn(t,Dn.apply(void 0,n)))},rt=function(n){return O.error(Z(n))},it=function(n,t){var e=Zn(n);return e.errors.length>0?rt(e.errors):ot(e.values,t)},ut=function(n,t){return n.length>0?jn.svalue(Bn(t,Dn.apply(void 0,n))):jn.svalue(t)},at=function(n){return r(jn.serror,Z)(n)},ct=function(n,t){var e=jn.partition(n);return e.errors.length>0?at(e.errors):ut(e.values,t)},st=function(n){var t=jn.partition(n);return t.errors.length>0?at(t.errors):jn.svalue(t.values)},ft={consolidateObj:ct,consolidateArr:st},lt=function(n){return B(n)&&dn(n).length>100?" removed due to size":JSON.stringify(n,null,2)},dt=function(n){var t=n.length>10?n.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):n;return W(t,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))},mt=function(n,t){return jn.serror([{path:n,getErrorInfo:t}])},gt=function(n,t,e){return mt(n,(function(){return'Could not find valid *strict* value for "'+t+'" in '+lt(e)}))},pt=function(n,t){return mt(n,(function(){return'Choice schema did not contain choice key: "'+t+'"'}))},ht=function(n,t,e){return mt(n,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+lt(t)}))},vt=function(n,t){return mt(n,(function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"}))},bt=function(n,t){return mt(n,(function(){return t}))},yt=kn.generate([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),xt=function(n,t,e){return xn(t,e).fold((function(){return gt(n,e,t)}),jn.svalue)},wt=function(n,t,e){var o=xn(n,t).fold((function(){return e(n)}),u);return jn.svalue(o)},St=function(n,t){return jn.svalue(xn(n,t))},Ct=function(n,t,e){var o=xn(n,t).map((function(t){return!0===t?e(n):t}));return jn.svalue(o)},kt=function(n,t,e,o){return e.fold((function(e,r,u,a){var c=function(t){var i=a.extract(n.concat([e]),o,t);return jn.map(i,(function(n){return $n(r,o(n))}))},s=function(t){return t.fold((function(){var n=$n(r,o(w.none()));return jn.svalue(n)}),(function(t){var i=a.extract(n.concat([e]),o,t);return jn.map(i,(function(n){return $n(r,o(w.some(n)))}))}))};return function(){return u.fold((function(){return jn.bind(xt(n,t,e),c)}),(function(n){return jn.bind(wt(t,e,n),c)}),(function(){return jn.bind(St(t,e),s)}),(function(n){return jn.bind(Ct(t,e,n),s)}),(function(n){var o=n(t),r=jn.map(wt(t,e,i({})),(function(n){return Bn(o,n)}));return jn.bind(r,c)}))}()}),(function(n,e){var r=e(t);return jn.svalue($n(n,o(r)))}))},Ot=function(n,t,e,o){var r=W(e,(function(e){return kt(n,t,e,o)}));return ft.consolidateObj(r,{})},_t=function(n){var t=function(t,e,o){return n().extract(t,e,o)},e=function(){return n().toString()};return{extract:t,toString:e}},Tt=function(n){var t=function(t,e,o){return jn.bindError(n(o,e),(function(n){return bt(t,n)}))},e=function(){return"val"};return{extract:t,toString:e}},Et=function(n){var t=dn(n);return q(t,(function(t){return Sn(n,t)}))},Bt=function(n){var t=Dt(n),e=K(n,(function(n,t){return t.fold((function(t){return Bn(n,tt(t,!0))}),i(n))}),{}),o=function(n,o,r){var i=A(r)?[]:Et(r),u=q(i,(function(n){return!Sn(e,n)}));return 0===u.length?t.extract(n,o,r):vt(n,u)};return{extract:o,toString:t.toString}},Dt=function(n){var t=function(t,e,o){return Ot(t,o,n,e)},e=function(){var t=W(n,(function(n){return n.fold((function(n,t,e,o){return n+" -> "+o.toString()}),(function(n,t){return"state("+n+")"}))}));return"obj{\n"+t.join("\n")+"}"};return{extract:t,toString:e}},At=function(n){var t=function(t,e,o){var r=W(o,(function(o,r){return n.extract(t.concat(["["+r+"]"]),e,o)}));return ft.consolidateArr(r)},e=function(){return"array("+n.toString()+")"};return{extract:t,toString:e}},Mt=function(n){var t=function(t,e,o){for(var r=[],i=0,u=n;i<u.length;i++){var a=u[i],c=a.extract(t,e,o);if(c.stype===h.Value)return c;r.push(c)}return ft.consolidateArr(r)},e=function(){return"oneOf("+W(n,(function(n){return n.toString()})).join(", ")+")"};return{extract:t,toString:e}},Ft=function(n,t){var e=function(t,e){return At(Tt(n)).extract(t,u,e)},o=function(n,o,r){var i=dn(r),u=e(n,i);return jn.bind(u,(function(e){var i=W(e,(function(n){return yt.field(n,n,Xn(),t)}));return Dt(i).extract(n,o,r)}))},r=function(){return"setOf("+t.toString()+")"};return{extract:o,toString:r}},It=i(Tt(jn.svalue)),Rt=r(At,Dt),Vt=yt.state,Nt=yt.field,Ht=function(n,t,e,o,r){var i=xn(o,r);return i.fold((function(){return ht(n,o,r)}),(function(o){return o.extract(n.concat(["branch: "+r]),t,e)}))},Pt=function(n,t){var e=function(e,o,r){var i=xn(r,n);return i.fold((function(){return pt(e,n)}),(function(n){return Ht(e,o,r,t,n)}))},o=function(){return"chooseOn("+n+"). Possible values: "+dn(t)};return{extract:e,toString:o}},zt=Tt(jn.svalue),Lt=function(n){return Rt(n)},jt=function(){return At(zt)},Ut=_t,Wt=function(n){return Tt((function(t){return n(t).fold(jn.serror,jn.svalue)}))},Gt=function(n,t){return Ft((function(t){return jn.fromResult(n(t))}),t)},Xt=function(n,t,e,o){var r=t.extract([n],e,o);return jn.mapError(r,(function(n){return{input:o,errors:n}}))},Yt=function(n,t,e){return jn.toResult(Xt(n,t,u,e))},qt=function(n){return n.fold((function(n){throw new Error(Jt(n))}),u)},Kt=function(n,t,e){return qt(Yt(n,t,e))},Jt=function(n){return"Errors: \n"+dt(n.errors).join("\n")+"\n\nInput object: "+lt(n.input)},$t=function(n,t){return Pt(n,t)},Qt=function(n,t){return Pt(n,pn(t,Dt))},Zt=i(zt),ne=function(n,t){return Tt((function(e){var o=typeof e;return n(e)?jn.svalue(e):jn.serror("Expected type: "+t+" but got: "+o)}))},te=ne(F,"number"),ee=ne(E,"string"),oe=ne(A,"boolean"),re=ne(M,"function"),ie=function(n){var t=function(n,t){var e=n.next();while(!e.done){if(!t(e.value))return!1;e=n.next()}return!0};if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every((function(t){return ie(n[t])}));case"Map":return t(n.keys(),ie)&&t(n.values(),ie);case"Set":return t(n.keys(),ie);default:return!1}},ue=Tt((function(n){return ie(n)?jn.svalue(n):jn.serror("Expected value to be acceptable for sending via postMessage")})),ae=function(n){return Wt((function(t){return z(n,t)?O.value(t):O.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')}))},ce=function(n){return Nt(n,n,Xn(),It())},se=function(n,t){return Nt(n,n,Xn(),t)},fe=function(n){return se(n,te)},le=function(n){return se(n,ee)},de=function(n,t){return Nt(n,n,Xn(),ae(t))},me=function(n){return se(n,oe)},ge=function(n){return se(n,re)},pe=function(n,t){return Nt(n,n,Yn(),Tt((function(e){return jn.serror("The field: "+n+" is forbidden. "+t)})))},he=function(n,t){return Nt(n,n,Xn(),Dt(t))},ve=function(n,t){return Nt(n,n,Xn(),Rt(t))},be=function(n,t){return Nt(n,n,Xn(),At(t))},ye=function(n){return Nt(n,n,Yn(),It())},xe=function(n,t){return Nt(n,n,Yn(),t)},we=function(n){return xe(n,te)},Se=function(n){return xe(n,ee)},Ce=function(n){return xe(n,re)},ke=function(n,t){return xe(n,At(t))},Oe=function(n,t){return xe(n,Dt(t))},_e=function(n,t){return xe(n,Bt(t))},Te=function(n,t){return Nt(n,n,Wn(t),It())},Ee=function(n,t,e){return Nt(n,n,Wn(t),e)},Be=function(n,t){return Ee(n,t,te)},De=function(n,t){return Ee(n,t,ee)},Ae=function(n,t,e){return Ee(n,t,ae(e))},Me=function(n,t){return Ee(n,t,oe)},Fe=function(n,t){return Ee(n,t,re)},Ie=function(n,t){return Ee(n,t,ue)},Re=function(n,t,e){return Ee(n,t,At(e))},Ve=function(n,t,e){return Ee(n,t,Dt(e))},Ne=function(n,t){return Vt(n,t)},He=function(n){var t=n,e=function(){return t},o=function(n){t=n},r=function(){return He(e())};return{get:e,set:o,clone:r}},Pe=function(n,e){var o=e||t.document,r=o.createElement("div");if(r.innerHTML=n,!r.hasChildNodes()||r.childNodes.length>1)throw t.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return je(r.childNodes[0])},ze=function(n,e){var o=e||t.document,r=o.createElement(n);return je(r)},Le=function(n,e){var o=e||t.document,r=o.createTextNode(n);return je(r)},je=function(n){if(null===n||void 0===n)throw new Error("Node cannot be null or undefined");return{dom:i(n)}},Ue=function(n,t,e){var o=n.dom();return w.from(o.elementFromPoint(t,e)).map(je)},We={fromHtml:Pe,fromTag:ze,fromText:Le,fromDom:je,fromPoint:Ue},Ge=function(n,t,e){return 0!==(n.compareDocumentPosition(t)&e)},Xe=function(n,e){return Ge(n,e,t.Node.DOCUMENT_POSITION_PRECEDING)},Ye=function(n,e){return Ge(n,e,t.Node.DOCUMENT_POSITION_CONTAINED_BY)},qe={documentPositionPreceding:Xe,documentPositionContainedBy:Ye},Ke=function(n,t){for(var e=0;e<n.length;e++){var o=n[e];if(o.test(t))return o}},Je=function(n,t){var e=Ke(n,t);if(!e)return{major:0,minor:0};var o=function(n){return Number(t.replace(e,"$"+n))};return Ze(o(1),o(2))},$e=function(n,t){var e=String(t).toLowerCase();return 0===n.length?Qe():Je(n,e)},Qe=function(){return Ze(0,0)},Ze=function(n,t){return{major:n,minor:t}},no={nu:Ze,detect:$e,unknown:Qe},to="Edge",eo="Chrome",oo="IE",ro="Opera",io="Firefox",uo="Safari",ao=function(n,t){return function(){return t===n}},co=function(){return so({current:void 0,version:no.unknown()})},so=function(n){var t=n.current,e=n.version;return{current:t,version:e,isEdge:ao(to,t),isChrome:ao(eo,t),isIE:ao(oo,t),isOpera:ao(ro,t),isFirefox:ao(io,t),isSafari:ao(uo,t)}},fo={unknown:co,nu:so,edge:i(to),chrome:i(eo),ie:i(oo),opera:i(ro),firefox:i(io),safari:i(uo)},lo="Windows",mo="iOS",go="Android",po="Linux",ho="OSX",vo="Solaris",bo="FreeBSD",yo="ChromeOS",xo=function(n,t){return function(){return t===n}},wo=function(){return So({current:void 0,version:no.unknown()})},So=function(n){var t=n.current,e=n.version;return{current:t,version:e,isWindows:xo(lo,t),isiOS:xo(mo,t),isAndroid:xo(go,t),isOSX:xo(ho,t),isLinux:xo(po,t),isSolaris:xo(vo,t),isFreeBSD:xo(bo,t),isChromeOS:xo(yo,t)}},Co={unknown:wo,nu:So,windows:i(lo),ios:i(mo),android:i(go),linux:i(po),osx:i(ho),solaris:i(vo),freebsd:i(bo),chromeos:i(yo)},ko=function(n,t,e,o){var r=n.isiOS()&&!0===/ipad/i.test(e),u=n.isiOS()&&!r,a=n.isiOS()||n.isAndroid(),c=a||o("(pointer:coarse)"),s=r||!u&&a&&o("(min-device-width:768px)"),f=u||a&&!s,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),d=!f&&!s&&!l;return{isiPad:i(r),isiPhone:i(u),isTablet:i(s),isPhone:i(f),isTouch:i(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:i(l),isDesktop:i(d)}},Oo=function(n,t){var e=String(t).toLowerCase();return $(n,(function(n){return n.search(e)}))},_o=function(n,t){return Oo(n,t).map((function(n){var e=no.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},To=function(n,t){return Oo(n,t).map((function(n){var e=no.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},Eo={detectBrowser:_o,detectOs:To},Bo=function(n,t,e){if(""===t)return!0;if(n.length<t.length)return!1;var o=n.substr(e,e+t.length);return o===t},Do=function(n,t){return-1!==n.indexOf(t)},Ao=function(n,t){return Bo(n,t,n.length-t.length)},Mo=function(n){return n.replace(/^\s+|\s+$/g,"")},Fo=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Io=function(n){return function(t){return Do(t,n)}},Ro=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return Do(n,"edge/")&&Do(n,"chrome")&&Do(n,"safari")&&Do(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Fo],search:function(n){return Do(n,"chrome")&&!Do(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return Do(n,"msie")||Do(n,"trident")}},{name:"Opera",versionRegexes:[Fo,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Io("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Io("firefox")},{name:"Safari",versionRegexes:[Fo,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(Do(n,"safari")||Do(n,"mobile/"))&&Do(n,"applewebkit")}}],Vo=[{name:"Windows",search:Io("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return Do(n,"iphone")||Do(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Io("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Io("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Io("linux"),versionRegexes:[]},{name:"Solaris",search:Io("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Io("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Io("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],No={browsers:i(Ro),oses:i(Vo)},Ho=function(n,t){var e=No.browsers(),o=No.oses(),r=Eo.detectBrowser(e,n).fold(fo.unknown,fo.nu),i=Eo.detectOs(o,n).fold(Co.unknown,Co.nu),u=ko(i,r,n,t);return{browser:r,os:i,deviceType:u}},Po={detect:Ho},zo=function(n){return t.window.matchMedia(n).matches},Lo=He(Po.detect(t.navigator.userAgent,zo)),jo=function(){return Lo.get()},Uo=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE,t.Node.DOCUMENT_NODE),Wo=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),Go=t.Node.TEXT_NODE,Xo=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,Wo),Yo=Uo,qo=function(n,t){var e=n.dom();if(e.nodeType!==Xo)return!1;var o=e;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Ko=function(n){return n.nodeType!==Xo&&n.nodeType!==Yo||0===n.childElementCount},Jo=function(n,e){var o=void 0===e?t.document:e.dom();return Ko(o)?[]:W(o.querySelectorAll(n),We.fromDom)},$o=function(n,e){var o=void 0===e?t.document:e.dom();return Ko(o)?w.none():w.from(o.querySelector(n)).map(We.fromDom)},Qo=function(n,t){return n.dom()===t.dom()},Zo=function(n,t){var e=n.dom(),o=t.dom();return e!==o&&e.contains(o)},nr=function(n,t){return qe.documentPositionContainedBy(n.dom(),t.dom())},tr=jo().browser,er=tr.isIE()?nr:Zo,or=function(n,t,e){var o=n.dom(),r=M(e)?e:i(!1);while(o.parentNode){o=o.parentNode;var u=We.fromDom(o),a=t(u);if(a.isSome())return a;if(r(u))break}return w.none()},rr=function(n,t,e){var o=t(n);return o.orThunk((function(){return e(n)?w.none():or(n,t,e)}))},ir=function(n,t){return Qo(n.element(),t.event().target())},ur=function(n){if(!Sn(n,"can")&&!Sn(n,"abort")&&!Sn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return Kt("Extracting event.handler",Bt([Te("can",i(!0)),Te("abort",i(!1)),Te("run",e)]),n)},ar=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return J(n,(function(n,o){return n&&t(o).apply(void 0,e)}),!0)}},cr=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return J(n,(function(n,o){return n||t(o).apply(void 0,e)}),!1)}},sr=function(n){return M(n)?{can:i(!0),abort:i(!1),run:n}:n},fr=function(n){var t=ar(n,(function(n){return n.can})),e=cr(n,(function(n){return n.abort})),o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];G(n,(function(n){n.run.apply(void 0,t)}))};return ur({can:t,abort:e,run:o})},lr=i("touchstart"),dr=i("touchmove"),mr=i("touchend"),gr=i("touchcancel"),pr=i("mousedown"),hr=i("mousemove"),vr=i("mouseout"),br=i("mouseup"),yr=i("mouseover"),xr=i("focusin"),wr=i("focusout"),Sr=i("keydown"),Cr=i("keyup"),kr=i("input"),Or=i("change"),_r=i("click"),Tr=i("transitionend"),Er=i("selectstart"),Br={tap:i("alloy.tap")},Dr=i("alloy.focus"),Ar=i("alloy.blur.post"),Mr=i("alloy.paste.post"),Fr=i("alloy.receive"),Ir=i("alloy.execute"),Rr=i("alloy.focus.item"),Vr=Br.tap,Nr=i("alloy.longpress"),Hr=i("alloy.sandbox.close"),Pr=i("alloy.typeahead.cancel"),zr=i("alloy.system.init"),Lr=i("alloy.system.touchmove"),jr=i("alloy.system.touchend"),Ur=i("alloy.system.scroll"),Wr=i("alloy.system.resize"),Gr=i("alloy.system.attached"),Xr=i("alloy.system.detached"),Yr=i("alloy.system.dismissRequested"),qr=i("alloy.system.repositionRequested"),Kr=i("alloy.focusmanager.shifted"),Jr=i("alloy.slotcontainer.visibility"),$r=i("alloy.change.tab"),Qr=i("alloy.dismiss.tab"),Zr=i("alloy.highlight"),ni=i("alloy.dehighlight"),ti=function(n,t){ii(n,n.element(),t,{})},ei=function(n,t,e){ii(n,n.element(),t,e)},oi=function(n){ti(n,Ir())},ri=function(n,t,e){ii(n,t,e,{})},ii=function(n,t,e,o){var r=m({target:t},o);n.getSystem().triggerEvent(e,t,pn(r,i))},ui=function(n,t,e,o){n.getSystem().triggerEvent(e,t,o.event())},ai=function(n){return et(n)},ci=function(n,t){return{key:n,value:ur({abort:t})}},si=function(n,t){return{key:n,value:ur({can:t})}},fi=function(n){return{key:n,value:ur({run:function(n,t){t.event().prevent()}})}},li=function(n,t){return{key:n,value:ur({run:t})}},di=function(n,t,e){return{key:n,value:ur({run:function(n,o){t.apply(void 0,[n,o].concat(e))}})}},mi=function(n){return function(t){return li(n,t)}},gi=function(n){return function(t){return{key:n,value:ur({run:function(n,e){ir(n,e)&&t(n,e)}})}}},pi=function(n,t){return li(n,(function(e,o){e.getSystem().getByUid(t).each((function(t){ui(t,t.element(),n,o)}))}))},hi=function(n,t,e){var o=t.partUids[e];return pi(n,o)},vi=function(n,t){return li(n,(function(n,e){var o=e.event(),r=n.getSystem().getByDom(o.target()).fold((function(){var t=rr(o.target(),(function(t){return n.getSystem().getByDom(t).toOption()}),i(!1));return t.getOr(n)}),(function(n){return n}));t(n,r,e)}))},bi=function(n){return li(n,(function(n,t){t.cut()}))},yi=function(n){return li(n,(function(n,t){t.stop()}))},xi=function(n,t){return gi(n)(t)},wi=gi(Gr()),Si=gi(Xr()),Ci=gi(zr()),ki=mi(Ir()),Oi=function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(n.length!==t.length)throw new Error('Wrong number of arguments to struct. Expected "['+n.length+']", got '+t.length+" arguments");var o={};return G(n,(function(n,e){o[n]=i(t[e])})),o}},_i=function(n){return n.slice(0).sort()},Ti=function(n,t){throw new Error("All required keys ("+_i(n).join(", ")+") were not specified. Specified keys were: "+_i(t).join(", ")+".")},Ei=function(n){throw new Error("Unsupported keys for object: "+_i(n).join(", "))},Bi=function(n,t){if(!D(t))throw new Error("The "+n+" fields must be an array. Was: "+t+".");G(t,(function(t){if(!E(t))throw new Error("The value "+t+" in the "+n+" fields was not a string.")}))},Di=function(n){var t=_i(n),e=$(t,(function(n,e){return e<t.length-1&&n===t[e+1]}));e.each((function(n){throw new Error("The field: "+n+" occurs more than once in the combined fields: ["+t.join(", ")+"].")}))},Ai=function(n,t){var e=n.concat(t);if(0===e.length)throw new Error("You must specify at least one required or optional field.");return Bi("required",n),Bi("optional",t),Di(e),function(o){var r=dn(o),u=tn(n,(function(n){return z(r,n)}));u||Ti(n,r);var a=q(r,(function(n){return!z(e,n)}));a.length>0&&Ei(a);var c={};return G(n,(function(n){c[n]=i(o[n])})),G(t,(function(n){c[n]=i(Object.prototype.hasOwnProperty.call(o,n)?w.some(o[n]):w.none())})),c}},Mi=function(n){return We.fromDom(n.dom().ownerDocument)},Fi=function(n){return We.fromDom(n.dom().ownerDocument.documentElement)},Ii=function(n){return We.fromDom(n.dom().ownerDocument.defaultView)},Ri=function(n){return w.from(n.dom().parentNode).map(We.fromDom)},Vi=function(n){return w.from(n.dom().offsetParent).map(We.fromDom)},Ni=function(n){return w.from(n.dom().nextSibling).map(We.fromDom)},Hi=function(n){return W(n.dom().childNodes,We.fromDom)},Pi=function(n,t){var e=n.dom().childNodes;return w.from(e[t]).map(We.fromDom)},zi=function(n){return Pi(n,0)},Li=(Oi("element","offset"),function(n,e){var o=e||t.document,r=o.createElement("div");return r.innerHTML=n,Hi(We.fromDom(r))}),ji=function(n,t){var e=Ri(n);e.each((function(e){e.dom().insertBefore(t.dom(),n.dom())}))},Ui=function(n,t){var e=Ni(n);e.fold((function(){var e=Ri(n);e.each((function(n){Gi(n,t)}))}),(function(n){ji(n,t)}))},Wi=function(n,t){var e=zi(n);e.fold((function(){Gi(n,t)}),(function(e){n.dom().insertBefore(t.dom(),e.dom())}))},Gi=function(n,t){n.dom().appendChild(t.dom())},Xi=function(n,t,e){Pi(n,e).fold((function(){Gi(n,t)}),(function(n){ji(n,t)}))},Yi=function(n,t){G(t,(function(t){ji(n,t)}))},qi=function(n,t){G(t,(function(t){Gi(n,t)}))},Ki=function(n){n.dom().textContent="",G(Hi(n),(function(n){Ji(n)}))},Ji=function(n){var t=n.dom();null!==t.parentNode&&t.parentNode.removeChild(t)},$i=function(n){var t=Hi(n);t.length>0&&Yi(n,t),Ji(n)},Qi=function(n){return n.dom().innerHTML},Zi=function(n,t){var e=Mi(n),o=e.dom(),r=We.fromDom(o.createDocumentFragment()),i=Li(t,o);qi(r,i),Ki(n),Gi(n,r)},nu=function(n){var t=We.fromTag("div"),e=We.fromDom(n.dom().cloneNode(!0));return Gi(t,e),Qi(t)},tu=("undefined"!==typeof t.window?t.window:Function("return this;")(),function(n){var t=n.dom().nodeName;return t.toLowerCase()}),eu=function(n){return n.dom().nodeType},ou=function(n){return function(t){return eu(t)===n}},ru=ou(Wo),iu=ou(Go),uu=function(n,e,o){if(!(E(o)||A(o)||F(o)))throw t.console.error("Invalid call to Attr.set. Key ",e,":: Value ",o,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,o+"")},au=function(n,t,e){uu(n.dom(),t,e)},cu=function(n,t){var e=n.dom();gn(t,(function(n,t){uu(e,t,n)}))},su=function(n,t){var e=n.dom().getAttribute(t);return null===e?void 0:e},fu=function(n,t){return w.from(su(n,t))},lu=function(n,t){var e=n.dom();return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},du=function(n,t){n.dom().removeAttribute(t)},mu=function(n,t){return We.fromDom(n.dom().cloneNode(t))},gu=function(n){return mu(n,!1)},pu=function(n){var t=gu(n);return nu(t)},hu=function(n){return pu(n)},vu=function(n,t,e){return Qo(t,n.element())&&!Qo(t,e)},bu=ai([si(Dr(),(function(n,e){var o=e.event().originator(),r=e.event().target();return!vu(n,o,r)||(t.console.warn(Dr()+" did not get interpreted by the desired target. \nOriginator: "+hu(o)+"\nTarget: "+hu(r)+"\nCheck the "+Dr()+" event handlers"),!1)}))]),yu=Object.freeze({__proto__:null,events:bu}),xu=0,wu=function(n){var t=new Date,e=t.getTime(),o=Math.floor(1e9*Math.random());return xu++,n+"_"+o+xu+String(e)},Su=i("alloy-id-"),Cu=i("data-alloy-id"),ku=Su(),Ou=Cu(),_u=function(n,t){var e=wu(ku+n);return Tu(t,e),e},Tu=function(n,t){Object.defineProperty(n.dom(),Ou,{value:t,writable:!0})},Eu=function(n){var t=ru(n)?n.dom()[Ou]:null;return w.from(t)},Bu=function(n){return wu(n)},Du=u,Au=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+hu(n().element())+" is not in context.":""))}};return{debugInfo:i("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:i(!1)}},Mu=Au(),Fu=function(n,t,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:Iu(u.slice(0,1).concat(u.slice(3)))}},n},Iu=function(n){return W(n,(function(n){return Ao(n,"/*")?n.substring(0,n.length-"/*".length):n}))},Ru=function(n,t){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:Iu(i)}},n},Vu=function(n,t){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Iu(i.slice(1))}},n},Nu=wu("alloy-premade"),Hu=function(n){return tt(Nu,n)},Pu=function(n){return xn(n,Nu)},zu=function(n){return Vu((function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return n.apply(void 0,[t.getApis()].concat([t].concat(e)))}),n)},Lu={init:function(){return ju({readState:function(){return"No State required"}})}},ju=function(n){return n},Uu=function(n,t){var e=W(t,(function(n){return Oe(n.name(),[ce("config"),Te("state",Lu)])})),o=Yt("component.behaviours",Dt(e),n.behaviours).fold((function(t){throw new Error(Jt(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))}),(function(n){return n}));return{list:t,data:pn(o,(function(n){var t=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}));return function(){return t}}))}},Wu=function(n){return n.list},Gu=function(n){return n.data},Xu=function(n,t){var e={};return gn(n,(function(n,o){gn(n,(function(n,r){var i=xn(e,r).getOr([]);e[r]=i.concat([t(o,n)])}))})),e},Yu=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},qu=function(n,t){return m(m({},n),{attributes:m(m({},n.attributes),t.attributes),styles:m(m({},n.styles),t.styles),classes:n.classes.concat(t.classes)})},Ku=function(n,t,e,o){var r=m({},t);G(e,(function(t){r[t.name()]=t.exhibit(n,o)}));var i=Xu(r,(function(n,t){return{name:n,modification:t}})),u=function(n){return K(n,(function(n,t){return m(m({},t.modification),n)}),{})},a=K(i.classes,(function(n,t){return t.modification.concat(n)}),[]),c=u(i.attributes),s=u(i.styles);return Yu({classes:a,attributes:c,styles:s})},Ju=function(n,t,e,o){try{var r=an(e,(function(e,r){var i=e[t](),u=r[t](),a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0}));return O.value(r)}catch(i){return O.error([i])}},$u=function(n,t){return{handler:n,purpose:i(t)}},Qu=function(n,t){return{cHandler:n,purpose:i(t)}},Zu=function(n,t){return Qu(a.apply(void 0,[n.handler].concat(t)),n.purpose())},na=function(n){return n.cHandler},ta=function(n,t){return{name:i(n),handler:i(t)}},ea=function(n,t){var e={};return G(n,(function(n){e[n.name()]=n.handlers(t)})),e},oa=function(n,t,e){var o=m(m({},e),ea(t,n));return Xu(o,ta)},ra=function(n,t,e,o){var r=oa(n,e,o);return ca(r,t)},ia=function(n){var t=sr(n);return function(n,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[n,e].concat(o);t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}},ua=function(n,t){return O.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(W(t,(function(n){return n.name()})),null,2)])},aa=function(n,t,e){var o=t[e];return o?Ju("Event: "+e,"name",n,o).map((function(n){var t=W(n,(function(n){return n.handler()}));return fr(t)})):ua(e,n)},ca=function(n,t){var e=vn(n,(function(n,e){var o=1===n.length?O.value(n[0].handler()):aa(n,t,e);return o.map((function(o){var r=ia(o),i=n.length>1?q(t[e],(function(t){return L(n,(function(n){return n.name()===t}))})).join(" > "):n[0].name();return tt(e,$u(r,i))}))}));return it(e,{})},sa=function(n){return Yt("custom.definition",Dt([Nt("dom","dom",Xn(),Dt([ce("tag"),Te("styles",{}),Te("classes",[]),Te("attributes",{}),ye("value"),ye("innerHtml")])),ce("components"),ce("uid"),Te("events",{}),Te("apis",{}),Nt("eventOrder","eventOrder",Gn({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]}),Zt()),ye("domModification")]),n)},fa=function(n){return m(m({},n.dom),{uid:n.uid,domChildren:W(n.components,(function(n){return n.element()}))})},la=function(n){return n.domModification.fold((function(){return Yu({})}),Yu)},da=function(n){return n.events},ma=function(n,t){var e=su(n,t);return void 0===e||""===e?[]:e.split(" ")},ga=function(n,t,e){var o=ma(n,t),r=o.concat([e]);return au(n,t,r.join(" ")),!0},pa=function(n,t,e){var o=q(ma(n,t),(function(n){return n!==e}));return o.length>0?au(n,t,o.join(" ")):du(n,t),!1},ha=function(n){return void 0!==n.dom().classList},va=function(n){return ma(n,"class")},ba=function(n,t){return ga(n,"class",t)},ya=function(n,t){return pa(n,"class",t)},xa=function(n,t){ha(n)?n.dom().classList.add(t):ba(n,t)},wa=function(n){var t=ha(n)?n.dom().classList:va(n);0===t.length&&du(n,"class")},Sa=function(n,t){if(ha(n)){var e=n.dom().classList;e.remove(t)}else ya(n,t);wa(n)},Ca=function(n,t){return ha(n)&&n.dom().classList.contains(t)},ka=function(n,t){G(t,(function(t){xa(n,t)}))},Oa=function(n,t){G(t,(function(t){Sa(n,t)}))},_a=function(n){return void 0!==n.style&&M(n.style.getPropertyValue)},Ta=function(n){var t=iu(n)?n.dom().parentNode:n.dom();return void 0!==t&&null!==t&&t.ownerDocument.body.contains(t)},Ea=An((function(){return Ba(We.fromDom(t.document))})),Ba=function(n){var t=n.dom().body;if(null===t||void 0===t)throw new Error("Body is not available yet");return We.fromDom(t)},Da=function(n,e,o){if(!E(o))throw t.console.error("Invalid call to CSS.set. Property ",e,":: Value ",o,":: Element ",n),new Error("CSS value must be a string: "+o);_a(n)&&n.style.setProperty(e,o)},Aa=function(n,t){_a(n)&&n.style.removeProperty(t)},Ma=function(n,t,e){var o=n.dom();Da(o,t,e)},Fa=function(n,t){var e=n.dom();gn(t,(function(n,t){Da(e,t,n)}))},Ia=function(n,t){var e=n.dom();gn(t,(function(n,t){n.fold((function(){Aa(e,t)}),(function(n){Da(e,t,n)}))}))},Ra=function(n,e){var o=n.dom(),r=t.window.getComputedStyle(o),i=r.getPropertyValue(e),u=""!==i||Ta(n)?i:Va(o,e);return null===u?void 0:u},Va=function(n,t){return _a(n)?n.style.getPropertyValue(t):""},Na=function(n,t){var e=n.dom(),o=Va(e,t);return w.from(o).filter((function(n){return n.length>0}))},Ha=function(n){var t={},e=n.dom();if(_a(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);t[r]=e.style[r]}return t},Pa=function(n,t,e){var o=We.fromTag(n);Ma(o,t,e);var r=Na(o,t);return r.isSome()},za=function(n,t){var e=n.dom();Aa(e,t),lu(n,"style")&&""===Mo(su(n,"style"))&&du(n,"style")},La=function(n){return n.dom().offsetWidth},ja=function(n){return n.dom().value},Ua=function(n,t){if(void 0===t)throw new Error("Value.set was undefined");n.dom().value=t},Wa=function(n){var t=We.fromTag(n.tag);cu(t,n.attributes),ka(t,n.classes),Fa(t,n.styles),n.innerHtml.each((function(n){return Zi(t,n)}));var e=n.domChildren;return qi(t,e),n.value.each((function(n){Ua(t,n)})),n.uid,Tu(t,n.uid),t},Ga=function(n){var t=xn(n,"behaviours").getOr({}),e=q(dn(t),(function(n){return void 0!==t[n]}));return W(e,(function(n){return t[n].me}))},Xa=function(n,t){return Uu(n,t)},Ya=function(n){var t=Ga(n);return Xa(n,t)},qa=function(n,t,e){var o=fa(n),r=la(n),i={"alloy.base.modification":r},u=t.length>0?Ku(e,i,t,o):r;return qu(o,u)},Ka=function(n,t,e){var o={"alloy.base.behaviour":da(n)};return ra(e,n.eventOrder,t,o).getOrDie()},Ja=function(n){var t=function(){return y},e=He(Mu),o=qt(sa(n)),r=Ya(n),u=Wu(r),a=Gu(r),c=qa(o,u,a),s=Wa(c),f=Ka(o,u,a),l=He(o.components),d=function(n){e.set(n)},m=function(){e.set(Au(t))},g=function(){var n=Hi(s),t=nn(n,(function(n){return e.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}));l.set(t)},p=function(t){var e=a,o=M(e[t.name()])?e[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))};return o()},h=function(n){return M(a[n.name()])},v=function(){return o.apis},b=function(n){return a[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},y={getSystem:e.get,config:p,hasConfigured:h,spec:i(n),readState:b,getApis:v,connect:d,disconnect:m,element:i(s),syncComponents:g,components:l.get,events:i(f)};return y},$a=function(n){var t=xn(n,"components").getOr([]);return W(t,ec)},Qa=function(n){var t=Du(n),e=t.events,o=g(t,["events"]),r=$a(o),i=m(m({},o),{events:m(m({},yu),e),components:r});return O.value(Ja(i))},Za=function(n){var t=We.fromText(n);return nc({element:t})},nc=function(n){var t=Kt("external.component",Bt([ce("element"),ye("uid")]),n),o=He(Au()),r=function(n){o.set(n)},u=function(){o.set(Au((function(){return a})))};t.uid.each((function(n){Tu(t.element,n)}));var a={getSystem:o.get,config:w.none,hasConfigured:i(!1),connect:r,disconnect:u,getApis:function(){return{}},element:i(t.element),spec:i(n),readState:i("No state"),syncComponents:e,components:i([]),events:i({})};return Hu(a)},tc=Bu,ec=function(n){return Pu(n).fold((function(){var t=n.hasOwnProperty("uid")?n:m({uid:tc("")},n);return Qa(t).getOrDie()}),(function(n){return n}))},oc=Hu;function rc(n,t){var e=function(t,e){if(!F(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var o=t.dom();_a(o)&&(o.style[n]=e+"px")},o=function(e){var o=t(e);if(o<=0||null===o){var r=Ra(e,n);return parseFloat(r)||0}return o},r=o,i=function(n,t){return J(t,(function(t,e){var o=Ra(n,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?t:t+r}),0)},u=function(n,t,e){var o=i(n,e),r=t>o?t-o:0;return r};return{set:e,get:o,getOuter:r,aggregate:i,max:u}}var ic=rc("height",(function(n){var t=n.dom();return Ta(n)?t.getBoundingClientRect().height:t.offsetHeight})),uc=function(n){return ic.get(n)},ac=function(n){return ic.getOuter(n)},cc=function(n,t){var e=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],o=ic.max(n,t,e);Ma(n,"max-height",o+"px")},sc=function(n,t){var e=function(e,o){return sc(n+e,t+o)};return{left:i(n),top:i(t),translate:e}},fc=sc,lc=function(n){var t=n.getBoundingClientRect();return fc(t.left,t.top)},dc=function(n,t){return void 0!==n?n:void 0!==t?t:0},mc=function(n){var t=n.dom().ownerDocument,e=t.body,o=t.defaultView,r=t.documentElement;if(e===n.dom())return fc(e.offsetLeft,e.offsetTop);var i=dc(o.pageYOffset,r.scrollTop),u=dc(o.pageXOffset,r.scrollLeft),a=dc(r.clientTop,e.clientTop),c=dc(r.clientLeft,e.clientLeft);return gc(n).translate(u-c,i-a)},gc=function(n){var t=n.dom(),e=t.ownerDocument,o=e.body;return o===t?fc(o.offsetLeft,o.offsetTop):Ta(n)?lc(t):fc(0,0)},pc=rc("width",(function(n){return n.dom().offsetWidth})),hc=function(n,t){pc.set(n,t)},vc=function(n){return pc.get(n)},bc=function(n){return pc.getOuter(n)},yc=function(n,t){var e=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],o=pc.max(n,t,e);Ma(n,"max-width",o+"px")},xc=function(n,t,e,o,r,u,a){return{target:i(n),x:i(t),y:i(e),stop:o,prevent:r,kill:u,raw:i(a)}},wc=function(n){var t=We.fromDom(n.target),e=function(){n.stopPropagation()},o=function(){n.preventDefault()},i=r(o,e);return xc(t,n.clientX,n.clientY,e,o,i,n)},Sc=function(n,t){return function(e){n(e)&&t(wc(e))}},Cc=function(n,t,e,o,r){var i=Sc(e,o);return n.dom().addEventListener(t,i,r),{unbind:a(_c,n,t,i,r)}},kc=function(n,t,e,o){return Cc(n,t,e,o,!1)},Oc=function(n,t,e,o){return Cc(n,t,e,o,!0)},_c=function(n,t,e,o){n.dom().removeEventListener(t,e,o)},Tc=(jo().browser.isSafari(),function(n){var e=void 0!==n?n.dom():t.document,o=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop;return fc(o,r)}),Ec=function(n,e,o){var r=void 0!==o?o.dom():t.document,i=r.defaultView;i.scrollTo(n,e)},Bc=function(n){var e=void 0===n?t.window:n;return w.from(e["visualViewport"])},Dc=function(n,t,e,o){return{x:i(n),y:i(t),width:i(e),height:i(o),right:i(n+e),bottom:i(t+o)}},Ac=function(n){var e=void 0===n?t.window:n,o=e.document,r=Tc(We.fromDom(o));return Bc(e).fold((function(){var n=e.document.documentElement,t=n.clientWidth,o=n.clientHeight;return Dc(r.left(),r.top(),t,o)}),(function(n){return Dc(Math.max(n.pageLeft,r.left()),Math.max(n.pageTop,r.top()),n.width,n.height)}))},Mc=function(n,t){var e=n.view(t);return e.fold(i([]),(function(t){var e=n.owner(t),o=Mc(n,e);return[t].concat(o)}))},Fc=function(n,t){var e=t.owner(n),o=Mc(t,e);return w.some(o)},Ic=function(n){var e=n.dom()===t.document?w.none():w.from(n.dom().defaultView.frameElement);return e.map(We.fromDom)},Rc=function(n){return Mi(n)},Vc=Object.freeze({__proto__:null,view:Ic,owner:Rc}),Nc=function(n){var e=We.fromDom(t.document),o=Tc(e),r=Fc(n,Vc);return r.fold(a(mc,n),(function(t){var e=gc(n),r=K(t,(function(n,t){var e=gc(t);return{left:n.left+e.left(),top:n.top+e.top()}}),{left:0,top:0});return fc(r.left+e.left()+o.left(),r.top+e.top()+o.top())}))},Hc=Oi("point","width","height"),Pc=Oi("x","y","width","height"),zc=function(n,t,e,o){return{x:i(n),y:i(t),width:i(e),height:i(o),right:i(n+e),bottom:i(t+o)}},Lc=function(n){var t=mc(n),e=bc(n),o=ac(n);return zc(t.left(),t.top(),e,o)},jc=function(n){var t=Nc(n),e=bc(n),o=ac(n);return zc(t.left(),t.top(),e,o)},Uc=function(){return Ac(t.window)};function Wc(n,t,e,o,r){return n(e,o)?w.some(e):M(r)&&r(e)?w.none():t(e,o,r)}var Gc,Xc=function(n,t,e){var o=n.dom(),r=M(e)?e:i(!1);while(o.parentNode){o=o.parentNode;var u=We.fromDom(o);if(t(u))return w.some(u);if(r(u))break}return w.none()},Yc=function(n,t,e){var o=function(n,t){return t(n)};return Wc(o,Xc,n,t,e)},qc=function(n,t){var e=function(n){for(var o=0;o<n.childNodes.length;o++){var r=We.fromDom(n.childNodes[o]);if(t(r))return w.some(r);var i=e(n.childNodes[o]);if(i.isSome())return i}return w.none()};return e(n.dom())},Kc=function(n,t,e){return Yc(n,t,e).isSome()},Jc=function(n,t,e){return Xc(n,(function(n){return qo(n,t)}),e)},$c=function(n,t){return $o(t,n)},Qc=function(n,t,e){return Wc(qo,Jc,n,t,e)},Zc=function(n){var t=Yc(n,(function(n){if(!ru(n))return!1;var t=su(n,"id");return void 0!==t&&t.indexOf("aria-owns")>-1}));return t.bind((function(n){var t=su(n,"id"),e=Mi(n);return $c(e,'[aria-owns="'+t+'"]')}))},ns=function(){var n=wu("aria-owns"),t=function(t){au(t,"aria-owns",n)},e=function(n){du(n,"aria-owns")};return{id:i(n),link:t,unlink:e}},ts=function(n,t){return Zc(t).exists((function(t){return es(n,t)}))},es=function(n,t){return Kc(t,(function(t){return Qo(t,n.element())}),i(!1))||ts(n,t)},os="unknown";(function(n){n[n["STOP"]=0]="STOP",n[n["NORMAL"]=1]="NORMAL",n[n["LOGGING"]=2]="LOGGING"})(Gc||(Gc={}));var rs,is=He({}),us=function(n,e){var o=[],r=(new Date).getTime();return{logEventCut:function(n,t,e){o.push({outcome:"cut",target:t,purpose:e})},logEventStopped:function(n,t,e){o.push({outcome:"stopped",target:t,purpose:e})},logNoParent:function(n,t,e){o.push({outcome:"no-parent",target:t,purpose:e})},logEventNoHandlers:function(n,t){o.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,e){o.push({outcome:"response",purpose:e,target:t})},write:function(){var i=(new Date).getTime();z(["mousemove","mouseover","mouseout",zr()],n)||t.console.log(n,{event:n,time:i-r,target:e.dom(),sequence:W(o,(function(n){return z(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+hu(n.target)+")":n.outcome}))})}}},as=function(n,t,e){var o=xn(is.get(),n).orThunk((function(){var t=dn(is.get());return ln(t,(function(t){return n.indexOf(t)>-1?w.some(is.get()[t]):w.none()}))})).getOr(Gc.NORMAL);switch(o){case Gc.NORMAL:return e(ds());case Gc.LOGGING:var r=us(n,t),i=e(r);return r.write(),i;case Gc.STOP:return!0}},cs=["alloy/data/Fields","alloy/debugging/Debugging"],ss=function(){var n=new Error;if(void 0!==n.stack){var t=n.stack.split("\n");return $(t,(function(n){return n.indexOf("alloy")>0&&!L(cs,(function(t){return n.indexOf(t)>-1}))})).getOr(os)}return os},fs={logEventCut:e,logEventStopped:e,logNoParent:e,logEventNoHandlers:e,logEventResponse:e,write:e},ls=function(n,t,e){return as(n,t,e)},ds=i(fs),ms=i([ce("menu"),ce("selectedMenu")]),gs=i([ce("item"),ce("selectedItem")]),ps=(i(Dt(gs().concat(ms()))),i(Dt(gs()))),hs=he("initSize",[ce("numColumns"),ce("numRows")]),vs=function(){return se("markers",ps())},bs=function(){return he("markers",[ce("backgroundMenu")].concat(ms()).concat(gs()))},ys=function(n){return he("markers",W(n,ce))},xs=function(n,t,e){ss();return Nt(t,t,e,Wt((function(n){return O.value((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(void 0,t)}))})))},ws=function(n){return xs("onHandler",n,Wn(e))},Ss=function(n){return xs("onKeyboardHandler",n,Wn(w.none))},Cs=function(n){return xs("onHandler",n,Xn())},ks=function(n){return xs("onKeyboardHandler",n,Xn())},Os=function(n,t){return Ne(n,i(t))},_s=function(n){return Ne(n,u)},Ts=i(hs),Es=Oi("x","y","bubble","direction","boundsRestriction","label"),Bs=kn.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Ds=function(n,t,e,o,r,i,u,a,c){return n.fold(t,e,o,r,i,u,a,c)},As=function(n,t,e,o){return n.fold(t,t,o,o,t,o,e,e)},Ms=function(n,t,e,o){return n.fold(t,o,t,o,e,e,t,o)},Fs=Bs.southeast,Is=Bs.southwest,Rs=Bs.northeast,Vs=Bs.northwest,Ns=Bs.south,Hs=Bs.north,Ps=Bs.east,zs=Bs.west,Ls=function(n,t){switch(t){case 1:return n.x();case 0:return n.x()+n.width();case 2:return n.y();case 3:return n.y()+n.height()}},js=function(n,t){return rn(["left","right","top","bottom"],(function(e){return xn(t,e).map((function(t){return Ls(n,t)}))}))},Us=function(n,t,e){var o=function(n,o){var r="top"===n||"bottom"===n?e.top():e.left();return xn(t,n).bind(u).bind((function(t){return"left"===n||"top"===n?t>=o?w.some(t):w.none():t<=o?w.some(t):w.none()})).map((function(n){return n+r})).getOr(o)},r=o("left",n.x()),i=o("top",n.y()),a=o("right",n.right()),c=o("bottom",n.bottom());return zc(r,i,a-r,c-i)},Ws=function(n){return n.x()},Gs=function(n,t){return n.x()+n.width()/2-t.width()/2},Xs=function(n,t){return n.x()+n.width()-t.width()},Ys=function(n,t){return n.y()-t.height()},qs=function(n){return n.y()+n.height()},Ks=function(n,t){return n.y()+n.height()/2-t.height()/2},Js=function(n){return n.x()+n.width()},$s=function(n,t){return n.x()-t.width()},Qs=function(n,t,e){return Es(Ws(n),qs(n),e.southeast(),Fs(),js(n,{left:1,top:3}),"layout-se")},Zs=function(n,t,e){return Es(Xs(n,t),qs(n),e.southwest(),Is(),js(n,{right:0,top:3}),"layout-sw")},nf=function(n,t,e){return Es(Ws(n),Ys(n,t),e.northeast(),Rs(),js(n,{left:1,bottom:2}),"layout-ne")},tf=function(n,t,e){return Es(Xs(n,t),Ys(n,t),e.northwest(),Vs(),js(n,{right:0,bottom:2}),"layout-nw")},ef=function(n,t,e){return Es(Gs(n,t),Ys(n,t),e.north(),Hs(),js(n,{bottom:2}),"layout-n")},of=function(n,t,e){return Es(Gs(n,t),qs(n),e.south(),Ns(),js(n,{top:3}),"layout-s")},rf=function(n,t,e){return Es(Js(n),Ks(n,t),e.east(),Ps(),js(n,{left:0}),"layout-e")},uf=function(n,t,e){return Es($s(n,t),Ks(n,t),e.west(),zs(),js(n,{right:1}),"layout-w")},af=function(){return[Qs,Zs,nf,tf,of,ef,rf,uf]},cf=function(){return[Zs,Qs,tf,nf,of,ef,rf,uf]},sf=function(){return[nf,tf,Qs,Zs,ef,of]},ff=function(){return[tf,nf,Zs,Qs,ef,of]},lf=function(){return[Qs,Zs,nf,tf,of,ef]},df=function(){return[Zs,Qs,tf,nf,of,ef]},mf=function(n,t,e){return ki((function(o){e(o,n,t)}))},gf=function(n,t,e){return Ci((function(o,r){e(o,n,t)}))},pf=function(n,t,e,o,r,i){var u=Bt(n),a=Oe(t,[_e("config",n)]);return yf(u,a,t,e,o,r,i)},hf=function(n,t,e,o,r,i){var u=n,a=Oe(t,[xe("config",n)]);return yf(u,a,t,e,o,r,i)},vf=function(n,t,e){var o=function(o){for(var r=[],u=1;u<arguments.length;u++)r[u-1]=arguments[u];var a=[o].concat(r);return o.config({name:i(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+e)}),(function(n){var e=Array.prototype.slice.call(a,1);return t.apply(void 0,[o,n.config,n.state].concat(e))}))};return Fu(o,e,t)},bf=function(n){return{key:n,value:void 0}},yf=function(n,t,e,o,r,i,u){var c=function(n){return Sn(n,e)?n[e]():w.none()},s=pn(r,(function(n,t){return vf(e,n,t)})),f=pn(i,(function(n,t){return Ru(n,t)})),l=m(m(m({},f),s),{revoke:a(bf,e),config:function(t){var o=Kt(e+"-config",n,t);return{key:e,value:{config:o,me:l,configAsRaw:An((function(){return Kt(e+"-config",n,t)})),initialConfig:t,state:u}}},schema:function(){return t},exhibit:function(n,t){return c(n).bind((function(n){return xn(o,"exhibit").map((function(e){return e(t,n.config,n.state)}))})).getOr(Yu({}))},name:function(){return e},handlers:function(n){return c(n).map((function(n){var t=xn(o,"events").getOr((function(){return{}}));return t(n.config,n.state)})).getOr({})}});return l},xf=function(n){return et(n)},wf=Bt([ce("fields"),ce("name"),Te("active",{}),Te("apis",{}),Te("state",Lu),Te("extra",{})]),Sf=function(n){var t=Kt("Creating behaviour: "+n.name,wf,n);return pf(t.fields,t.name,t.active,t.apis,t.extra,t.state)},Cf=Bt([ce("branchKey"),ce("branches"),ce("name"),Te("active",{}),Te("apis",{}),Te("state",Lu),Te("extra",{})]),kf=function(n){var t=Kt("Creating behaviour: "+n.name,Cf,n);return hf(Qt(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},Of=i(void 0),_f=function(n,t){return t.universal()?n:q(n,(function(n){return z(t.channels(),n)}))},Tf=function(n){return ai([li(Fr(),(function(t,e){var o=n.channels,r=dn(o),i=e,u=_f(r,i);G(u,(function(n){var e=o[n],r=e.schema,u=Kt("channel["+n+"] data\nReceiver: "+hu(t.element()),r,i.data());e.onReceive(t,u)}))}))])},Ef=Object.freeze({__proto__:null,events:Tf}),Bf=[se("channels",Gt(O.value,Bt([Cs("onReceive"),Te("schema",Zt())])))],Df=Sf({fields:Bf,name:"receiving",active:Ef}),Af=function(n,t){return Yu({classes:[],styles:t.useFixed()?{}:{position:"relative"}})},Mf=Object.freeze({__proto__:null,exhibit:Af}),Ff=function(n){n.dom().focus()},If=function(n){n.dom().blur()},Rf=function(n){var t=Mi(n).dom();return n.dom()===t.activeElement},Vf=function(n){var e=void 0!==n?n.dom():t.document;return w.from(e.activeElement).map(We.fromDom)},Nf=function(n){return Vf(Mi(n)).filter((function(t){return n.dom().contains(t.dom())}))},Hf=function(n,t){var o=Mi(t),r=Vf(o).bind((function(n){var e=function(t){return Qo(n,t)};return e(t)?w.some(t):qc(t,e)})),i=n(t);return r.each((function(n){Vf(o).filter((function(t){return Qo(t,n)})).fold((function(){Ff(n)}),e)})),i},Pf=Oi("position","left","top","right","bottom"),zf=function(n,t){var e=function(n){return n+"px"};Ia(n,{position:w.some(t.position()),left:t.left().map(e),top:t.top().map(e),right:t.right().map(e),bottom:t.bottom().map(e)})},Lf=kn.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),jf=function(n,t,e,o,r,i){var u=t.x()-e,a=t.y()-o,c=t.width(),s=t.height(),f=r-(u+c),l=i-(a+s),d=w.some(u),m=w.some(a),g=w.some(f),p=w.some(l),h=w.none();return Ds(t.direction(),(function(){return Pf(n,d,m,h,h)}),(function(){return Pf(n,h,m,g,h)}),(function(){return Pf(n,d,h,h,p)}),(function(){return Pf(n,h,h,g,p)}),(function(){return Pf(n,d,m,h,h)}),(function(){return Pf(n,d,h,h,p)}),(function(){return Pf(n,d,m,h,h)}),(function(){return Pf(n,h,m,g,h)}))},Uf=function(n,t){return n.fold((function(){return Pf("absolute",w.some(t.x()),w.some(t.y()),w.none(),w.none())}),(function(n,e,o,r){return jf("absolute",t,n,e,o,r)}),(function(n,e,o,r){return jf("fixed",t,n,e,o,r)}))},Wf=function(n,t){var e=a(Nc,t),o=n.fold(e,e,(function(){var n=Tc();return Nc(t).translate(-n.left(),-n.top())})),r=bc(t),i=ac(t);return zc(o.left(),o.top(),r,i)},Gf=function(n,t){return t.fold((function(){return n.fold(Uc,Uc,zc)}),(function(t){return n.fold(t,t,(function(){var e=t(),o=Xf(n,e.x(),e.y());return zc(o.left(),o.top(),e.width(),e.height())}))}))},Xf=function(n,t,e){var o=fc(t,e),r=function(){var n=Tc();return o.translate(-n.left(),-n.top())};return n.fold(i(o),i(o),r)},Yf=function(n,t,e,o){return n.fold(t,e,o)},qf=(Lf.none,Lf.relative),Kf=Lf.fixed,Jf=Oi("anchorBox","origin"),$f=function(n,t){return Jf(n,t)},Qf=function(n,t,e,o){var r=n+t;return r>o?e:r<e?o:r},Zf=function(n,t,e){return Math.min(Math.max(n,t),e)},nl=Ai(["x","y","width","height","maxHeight","maxWidth","direction","classes","label","candidateYforTest"],[]),tl=kn.generate([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),el=function(n,t,e,o,r){var i=r.x(),u=r.y(),a=r.width(),c=r.height(),s=n>=i,f=t>=u,l=s&&f,d=n+e<=i+a,m=t+o<=u+c,g=d&&m,p=Math.abs(Math.min(e,s?i+a-n:i-(n+e))),h=Math.abs(Math.min(o,f?u+c-t:u-(t+o))),v=Math.max(r.x(),r.right()-e),b=Math.max(r.y(),r.bottom()-o),y=Zf(n,r.x(),v),x=Zf(t,r.y(),b);return{originInBounds:l,sizeInBounds:g,limitX:y,limitY:x,deltaW:p,deltaH:h}},ol=function(n,t,e,o){var r=n.x(),u=n.y(),a=n.bubble().offset(),c=a.left(),s=a.top(),f=Us(o,n.boundsRestriction(),a),l=f.y(),d=f.bottom(),m=f.x(),g=f.right(),p=r+c,h=u+s,v=el(p,h,t,e,f),b=v.originInBounds,y=v.sizeInBounds,x=v.limitX,w=v.limitY,S=v.deltaW,C=v.deltaH,k=i(w+C-l),O=i(d-w),_=As(n.direction(),O,O,k),T=i(x+S-m),E=i(g-x),B=Ms(n.direction(),E,E,T),D=nl({x:x,y:w,width:S,height:C,maxHeight:_,maxWidth:B,direction:n.direction(),classes:{on:n.bubble().classesOn(),off:n.bubble().classesOff()},label:n.label(),candidateYforTest:h});return b&&y?tl.fit(D):tl.nofit(D,S,C)},rl=function(n,t,e,o,r){var i=e.width(),c=e.height(),s=function(n,u,a,s){var f=n(t,e,o),l=ol(f,i,c,r);return l.fold(tl.fit,(function(n,t,e){var o=e>s||t>a;return o?tl.nofit(n,t,e):tl.nofit(u,a,s)}))},f=J(n,(function(n,t){var e=a(s,t);return n.fold(tl.fit,e)}),tl.nofit(nl({x:t.x(),y:t.y(),width:e.width(),height:e.height(),maxHeight:e.height(),maxWidth:e.width(),direction:Fs(),classes:{on:[],off:[]},label:"none",candidateYforTest:t.y()}),-1,-1));return f.fold(u,u)},il=function(n){return{width:i(bc(n)),height:i(ac(n))}},ul=function(n,t,e,o){za(t,"max-height"),za(t,"max-width");var r=il(t);return rl(o.preference(),n,r,e,o.bounds())},al=function(n,t){var e=t.classes();Oa(n,e.off),ka(n,e.on)},cl=function(n,t,e){var o=e.maxHeightFunction();o(n,t.maxHeight())},sl=function(n,t,e){var o=e.maxWidthFunction();o(n,t.maxWidth())},fl=function(n,t,e){zf(n,Uf(e.origin(),t))},ll=function(n,t){cc(n,Math.floor(t))},dl=i((function(n,t){ll(n,t),Fa(n,{"overflow-x":"hidden","overflow-y":"auto"})})),ml=i((function(n,t){ll(n,t)})),gl=Ai(["bounds","origin","preference","maxHeightFunction","maxWidthFunction"],[]),pl=function(n,t,e){return void 0===n[t]?e:n[t]},hl=function(n,t,o,r,i,u){var a=pl(u,"maxHeightFunction",dl()),c=pl(u,"maxWidthFunction",e),s=n.anchorBox(),f=n.origin(),l=gl({bounds:Gf(f,i),origin:f,preference:r,maxHeightFunction:a,maxWidthFunction:c});vl(s,t,o,l)},vl=function(n,t,e,o){var r=ul(n,t,e,o);fl(t,r,o),al(t,r),cl(t,r,o),sl(t,r,o)},bl=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],yl=function(n,t,e){var o=function(n){return xn(e,n).getOr([])},r=function(n,t,e){var r=on(bl,e);return{offset:function(){return fc(n,t)},classesOn:function(){return nn(e,o)},classesOff:function(){return nn(r,o)}}};return{southeast:function(){return r(-n,t,["top","alignLeft"])},southwest:function(){return r(n,t,["top","alignRight"])},south:function(){return r(-n/2,t,["top","alignCentre"])},northeast:function(){return r(-n,-t,["bottom","alignLeft"])},northwest:function(){return r(n,-t,["bottom","alignRight"])},north:function(){return r(-n/2,-t,["bottom","alignCentre"])},east:function(){return r(n,-t/2,["valignCentre","left"])},west:function(){return r(-n,-t/2,["valignCentre","right"])},innerNorthwest:function(){return r(-n,t,["top","alignRight"])},innerNortheast:function(){return r(n,t,["top","alignLeft"])},innerNorth:function(){return r(-n/2,t,["top","alignCentre"])},innerSouthwest:function(){return r(-n,-t,["bottom","alignRight"])},innerSoutheast:function(){return r(n,-t,["bottom","alignLeft"])},innerSouth:function(){return r(-n/2,-t,["bottom","alignCentre"])},innerWest:function(){return r(n,-t/2,["valignCentre","right"])},innerEast:function(){return r(-n,-t/2,["valignCentre","left"])}}},xl=function(){return yl(0,0,{})},wl=function(n){return n},Sl=function(n,t){return function(e){return"rtl"===Cl(e)?t:n}},Cl=function(n){return"rtl"===Ra(n,"direction")?"rtl":"ltr"};(function(n){n["TopToBottom"]="toptobottom",n["BottomToTop"]="bottomtotop"})(rs||(rs={}));var kl="data-alloy-vertical-dir",Ol=function(n){return Kc(n,(function(n){return ru(n)&&su(n,kl)===rs.BottomToTop}))},_l=function(){return Oe("layouts",[ce("onLtr"),ce("onRtl"),ye("onBottomLtr"),ye("onBottomRtl")])},Tl=function(n,t,e,o,r,i,u){var a=u.map(Ol).getOr(!1),c=t.layouts.map((function(t){return t.onLtr(n)})),s=t.layouts.map((function(t){return t.onRtl(n)})),f=a?t.layouts.bind((function(t){return t.onBottomLtr.map((function(t){return t(n)}))})).or(c).getOr(r):c.getOr(e),l=a?t.layouts.bind((function(t){return t.onBottomRtl.map((function(t){return t(n)}))})).or(s).getOr(i):s.getOr(o),d=Sl(f,l);return d(n)},El=function(n,t,e){var o=t.hotspot,r=Wf(e,o.element()),i=Tl(n.element(),t,lf(),df(),sf(),ff(),w.some(t.hotspot.element()));return w.some(wl({anchorBox:r,bubble:t.bubble.getOr(xl()),overrides:t.overrides,layouts:i,placer:w.none()}))},Bl=[ce("hotspot"),ye("bubble"),Te("overrides",{}),_l(),Os("placement",El)],Dl=function(n,t,e){var o=Xf(e,t.x,t.y),r=zc(o.left(),o.top(),t.width,t.height),i=Tl(n.element(),t,af(),cf(),af(),cf(),w.none());return w.some(wl({anchorBox:r,bubble:t.bubble,overrides:t.overrides,layouts:i,placer:w.none()}))},Al=[ce("x"),ce("y"),Te("height",0),Te("width",0),Te("bubble",xl()),Te("overrides",{}),_l(),Os("placement",Dl)],Ml="\ufeff",Fl="",Il=Oi("start","soffset","finish","foffset"),Rl={create:Il},Vl=kn.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Nl=function(n,t,e,o){return n.fold(t,e,o)},Hl=function(n){return n.fold(u,u,u)},Pl=Vl.before,zl=Vl.on,Ll=Vl.after,jl={before:Pl,on:zl,after:Ll,cata:Nl,getStart:Hl},Ul=kn.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Wl=function(n){return Ul.exact(n.start(),n.soffset(),n.finish(),n.foffset())},Gl=function(n){return n.match({domRange:function(n){return We.fromDom(n.startContainer)},relative:function(n,t){return jl.getStart(n)},exact:function(n,t,e,o){return n}})},Xl=Ul.domRange,Yl=Ul.relative,ql=Ul.exact,Kl=function(n){var t=Gl(n);return Ii(t)},Jl=Rl.create,$l={domRange:Xl,relative:Yl,exact:ql,exactFromRange:Wl,getWin:Kl,range:Jl},Ql=function(n,t){t.fold((function(t){n.setStartBefore(t.dom())}),(function(t,e){n.setStart(t.dom(),e)}),(function(t){n.setStartAfter(t.dom())}))},Zl=function(n,t){t.fold((function(t){n.setEndBefore(t.dom())}),(function(t,e){n.setEnd(t.dom(),e)}),(function(t){n.setEndAfter(t.dom())}))},nd=function(n,t,e){var o=n.document.createRange();return Ql(o,t),Zl(o,e),o},td=function(n,t,e,o,r){var i=n.document.createRange();return i.setStart(t.dom(),e),i.setEnd(o.dom(),r),i},ed=function(n){return{left:i(n.left),top:i(n.top),right:i(n.right),bottom:i(n.bottom),width:i(n.width),height:i(n.height)}},od=function(n){var t=n.getClientRects(),e=t.length>0?t[0]:n.getBoundingClientRect();return e.width>0||e.height>0?w.some(e).map(ed):w.none()},rd=kn.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),id=function(n,t,e){return t(We.fromDom(e.startContainer),e.startOffset,We.fromDom(e.endContainer),e.endOffset)},ud=function(n,t){return t.match({domRange:function(n){return{ltr:i(n),rtl:w.none}},relative:function(t,e){return{ltr:An((function(){return nd(n,t,e)})),rtl:An((function(){return w.some(nd(n,e,t))}))}},exact:function(t,e,o,r){return{ltr:An((function(){return td(n,t,e,o,r)})),rtl:An((function(){return w.some(td(n,o,r,t,e))}))}}})},ad=function(n,t){var e=t.ltr();if(e.collapsed){var o=t.rtl().filter((function(n){return!1===n.collapsed}));return o.map((function(n){return rd.rtl(We.fromDom(n.endContainer),n.endOffset,We.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return id(n,rd.ltr,e)}))}return id(n,rd.ltr,e)},cd=function(n,t){var e=ud(n,t);return ad(n,e)},sd=function(n,t){var e=cd(n,t);return e.match({ltr:function(t,e,o,r){var i=n.document.createRange();return i.setStart(t.dom(),e),i.setEnd(o.dom(),r),i},rtl:function(t,e,o,r){var i=n.document.createRange();return i.setStart(o.dom(),r),i.setEnd(t.dom(),e),i}})};rd.ltr,rd.rtl;function fd(n,t){var e=function(e){if(!n(e))throw new Error("Can only get "+t+" value of a "+t+" node");return o(e).getOr("")},o=function(t){return n(t)?w.from(t.dom().nodeValue):w.none()},r=function(e,o){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node");e.dom().nodeValue=o};return{get:e,getOption:o,set:r}}var ld=fd(iu,"text"),dd=function(n){return ld.get(n)},md=function(n){return ld.getOption(n)},gd=function(n){return"img"===tu(n)?1:md(n).fold((function(){return Hi(n).length}),(function(n){return n.length}))},pd=function(n){return md(n).filter((function(n){return 0!==n.trim().length||n.indexOf(Fl)>-1})).isSome()},hd=["img","br"],vd=function(n){var t=pd(n);return t||z(hd,tu(n))},bd=function(n){return yd(n,vd)},yd=function(n,t){var e=function(n){for(var o=Hi(n),r=o.length-1;r>=0;r--){var i=o[r];if(t(i))return w.some(i);var u=e(i);if(u.isSome())return u}return w.none()};return e(n)},xd=function(n,t){return Jo(t,n)},wd=function(n,t,e,o){var r=Mi(n),i=r.dom().createRange();return i.setStart(n.dom(),t),i.setEnd(e.dom(),o),i},Sd=function(n,t,e,o){var r=wd(n,t,e,o),i=Qo(n,e)&&t===o;return r.collapsed&&!i},Cd=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return w.some(Rl.create(We.fromDom(t.startContainer),t.startOffset,We.fromDom(e.endContainer),e.endOffset))}return w.none()},kd=function(n){var t=We.fromDom(n.anchorNode),e=We.fromDom(n.focusNode);return Sd(t,n.anchorOffset,e,n.focusOffset)?w.some(Rl.create(t,n.anchorOffset,e,n.focusOffset)):Cd(n)},Od=function(n){return w.from(n.getSelection()).filter((function(n){return n.rangeCount>0})).bind(kd)},_d=function(n,t){var e=sd(n,t);return od(e)},Td=Oi("element","offset"),Ed=function(n,t){var e=Hi(n);if(0===e.length)return Td(n,t);if(t<e.length)return Td(e[t],0);var o=e[e.length-1],r=iu(o)?dd(o).length:Hi(o).length;return Td(o,r)},Bd=kn.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Dd=function(n){return n.fold(u,(function(n,t,e){return n.translate(-t,-e)}))},Ad=function(n){return n.fold(u,u)},Md=function(n){return J(n,(function(n,t){return n.translate(t.left(),t.top())}),fc(0,0))},Fd=function(n){var t=W(n,Dd);return Md(t)},Id=function(n){var t=W(n,Ad);return Md(t)},Rd=Bd.screen,Vd=Bd.absolute,Nd=function(n,t,e){var o=Ii(e.root).dom(),r=function(t){var e=Mi(t),o=Mi(n.element());return Qo(e,o)};return w.from(o.frameElement).map(We.fromDom).filter(r).map(mc)},Hd=function(n,t,e){var o=Mi(n.element()),r=Tc(o),i=Nd(n,t,e).getOr(r);return Vd(i,r.left(),r.top())},Pd=function(n,t,e,o){var r=n,i=t,u=e,a=o;n<0&&(r=0,u=e+n),t<0&&(i=0,a=o+t);var c=Rd(fc(r,i));return w.some(Hc(c,u,a))},zd=function(n,t,e,o,r){return n.map((function(n){var i=[t,n.point()],u=Yf(o,(function(){return Id(i)}),(function(){return Id(i)}),(function(){return Fd(i)})),a=Pc(u.left(),u.top(),n.width(),n.height()),c=e.showAbove?sf():lf(),s=(e.showAbove,df()),f=Tl(r,e,c,s,c,s,w.none());return wl({anchorBox:a,bubble:e.bubble.getOr(xl()),overrides:e.overrides,layouts:f,placer:w.none()})}))},Ld={capRect:Pd,calcNewAnchor:zd},jd=Oi("element","offset"),Ud=function(n,t){return iu(n)?jd(n,t):Ed(n,t)},Wd=function(n,t){var e=t.getSelection.getOrThunk((function(){return function(){return Od(n)}}));return e().map((function(n){var t=Ud(n.start(),n.soffset()),e=Ud(n.finish(),n.foffset());return $l.range(t.element(),t.offset(),e.element(),e.offset())}))},Gd=function(n,t,e){var o=Ii(t.root).dom(),r=Hd(n,e,t),i=Wd(o,t).bind((function(n){var t=_d(o,$l.exactFromRange(n)).orThunk((function(){var t=We.fromText(Ml);return ji(n.start(),t),_d(o,$l.exact(t,0,t,1)).map((function(n){return Ji(t),n}))}));return t.bind((function(n){return Ld.capRect(n.left(),n.top(),n.width(),n.height())}))})),u=Wd(o,t).bind((function(n){return ru(n.start())?w.some(n.start()):Ri(n.start())})),a=u.getOr(n.element());return Ld.calcNewAnchor(i,r,t,e,a)},Xd=[ye("getSelection"),ce("root"),ye("bubble"),_l(),Te("overrides",{}),Te("showAbove",!1),Os("placement",Gd)],Yd=function(n,t,e){var o=Hd(n,e,t);return t.node.bind((function(r){var i=r.dom().getBoundingClientRect(),u=Ld.capRect(i.left,i.top,i.width,i.height),a=t.node.getOr(n.element());return Ld.calcNewAnchor(u,o,t,e,a)}))},qd=[ce("node"),ce("root"),ye("bubble"),_l(),Te("overrides",{}),Te("showAbove",!1),Os("placement",Yd)],Kd=function(n){return n.x()+n.width()},Jd=function(n,t){return n.x()-t.width()},$d=function(n,t){return n.y()-t.height()+n.height()},Qd=function(n){return n.y()},Zd=function(n,t,e){return Es(Kd(n),Qd(n),e.southeast(),Fs(),js(n,{left:0,top:2}),"link-layout-se")},nm=function(n,t,e){return Es(Jd(n,t),Qd(n),e.southwest(),Is(),js(n,{right:1,top:2}),"link-layout-sw")},tm=function(n,t,e){return Es(Kd(n),$d(n,t),e.northeast(),Rs(),js(n,{left:0,bottom:3}),"link-layout-ne")},em=function(n,t,e){return Es(Jd(n,t),$d(n,t),e.northwest(),Vs(),js(n,{right:1,bottom:3}),"link-layout-nw")},om=function(){return[Zd,nm,tm,em]},rm=function(){return[nm,Zd,em,tm]},im=function(n,t,e){var o=Wf(e,t.item.element()),r=Tl(n.element(),t,om(),rm(),om(),rm(),w.none());return w.some(wl({anchorBox:o,bubble:xl(),overrides:t.overrides,layouts:r,placer:w.none()}))},um=[ce("item"),_l(),Te("overrides",{}),Os("placement",im)],am=Qt("anchor",{selection:Xd,node:qd,hotspot:Bl,submenu:um,makeshift:Al}),cm=function(){var n=t.document.documentElement;return Kf(0,0,n.clientWidth,n.clientHeight)},sm=function(n){var t=mc(n.element()),e=n.element().dom().getBoundingClientRect();return qf(t.left(),t.top(),e.width,e.height)},fm=function(n,t,e,o,r){var i=$f(e.anchorBox,t);hl(i,r.element(),e.bubble,e.layouts,o,e.overrides)},lm=function(n,t,e,o,r){dm(n,t,e,o,r,w.none())},dm=function(n,t,e,o,r,i){var u=i.map(Lc);return mm(n,t,e,o,r,u)},mm=function(n,t,e,o,r,u){var a=Kt("positioning anchor.info",am,o);Hf((function(){Ma(r.element(),"position","fixed");var e=Na(r.element(),"visibility");Ma(r.element(),"visibility","hidden");var o=t.useFixed()?cm():sm(n),c=a.placement,s=u.map(i).or(t.getBounds);c(n,a,o).each((function(t){var e=t.placer.getOr(fm);e(n,o,t,s,r)})),e.fold((function(){za(r.element(),"visibility")}),(function(n){Ma(r.element(),"visibility",n)})),Na(r.element(),"left").isNone()&&Na(r.element(),"top").isNone()&&Na(r.element(),"right").isNone()&&Na(r.element(),"bottom").isNone()&&Na(r.element(),"position").is("fixed")&&za(r.element(),"position")}),r.element())},gm=function(n,t,e){return t.useFixed()?"fixed":"absolute"},pm=Object.freeze({__proto__:null,position:lm,positionWithin:dm,positionWithinBounds:mm,getMode:gm}),hm=[Te("useFixed",f),ye("getBounds")],vm=Sf({fields:hm,name:"positioning",active:Mf,apis:pm}),bm=function(n){ti(n,Xr());var t=n.components();G(t,bm)},ym=function(n){var t=n.components();G(t,ym),ti(n,Gr())},xm=function(n,t){Gi(n.element(),t.element())},wm=function(n){G(n.components(),(function(n){return Ji(n.element())})),Ki(n.element()),n.syncComponents()},Sm=function(n,t){var e=n.components();wm(n);var o=on(e,t);G(o,(function(t){bm(t),n.getSystem().removeFromWorld(t)})),G(t,(function(t){t.getSystem().isConnected()?xm(n,t):(n.getSystem().addToWorld(t),xm(n,t),Ta(n.element())&&ym(t)),n.syncComponents()}))},Cm=function(n,t){km(n,t,Gi)},km=function(n,t,e){n.getSystem().addToWorld(t),e(n.element(),t.element()),Ta(n.element())&&ym(t),n.syncComponents()},Om=function(n){bm(n),Ji(n.element()),n.getSystem().removeFromWorld(n)},_m=function(n){var t=Ri(n.element()).bind((function(t){return n.getSystem().getByDom(t).toOption()}));Om(n),t.each((function(n){n.syncComponents()}))},Tm=function(n){var t=n.components();G(t,Om),Ki(n.element()),n.syncComponents()},Em=function(n,t){Dm(n,t,Gi)},Bm=function(n,t){Dm(n,t,Ui)},Dm=function(n,t,e){e(n,t.element());var o=Hi(t.element());G(o,(function(n){t.getByDom(n).each(ym)}))},Am=function(n){var t=Hi(n.element());G(t,(function(t){n.getByDom(t).each(bm)})),Ji(n.element())},Mm=function(n,t,e,o){e.get().each((function(t){Tm(n)}));var r=t.getAttachPoint(n);Cm(r,n);var i=n.getSystem().build(o);return Cm(n,i),e.set(i),i},Fm=function(n,t,e,o){var r=Mm(n,t,e,o);return t.onOpen(n,r),r},Im=function(n,t,e,o){return e.get().map((function(){return Mm(n,t,e,o)}))},Rm=function(n,t,e,o,r){jm(n,t),Fm(n,t,e,o),r(),Wm(n,t)},Vm=function(n,t,e){e.get().each((function(o){Tm(n),_m(n),t.onClose(n,o),e.clear()}))},Nm=function(n,t,e){return e.isOpen()},Hm=function(n,t,e,o){return Nm(n,t,e)&&e.get().exists((function(e){return t.isPartOf(n,e,o)}))},Pm=function(n,t,e){return e.get()},zm=function(n,t,e,o){Na(n.element(),t).fold((function(){du(n.element(),e)}),(function(t){au(n.element(),e,t)})),Ma(n.element(),t,o)},Lm=function(n,t,e){if(lu(n.element(),e)){var o=su(n.element(),e);Ma(n.element(),t,o)}else za(n.element(),t)},jm=function(n,t,e){var o=t.getAttachPoint(n);Ma(n.element(),"position",vm.getMode(o)),zm(n,"visibility",t.cloakVisibilityAttr,"hidden")},Um=function(n){return L(["top","left","right","bottom"],(function(t){return Na(n,t).isSome()}))},Wm=function(n,t,e){Um(n.element())||za(n.element(),"position"),Lm(n,"visibility",t.cloakVisibilityAttr)},Gm=Object.freeze({__proto__:null,cloak:jm,decloak:Wm,open:Fm,openWhileCloaked:Rm,close:Vm,isOpen:Nm,isPartOf:Hm,getState:Pm,setContent:Im}),Xm=function(n,t){return ai([li(Hr(),(function(e,o){Vm(e,n,t)}))])},Ym=Object.freeze({__proto__:null,events:Xm}),qm=[ws("onOpen"),ws("onClose"),ce("isPartOf"),ce("getAttachPoint"),Te("cloakVisibilityAttr","data-precloak-visibility")],Km=function(){var n=He(w.none()),t=i("not-implemented"),e=function(){return n.get().isSome()},o=function(t){n.set(w.some(t))},r=function(){return n.get()},u=function(){n.set(w.none())};return ju({readState:t,isOpen:e,clear:u,set:o,get:r})},Jm=Object.freeze({__proto__:null,init:Km}),$m=Sf({fields:qm,name:"sandboxing",active:Ym,apis:Gm,state:Jm}),Qm=i("dismiss.popups"),Zm=i("reposition.popups"),ng=i("mouse.released"),tg=Bt([Te("isExtraPart",i(!1)),Oe("fireEventInstead",[Te("event",Yr())])]),eg=function(n){var t,e=Kt("Dismissal",tg,n);return t={},t[Qm()]={schema:Bt([ce("target")]),onReceive:function(n,t){if($m.isOpen(n)){var o=$m.isPartOf(n,t.target)||e.isExtraPart(n,t.target);o||e.fireEventInstead.fold((function(){return $m.close(n)}),(function(t){return ti(n,t.event)}))}}},t},og=Bt([Oe("fireEventInstead",[Te("event",qr())]),ge("doReposition")]),rg=function(n){var t,e=Kt("Reposition",og,n);return t={},t[Zm()]={onReceive:function(n){$m.isOpen(n)&&e.fireEventInstead.fold((function(){return e.doReposition(n)}),(function(t){return ti(n,t.event)}))}},t},ig=function(n,t,e){t.store.manager.onLoad(n,t,e)},ug=function(n,t,e){t.store.manager.onUnload(n,t,e)},ag=function(n,t,e,o){t.store.manager.setValue(n,t,e,o)},cg=function(n,t,e){return t.store.manager.getValue(n,t,e)},sg=function(n,t,e){return e},fg=Object.freeze({__proto__:null,onLoad:ig,onUnload:ug,setValue:ag,getValue:cg,getState:sg}),lg=function(n,t){var e=n.resetOnDom?[wi((function(e,o){ig(e,n,t)})),Si((function(e,o){ug(e,n,t)}))]:[gf(n,t,ig)];return ai(e)},dg=Object.freeze({__proto__:null,events:lg}),mg=function(){var n=He(null),t=function(){return{mode:"memory",value:n.get()}},e=function(){return null===n.get()},o=function(){n.set(null)};return ju({set:n.set,get:n.get,isNotSet:e,clear:o,readState:t})},gg=function(){var n=function(){};return ju({readState:n})},pg=function(){var n=He({}),t=He({}),e=function(){return{mode:"dataset",dataByValue:n.get(),dataByText:t.get()}},o=function(){n.set({}),t.set({})},r=function(e){return xn(n.get(),e).orThunk((function(){return xn(t.get(),e)}))},i=function(e){var o=n.get(),r=t.get(),i={},u={};G(e,(function(n){i[n.value]=n,xn(n,"meta").each((function(t){xn(t,"text").each((function(t){u[t]=n}))}))})),n.set(m(m({},o),i)),t.set(m(m({},r),u))};return ju({readState:e,lookup:r,update:i,clear:o})},hg=function(n){return n.store.manager.state(n)},vg=Object.freeze({__proto__:null,memory:mg,dataset:pg,manual:gg,init:hg}),bg=function(n,t,e,o){var r=t.store;e.update([o]),r.setValue(n,o),t.onSetValue(n,o)},yg=function(n,t,e){var o=t.store,r=o.getDataKey(n);return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(n){return n}))},xg=function(n,t,e){var o=t.store;o.initialValue.each((function(o){bg(n,t,e,o)}))},wg=function(n,t,e){e.clear()},Sg=[ye("initialValue"),ce("getFallbackEntry"),ce("getDataKey"),ce("setValue"),Os("manager",{setValue:bg,getValue:yg,onLoad:xg,onUnload:wg,state:pg})],Cg=function(n,t,e){return t.store.getValue(n)},kg=function(n,t,e,o){t.store.setValue(n,o),t.onSetValue(n,o)},Og=function(n,t,e){t.store.initialValue.each((function(e){t.store.setValue(n,e)}))},_g=[ce("getValue"),Te("setValue",e),ye("initialValue"),Os("manager",{setValue:kg,getValue:Cg,onLoad:Og,onUnload:e,state:Lu.init})],Tg=function(n,t,e,o){e.set(o),t.onSetValue(n,o)},Eg=function(n,t,e){return e.get()},Bg=function(n,t,e){t.store.initialValue.each((function(n){e.isNotSet()&&e.set(n)}))},Dg=function(n,t,e){e.clear()},Ag=[ye("initialValue"),Os("manager",{setValue:Tg,getValue:Eg,onLoad:Bg,onUnload:Dg,state:mg})],Mg=[Ee("store",{mode:"memory"},Qt("mode",{memory:Ag,manual:_g,dataset:Sg})),ws("onSetValue"),Te("resetOnDom",!1)],Fg=Sf({fields:Mg,name:"representing",active:dg,apis:fg,extra:{setValueFrom:function(n,t){var e=Fg.getValue(t);Fg.setValue(n,e)}},state:vg}),Ig=function(n,t){return Ve(n,{},W(t,(function(t){return pe(t.name(),"Cannot configure "+t.name()+" for "+n)})).concat([Ne("dump",u)]))},Rg=function(n){return n.dump},Vg=function(n,t){return m(m({},n.dump),xf(t))},Ng={field:Ig,augment:Vg,get:Rg},Hg="placeholder",Pg=kn.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),zg=function(n){return wn(n,"uiType")},Lg=function(n,t,e,o){return n.exists((function(n){return n!==e.owner}))?Pg.single(!0,i(e)):xn(o,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+dn(o)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(n){return n.replace()}))},jg=function(n,t,e,o){return zg(e)&&e.uiType===Hg?Lg(n,t,e,o):Pg.single(!1,i(e))},Ug=function(n,t,e,o){var r=jg(n,t,e,o);return r.fold((function(r,i){var u=zg(e)?i(t,e.config,e.validated):i(t),a=xn(u,"components").getOr([]),c=nn(a,(function(e){return Ug(n,t,e,o)}));return[m(m({},u),{components:c})]}),(function(n,o){if(zg(e)){var r=o(t,e.config,e.validated),i=e.validated.preprocess.getOr(u);return i(r)}return o(t)}))},Wg=function(n,t,e,o){return nn(e,(function(e){return Ug(n,t,e,o)}))},Gg=function(n,t){var e=!1,o=function(){return e},r=function(){if(e)throw new Error("Trying to use the same placeholder more than once: "+n);return e=!0,t},u=function(){return t.fold((function(n,t){return n}),(function(n,t){return n}))};return{name:i(n),required:u,used:o,replace:r}},Xg=function(n,t,e,o){var r=pn(o,(function(n,t){return Gg(t,n)})),i=Wg(n,t,e,r);return gn(r,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),i},Yg=Pg.single,qg=Pg.multiple,Kg=i(Hg),Jg=kn.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),$g=Te("factory",{sketch:u}),Qg=Te("schema",[]),Zg=ce("name"),np=Nt("pname","pname",qn((function(n){return"<alloy."+wu(n.name)+">"})),Zt()),tp=Ne("schema",(function(){return[ye("preprocess")]})),ep=Te("defaults",i({})),op=Te("overrides",i({})),rp=Dt([$g,Qg,Zg,np,ep,op]),ip=Dt([$g,Qg,Zg,ep,op]),up=Dt([$g,Qg,Zg,np,ep,op]),ap=Dt([$g,tp,Zg,ce("unit"),np,ep,op]),cp=function(n){return n.fold(w.some,w.none,w.some,w.some)},sp=function(n){var t=function(n){return n.name};return n.fold(t,t,t,t)},fp=function(n){return n.fold(u,u,u,u)},lp=function(n,t){return function(e){var o=Kt("Converting part type",t,e);return n(o)}},dp=lp(Jg.required,rp),mp=lp(Jg.external,ip),gp=lp(Jg.optional,up),pp=lp(Jg.group,ap),hp=i("entirety"),vp=Object.freeze({__proto__:null,required:dp,external:mp,optional:gp,group:pp,asNamedPart:cp,name:sp,asCommon:fp,original:hp}),bp=function(n,t,e,o){return Bn(t.defaults(n,e,o),e,{uid:n.partUids[t.name]},t.overrides(n,e,o))},yp=function(n,t,e){var o={},r={};return G(e,(function(n){n.fold((function(n){o[n.pname]=Yg(!0,(function(t,e,o){return n.factory.sketch(bp(t,n,e,o))}))}),(function(n){var e=t.parts[n.name];r[n.name]=i(n.factory.sketch(bp(t,n,e[hp()]),e))}),(function(n){o[n.pname]=Yg(!1,(function(t,e,o){return n.factory.sketch(bp(t,n,e,o))}))}),(function(n){o[n.pname]=qg(!0,(function(t,e,o){var r=t[n.name];return W(r,(function(e){return n.factory.sketch(Bn(n.defaults(t,e,o),e,n.overrides(t,e)))}))}))}))})),{internals:i(o),externals:i(r)}},xp=function(n,t){var e={};return G(t,(function(t){cp(t).each((function(t){var o=wp(n,t.pname);e[t.name]=function(e){var r=Kt("Part: "+t.name+" in "+n,Dt(t.schema),e);return m(m({},o),{config:e,validated:r})}}))})),e},wp=function(n,t){return{uiType:Kg(),owner:n,name:t}},Sp=function(n,t,e){return{uiType:Kg(),owner:n,name:t,config:e,validated:{}}},Cp=function(n){return nn(n,(function(n){return n.fold(w.none,w.some,w.none,w.none).map((function(n){return he(n.name,n.schema.concat([_s(hp())]))})).toArray()}))},kp=function(n){return W(n,sp)},Op=function(n,t,e){return yp(n,t,e)},_p=function(n,t,e){return Xg(w.some(n),t,t.components,e)},Tp=function(n,t,e){var o=t.partUids[e];return n.getSystem().getByUid(o).toOption()},Ep=function(n,t,e){return Tp(n,t,e).getOrDie("Could not find part: "+e)},Bp=function(n,t,e){var o={},r=t.partUids,u=n.getSystem();return G(e,(function(n){o[n]=i(u.getByUid(r[n]))})),o},Dp=function(n,t){var e=n.getSystem();return pn(t.partUids,(function(n,t){return i(e.getByUid(n))}))},Ap=function(n){return dn(n.partUids)},Mp=function(n,t,e){var o={},r=t.partUids,u=n.getSystem();return G(e,(function(n){o[n]=i(u.getByUid(r[n]).getOrDie())})),o},Fp=function(n,t){var e=kp(t);return et(W(e,(function(t){return{key:t,value:n+"-"+t}})))},Ip=function(n){return Nt("partUids","partUids",Kn((function(t){return Fp(t.uid,n)})),Zt())},Rp=Object.freeze({__proto__:null,generate:xp,generateOne:Sp,schemas:Cp,names:kp,substitutes:Op,components:_p,defaultUids:Fp,defaultUidsSchema:Ip,getAllParts:Dp,getAllPartNames:Ap,getPart:Tp,getPartOrDie:Ep,getParts:Bp,getPartsOrDie:Mp}),Vp=function(n,t){var e=n.length>0?[he("parts",n)]:[];return e.concat([ce("uid"),Te("dom",{}),Te("components",[]),_s("originalSpec"),Te("debug.sketcher",{})]).concat(t)},Np=function(n,t,e,o,r){var i=Vp(o,r);return Kt(n+" [SpecSchema]",Bt(i.concat(t)),e)},Hp=function(n,t,e,o){var r=Lp(o),i=Np(n,t,r,[],[]);return e(i,r)},Pp=function(n,t,e,o,r){var i=Lp(r),u=Cp(e),a=Ip(e),c=Np(n,t,i,u,[a]),s=Op(n,c,e),f=_p(n,c,s.internals());return o(c,f,i,s.externals())},zp=function(n){return wn(n,"uid")},Lp=function(n){return zp(n)?n:m(m({},n),{uid:Bu("uid")})};function jp(n){return void 0!==n.uid}var Up,Wp=Bt([ce("name"),ce("factory"),ce("configFields"),Te("apis",{}),Te("extraApis",{})]),Gp=Bt([ce("name"),ce("factory"),ce("configFields"),ce("partFields"),Te("apis",{}),Te("extraApis",{})]),Xp=function(n){var t=Kt("Sketcher for "+n.name,Wp,n),e=function(n){return Hp(t.name,t.configFields,t.factory,n)},o=pn(t.apis,zu),r=pn(t.extraApis,(function(n,t){return Ru(n,t)}));return m(m({name:i(t.name),configFields:i(t.configFields),sketch:e},o),r)},Yp=function(n){var t=Kt("Sketcher for "+n.name,Gp,n),e=function(n){return Pp(t.name,t.configFields,t.partFields,t.factory,n)},o=xp(t.name,t.partFields),r=pn(t.apis,zu),u=pn(t.extraApis,(function(n,t){return Ru(n,t)}));return m(m({name:i(t.name),partFields:i(t.partFields),configFields:i(t.configFields),sketch:e,parts:i(o)},r),u)},qp=function(n){for(var t=[],e=function(n){t.push(n)},o=0;o<n.length;o++)n[o].each(e);return t},Kp=function(n){for(var t=[],e=0;e<n.length;e++){var o=n[e];if(!o.isSome())return w.none();t.push(o.getOrDie())}return w.some(t)},Jp=function(n,t,e){return n.isSome()&&t.isSome()?w.some(e(n.getOrDie(),t.getOrDie())):w.none()},$p=function(n,t,e,o){return n.isSome()&&t.isSome()&&e.isSome()?w.some(o(n.getOrDie(),t.getOrDie(),e.getOrDie())):w.none()},Qp=function(n){return"input"===tu(n)&&"radio"!==su(n,"type")||"textarea"===tu(n)},Zp=function(n,t,e){return t.find(n)},nh=Object.freeze({__proto__:null,getCurrent:Zp}),th=[ce("find")],eh=Sf({fields:th,name:"composing",apis:nh}),oh=function(n,t,e,o){var r=xd(n.element(),"."+t.highlightClass);G(r,(function(e){L(o,(function(n){return n.element()===e}))||(Sa(e,t.highlightClass),n.getSystem().getByDom(e).each((function(e){t.onDehighlight(n,e),ti(e,ni())})))}))},rh=function(n,t,e){return oh(n,t,e,[])},ih=function(n,t,e,o){lh(n,t,e,o)&&(Sa(o.element(),t.highlightClass),t.onDehighlight(n,o),ti(o,ni()))},uh=function(n,t,e,o){oh(n,t,e,[o]),lh(n,t,e,o)||(xa(o.element(),t.highlightClass),t.onHighlight(n,o),ti(o,Zr()))},ah=function(n,t,e){gh(n,t).each((function(o){uh(n,t,e,o)}))},ch=function(n,t,e){ph(n,t).each((function(o){uh(n,t,e,o)}))},sh=function(n,t,e,o){mh(n,t,e,o).fold((function(n){throw new Error(n)}),(function(o){uh(n,t,e,o)}))},fh=function(n,t,e,o){var r=yh(n,t),i=$(r,o);i.each((function(o){uh(n,t,e,o)}))},lh=function(n,t,e,o){return Ca(o.element(),t.highlightClass)},dh=function(n,t,e){return $c(n.element(),"."+t.highlightClass).bind((function(t){return n.getSystem().getByDom(t).toOption()}))},mh=function(n,t,e,o){var r=xd(n.element(),"."+t.itemClass);return w.from(r[o]).fold((function(){return O.error("No element found with index "+o)}),n.getSystem().getByDom)},gh=function(n,t,e){return $c(n.element(),"."+t.itemClass).bind((function(t){return n.getSystem().getByDom(t).toOption()}))},ph=function(n,t,e){var o=xd(n.element(),"."+t.itemClass),r=o.length>0?w.some(o[o.length-1]):w.none();return r.bind((function(t){return n.getSystem().getByDom(t).toOption()}))},hh=function(n,t,e,o){var r=xd(n.element(),"."+t.itemClass),i=Q(r,(function(n){return Ca(n,t.highlightClass)}));return i.bind((function(t){var e=Qf(t,o,0,r.length-1);return n.getSystem().getByDom(r[e]).toOption()}))},vh=function(n,t,e){return hh(n,t,e,-1)},bh=function(n,t,e){return hh(n,t,e,1)},yh=function(n,t,e){var o=xd(n.element(),"."+t.itemClass);return qp(W(o,(function(t){return n.getSystem().getByDom(t).toOption()})))},xh=Object.freeze({__proto__:null,dehighlightAll:rh,dehighlight:ih,highlight:uh,highlightFirst:ah,highlightLast:ch,highlightAt:sh,highlightBy:fh,isHighlighted:lh,getHighlighted:dh,getFirst:gh,getLast:ph,getPrevious:vh,getNext:bh,getCandidates:yh}),wh=[ce("highlightClass"),ce("itemClass"),ws("onHighlight"),ws("onDehighlight")],Sh=Sf({fields:wh,name:"highlighting",apis:xh}),Ch=function(){return[8]},kh=function(){return[9]},Oh=function(){return[13]},_h=function(){return[27]},Th=function(){return[32]},Eh=function(){return[37]},Bh=function(){return[38]},Dh=function(){return[39]},Ah=function(){return[40]},Mh=function(n,t,e){var o=en(n.slice(0,t)),r=en(n.slice(t+1));return $(o.concat(r),e)},Fh=function(n,t,e){var o=en(n.slice(0,t));return $(o,e)},Ih=function(n,t,e){var o=n.slice(0,t),r=n.slice(t+1);return $(r.concat(o),e)},Rh=function(n,t,e){var o=n.slice(t+1);return $(o,e)},Vh=function(n){return function(t){var e=t.raw();return z(n,e.which)}},Nh=function(n){return function(t){return tn(n,(function(n){return n(t)}))}},Hh=function(n){var t=n.raw();return!0===t.shiftKey},Ph=function(n){var t=n.raw();return!0===t.ctrlKey},zh=c(Hh),Lh=function(n,t){return{matches:n,classification:t}},jh=function(n,t){var e=$(n,(function(n){return n.matches(t)}));return e.map((function(n){return n.classification}))},Uh=function(n,t,e){var o=t.exists((function(n){return e.exists((function(t){return Qo(t,n)}))}));o||ei(n,Kr(),{prevFocus:t,newFocus:e})},Wh=function(){var n=function(n){return Nf(n.element())},t=function(t,e){var o=n(t);t.getSystem().triggerFocus(e,t.element());var r=n(t);Uh(t,o,r)};return{get:n,set:t}},Gh=function(){var n=function(n){return Sh.getHighlighted(n).map((function(n){return n.element()}))},t=function(t,o){var r=n(t);t.getSystem().getByDom(o).fold(e,(function(n){Sh.highlight(t,n)}));var i=n(t);Uh(t,r,i)};return{get:n,set:t}};(function(n){n["OnFocusMode"]="onFocus",n["OnEnterOrSpaceMode"]="onEnterOrSpace",n["OnApiMode"]="onApi"})(Up||(Up={}));var Xh,Yh=function(n,t,e,o,r){var i=function(){return n.concat([Te("focusManager",Wh()),Ee("focusInside","onFocus",Wt((function(n){return z(["onFocus","onEnterOrSpace","onApi"],n)?O.value(n):O.error("Invalid value for focusInside")}))),Os("handler",c),Os("state",t),Os("sendFocusIn",r)])},u=function(n,t,e,o,r){var i=e(n,t,o,r);return jh(i,t.event()).bind((function(e){return e(n,t,o,r)}))},a=function(n,t){var i=n.focusInside!==Up.OnFocusMode?w.none():r(n).map((function(e){return li(Dr(),(function(o,r){e(o,n,t),r.stop()}))})),a=function(e,o){var i=Vh(Th().concat(Oh()))(o.event());n.focusInside===Up.OnEnterOrSpaceMode&&i&&ir(e,o)&&r(n).each((function(r){r(e,n,t),o.stop()}))};return ai(i.toArray().concat([li(Sr(),(function(o,r){u(o,r,e,n,t).fold((function(){a(o,r)}),(function(n){r.stop()}))})),li(Cr(),(function(e,r){u(e,r,o,n,t).each((function(n){r.stop()}))}))]))},c={schema:i,processKey:u,toEvents:a};return c},qh=function(n){var t=[ye("onEscape"),ye("onEnter"),Te("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Te("firstTabstop",0),Te("useTabstopAt",i(!0)),ye("visibilitySelector")].concat([n]),e=function(n,t){var e=n.visibilitySelector.bind((function(n){return Qc(t,n)})).getOr(t);return uc(e)>0},o=function(n,t){var o=xd(n.element(),t.selector),r=q(o,(function(n){return e(t,n)}));return w.from(r[t.firstTabstop])},r=function(n,t){return t.focusManager.get(n).bind((function(n){return Qc(n,t.selector)}))},u=function(n,t){return e(n,t)&&n.useTabstopAt(t)},c=function(n,t,e){o(n,t).each((function(e){t.focusManager.set(n,e)}))},s=function(n,t,e,o,r){return r(t,e,(function(n){return u(o,n)})).fold((function(){return o.cyclic?w.some(!0):w.none()}),(function(t){return o.focusManager.set(n,t),w.some(!0)}))},f=function(n,t,e,o){var i=xd(n.element(),e.selector);return r(n,e).bind((function(t){var r=Q(i,a(Qo,t));return r.bind((function(t){return s(n,i,t,e,o)}))}))},l=function(n,t,e){var o=e.cyclic?Mh:Fh;return f(n,t,e,o)},d=function(n,t,e){var o=e.cyclic?Ih:Rh;return f(n,t,e,o)},m=function(n,t,e){return e.onEnter.bind((function(e){return e(n,t)}))},g=function(n,t,e){return e.onEscape.bind((function(e){return e(n,t)}))},p=i([Lh(Nh([Hh,Vh(kh())]),l),Lh(Vh(kh()),d),Lh(Vh(_h()),g),Lh(Nh([zh,Vh(Oh())]),m)]),h=i([]);return Yh(t,Lu.init,p,h,(function(){return w.some(c)}))},Kh=qh(Ne("cyclic",i(!1))),Jh=qh(Ne("cyclic",i(!0))),$h=function(n,t,e){return ri(n,e,Ir()),w.some(!0)},Qh=function(n,t,e){return Qp(e)&&Vh(Th())(t.event())?w.none():$h(n,t,e)},Zh=function(n,t){return w.some(!0)},nv=[Te("execute",Qh),Te("useSpace",!1),Te("useEnter",!0),Te("useControlEnter",!1),Te("useDown",!1)],tv=function(n,t,e){return e.execute(n,t,n.element())},ev=function(n,t,e,o){var r=e.useSpace&&!Qp(n.element())?Th():[],i=e.useEnter?Oh():[],u=e.useDown?Ah():[],a=r.concat(i).concat(u);return[Lh(Vh(a),tv)].concat(e.useControlEnter?[Lh(Nh([Ph,Vh(Oh())]),tv)]:[])},ov=function(n,t,e,o){return e.useSpace&&!Qp(n.element())?[Lh(Vh(Th()),Zh)]:[]},rv=Yh(nv,Lu.init,ev,ov,(function(){return w.none()})),iv=function(){var n=He(w.none()),t=function(t,e){n.set(w.some({numRows:i(t),numColumns:i(e)}))},e=function(){return n.get().map((function(n){return n.numRows()}))},o=function(){return n.get().map((function(n){return n.numColumns()}))};return ju({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows()),numColumns:String(n.numColumns())}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:t,getNumRows:e,getNumColumns:o})},uv=function(n){return n.state(n)},av=Object.freeze({__proto__:null,flatgrid:iv,init:uv}),cv=function(n){return function(t,e,o,r){var i=n(t.element());return dv(i,t,e,o,r)}},sv=function(n,t){var e=Sl(n,t);return cv(e)},fv=function(n,t){var e=Sl(t,n);return cv(e)},lv=function(n){return function(t,e,o,r){return dv(n,t,e,o,r)}},dv=function(n,t,e,o,r){var i=o.focusManager.get(t).bind((function(e){return n(t.element(),e,o,r)}));return i.map((function(n){return o.focusManager.set(t,n),!0}))},mv=lv,gv=lv,pv=lv,hv=function(n){return n.offsetWidth<=0&&n.offsetHeight<=0},vv=function(n){var t=n.dom();return!hv(t)},bv=function(n,t){return Q(n,t).map((function(t){return{index:i(t),candidates:i(n)}}))},yv=function(n,t,e){var o=function(n){return Qo(n,t)},r=xd(n,e),i=q(r,vv);return bv(i,o)},xv=function(n,t){return Q(n,(function(n){return Qo(t,n)}))},wv=function(n,t,e,o){var r=Math.floor(t/e),i=t%e;return o(r,i).bind((function(t){var o=t.row()*e+t.column();return o>=0&&o<n.length?w.some(n[o]):w.none()}))},Sv=function(n,t,e,o,r){return wv(n,t,o,(function(t,u){var a=t===e-1,c=a?n.length-t*o:o,s=Qf(u,r,0,c-1);return w.some({row:i(t),column:i(s)})}))},Cv=function(n,t,e,o,r){return wv(n,t,o,(function(t,u){var a=Qf(t,r,0,e-1),c=a===e-1,s=c?n.length-a*o:o,f=Zf(u,0,s-1);return w.some({row:i(a),column:i(f)})}))},kv=function(n,t,e,o){return Sv(n,t,e,o,1)},Ov=function(n,t,e,o){return Sv(n,t,e,o,-1)},_v=function(n,t,e,o){return Cv(n,t,e,o,-1)},Tv=function(n,t,e,o){return Cv(n,t,e,o,1)},Ev=[ce("selector"),Te("execute",Qh),Ss("onEscape"),Te("captureTab",!1),Ts()],Bv=function(n,t,e){$c(n.element(),t.selector).each((function(e){t.focusManager.set(n,e)}))},Dv=function(n,t){return t.focusManager.get(n).bind((function(n){return Qc(n,t.selector)}))},Av=function(n,t,e,o){return Dv(n,e).bind((function(o){return e.execute(n,t,o)}))},Mv=function(n){return function(t,e,o,r){return yv(t,e,o.selector).bind((function(t){return n(t.candidates(),t.index(),r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},Fv=function(n,t,e){return e.captureTab?w.some(!0):w.none()},Iv=function(n,t,e){return e.onEscape(n,t)},Rv=Mv(Ov),Vv=Mv(kv),Nv=Mv(_v),Hv=Mv(Tv),Pv=i([Lh(Vh(Eh()),sv(Rv,Vv)),Lh(Vh(Dh()),fv(Rv,Vv)),Lh(Vh(Bh()),mv(Nv)),Lh(Vh(Ah()),gv(Hv)),Lh(Nh([Hh,Vh(kh())]),Fv),Lh(Nh([zh,Vh(kh())]),Fv),Lh(Vh(_h()),Iv),Lh(Vh(Th().concat(Oh())),Av)]),zv=i([Lh(Vh(Th()),Zh)]),Lv=Yh(Ev,iv,Pv,zv,(function(){return w.some(Bv)})),jv=function(n,t,e,o){var r=function(n){return"button"===tu(n)&&"disabled"===su(n,"disabled")},i=function(n,t,e){var u=Qf(t,o,0,e.length-1);return u===n?w.none():r(e[u])?i(n,u,e):w.from(e[u])};return yv(n,e,t).bind((function(n){var t=n.index(),e=n.candidates();return i(t,t,e)}))},Uv=[ce("selector"),Te("getInitial",w.none),Te("execute",Qh),Ss("onEscape"),Te("executeOnMove",!1),Te("allowVertical",!0)],Wv=function(n,t){return t.focusManager.get(n).bind((function(n){return Qc(n,t.selector)}))},Gv=function(n,t,e){return Wv(n,e).bind((function(o){return e.execute(n,t,o)}))},Xv=function(n,t,e){t.getInitial(n).orThunk((function(){return $c(n.element(),t.selector)})).each((function(e){t.focusManager.set(n,e)}))},Yv=function(n,t,e){return jv(n,e.selector,t,-1)},qv=function(n,t,e){return jv(n,e.selector,t,1)},Kv=function(n){return function(t,e,o,r){return n(t,e,o,r).bind((function(){return o.executeOnMove?Gv(t,e,o):w.some(!0)}))}},Jv=function(n,t,e){return e.onEscape(n,t)},$v=function(n,t,e,o){var r=Eh().concat(e.allowVertical?Bh():[]),i=Dh().concat(e.allowVertical?Ah():[]);return[Lh(Vh(r),Kv(sv(Yv,qv))),Lh(Vh(i),Kv(fv(Yv,qv))),Lh(Vh(Oh()),Gv),Lh(Vh(Th()),Gv),Lh(Vh(_h()),Jv)]},Qv=i([Lh(Vh(Th()),Zh)]),Zv=Yh(Uv,Lu.init,$v,Qv,(function(){return w.some(Xv)})),nb=Ai(["rowIndex","columnIndex","cell"],[]),tb=function(n,t,e){return w.from(n[t]).bind((function(n){return w.from(n[e]).map((function(n){return nb({rowIndex:t,columnIndex:e,cell:n})}))}))},eb=function(n,t,e,o){var r=n[t],i=r.length,u=Qf(e,o,0,i-1);return tb(n,t,u)},ob=function(n,t,e,o){var r=Qf(e,o,0,n.length-1),i=n[r].length,u=Zf(t,0,i-1);return tb(n,r,u)},rb=function(n,t,e,o){var r=n[t],i=r.length,u=Zf(e+o,0,i-1);return tb(n,t,u)},ib=function(n,t,e,o){var r=Zf(e+o,0,n.length-1),i=n[r].length,u=Zf(t,0,i-1);return tb(n,r,u)},ub=function(n,t,e){return eb(n,t,e,1)},ab=function(n,t,e){return eb(n,t,e,-1)},cb=function(n,t,e){return ob(n,e,t,-1)},sb=function(n,t,e){return ob(n,e,t,1)},fb=function(n,t,e){return rb(n,t,e,-1)},lb=function(n,t,e){return rb(n,t,e,1)},db=function(n,t,e){return ib(n,e,t,-1)},mb=function(n,t,e){return ib(n,e,t,1)},gb=[he("selectors",[ce("row"),ce("cell")]),Te("cycles",!0),Te("previousSelector",w.none),Te("execute",Qh)],pb=function(n,t,e){var o=t.previousSelector(n).orThunk((function(){var e=t.selectors;return $c(n.element(),e.cell)}));o.each((function(e){t.focusManager.set(n,e)}))},hb=function(n,t,e){return Nf(n.element()).bind((function(o){return e.execute(n,t,o)}))},vb=function(n,t){return W(n,(function(n){return xd(n,t.selectors.cell)}))},bb=function(n,t){return function(e,o,r){var i=r.cycles?n:t;return Qc(o,r.selectors.row).bind((function(n){var t=xd(n,r.selectors.cell);return xv(t,o).bind((function(t){var o=xd(e,r.selectors.row);return xv(o,n).bind((function(n){var e=vb(o,r);return i(e,n,t).map((function(n){return n.cell()}))}))}))}))}},yb=bb(ab,fb),xb=bb(ub,lb),wb=bb(cb,db),Sb=bb(sb,mb),Cb=i([Lh(Vh(Eh()),sv(yb,xb)),Lh(Vh(Dh()),fv(yb,xb)),Lh(Vh(Bh()),mv(wb)),Lh(Vh(Ah()),gv(Sb)),Lh(Vh(Th().concat(Oh())),hb)]),kb=i([Lh(Vh(Th()),Zh)]),Ob=Yh(gb,Lu.init,Cb,kb,(function(){return w.some(pb)})),_b=[ce("selector"),Te("execute",Qh),Te("moveOnTab",!1)],Tb=function(n,t,e){return e.focusManager.get(n).bind((function(o){return e.execute(n,t,o)}))},Eb=function(n,t,e){$c(n.element(),t.selector).each((function(e){t.focusManager.set(n,e)}))},Bb=function(n,t,e){return jv(n,e.selector,t,-1)},Db=function(n,t,e){return jv(n,e.selector,t,1)},Ab=function(n,t,e,o){return e.moveOnTab?pv(Bb)(n,t,e,o):w.none()},Mb=function(n,t,e,o){return e.moveOnTab?pv(Db)(n,t,e,o):w.none()},Fb=i([Lh(Vh(Bh()),pv(Bb)),Lh(Vh(Ah()),pv(Db)),Lh(Nh([Hh,Vh(kh())]),Ab),Lh(Nh([zh,Vh(kh())]),Mb),Lh(Vh(Oh()),Tb),Lh(Vh(Th()),Tb)]),Ib=i([Lh(Vh(Th()),Zh)]),Rb=Yh(_b,Lu.init,Fb,Ib,(function(){return w.some(Eb)})),Vb=[Ss("onSpace"),Ss("onEnter"),Ss("onShiftEnter"),Ss("onLeft"),Ss("onRight"),Ss("onTab"),Ss("onShiftTab"),Ss("onUp"),Ss("onDown"),Ss("onEscape"),Te("stopSpaceKeyup",!1),ye("focusIn")],Nb=function(n,t,e){return[Lh(Vh(Th()),e.onSpace),Lh(Nh([zh,Vh(Oh())]),e.onEnter),Lh(Nh([Hh,Vh(Oh())]),e.onShiftEnter),Lh(Nh([Hh,Vh(kh())]),e.onShiftTab),Lh(Nh([zh,Vh(kh())]),e.onTab),Lh(Vh(Bh()),e.onUp),Lh(Vh(Ah()),e.onDown),Lh(Vh(Eh()),e.onLeft),Lh(Vh(Dh()),e.onRight),Lh(Vh(Th()),e.onSpace),Lh(Vh(_h()),e.onEscape)]},Hb=function(n,t,e){return e.stopSpaceKeyup?[Lh(Vh(Th()),Zh)]:[]},Pb=Yh(Vb,Lu.init,Nb,Hb,(function(n){return n.focusIn})),zb=Kh.schema(),Lb=Jh.schema(),jb=Zv.schema(),Ub=Lv.schema(),Wb=Ob.schema(),Gb=rv.schema(),Xb=Rb.schema(),Yb=Pb.schema(),qb=Object.freeze({__proto__:null,acyclic:zb,cyclic:Lb,flow:jb,flatgrid:Ub,matrix:Wb,execution:Gb,menu:Xb,special:Yb}),Kb=function(n){return Sn(n,"setGridSize")},Jb=kf({branchKey:"mode",branches:qb,name:"keying",active:{events:function(n,t){var e=n.handler;return e.toEvents(n,t)}},apis:{focusIn:function(n,t,e){t.sendFocusIn(t).fold((function(){n.getSystem().triggerFocus(n.element(),n.element())}),(function(o){o(n,t,e)}))},setGridSize:function(n,e,o,r,i){Kb(o)?o.setGridSize(r,i):t.console.error("Layout does not support setGridSize")}},state:av}),$b=function(n,t,e,o){Hf((function(){var t=W(o,n.getSystem().build);Sm(n,t)}),n.element())},Qb=function(n,t,e,o){var r=n.getSystem().build(o);km(n,r,e)},Zb=function(n,t,e,o){Qb(n,t,Gi,o)},ny=function(n,t,e,o){Qb(n,t,Wi,o)},ty=function(n,t,e,o){var r=ey(n),i=$(r,(function(n){return Qo(o.element(),n.element())}));i.each(_m)},ey=function(n,t){return n.components()},oy=function(n,t,e,o,r){var i=ey(n);return w.from(i[o]).map((function(i){return ty(n,t,e,i),r.each((function(e){Qb(n,t,(function(n,t){Xi(n,t,o)}),e)})),i}))},ry=function(n,t,e,o,r){var i=ey(n);return Q(i,o).bind((function(o){return oy(n,t,e,o,r)}))},iy=Object.freeze({__proto__:null,append:Zb,prepend:ny,remove:ty,replaceAt:oy,replaceBy:ry,set:$b,contents:ey}),uy=Sf({fields:[],name:"replacing",apis:iy}),ay=function(n,t){var e=ai(t);return Sf({fields:[ce("enabled")],name:n,active:{events:i(e)}})},cy=function(n,t){var e=ay(n,t);return{key:n,value:{config:{},me:e,configAsRaw:i({}),initialConfig:{},state:Lu}}},sy=function(n,t){t.ignore||(Ff(n.element()),t.onFocus(n))},fy=function(n,t){t.ignore||If(n.element())},ly=function(n){return Rf(n.element())},dy=Object.freeze({__proto__:null,focus:sy,blur:fy,isFocused:ly}),my=function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}};return Yu(e)},gy=function(n){return ai([li(Dr(),(function(t,e){sy(t,n),e.stop()}))].concat(n.stopMousedown?[li(pr(),(function(n,t){t.event().prevent()}))]:[]))},py=Object.freeze({__proto__:null,exhibit:my,events:gy}),hy=[ws("onFocus"),Te("stopMousedown",!1),Te("ignore",!1)],vy=Sf({fields:hy,name:"focusing",active:py,apis:dy}),by=function(n,t,e){var o=t.aria;o.update(n,o,e.get())},yy=function(n,t,e){t.toggleClass.each((function(t){e.get()?xa(n.element(),t):Sa(n.element(),t)}))},xy=function(n,t,e){Cy(n,t,e,!e.get())},wy=function(n,t,e){e.set(!0),yy(n,t,e),by(n,t,e)},Sy=function(n,t,e){e.set(!1),yy(n,t,e),by(n,t,e)},Cy=function(n,t,e,o){var r=o?wy:Sy;r(n,t,e)},ky=function(n,t,e){return e.get()},Oy=function(n,t,e){Cy(n,t,e,t.selected)},_y=Object.freeze({__proto__:null,onLoad:Oy,toggle:xy,isOn:ky,on:wy,off:Sy,set:Cy}),Ty=function(){return Yu({})},Ey=function(n,t){var e=mf(n,t,xy),o=gf(n,t,Oy);return ai(Z([n.toggleOnExecute?[e]:[],[o]]))},By=Object.freeze({__proto__:null,exhibit:Ty,events:Ey}),Dy=function(n){var t=function(){var t=He(n),e=function(){return t.get()},o=function(n){return t.set(n)},r=function(){return t.set(n)},i=function(){return t.get()};return{get:e,set:o,clear:r,readState:i}};return{init:t}},Ay=function(n,t,e){au(n.element(),"aria-pressed",e),t.syncWithExpanded&&Iy(n,t,e)},My=function(n,t,e){au(n.element(),"aria-selected",e)},Fy=function(n,t,e){au(n.element(),"aria-checked",e)},Iy=function(n,t,e){au(n.element(),"aria-expanded",e)},Ry=[Te("selected",!1),ye("toggleClass"),Te("toggleOnExecute",!0),Ee("aria",{mode:"none"},Qt("mode",{pressed:[Te("syncWithExpanded",!1),Os("update",Ay)],checked:[Os("update",Fy)],expanded:[Os("update",Iy)],selected:[Os("update",My)],none:[Os("update",e)]}))],Vy=Sf({fields:Ry,name:"toggling",active:By,apis:_y,state:Dy(!1)}),Ny=function(){var n=function(n,t){t.stop(),oi(n)};return[li(_r(),n),li(Vr(),n),bi(lr()),bi(pr())]},Hy=function(n){var t=function(n){return ki((function(t,e){n(t),e.stop()}))};return ai(Z([n.map(t).toArray(),Ny()]))},Py="alloy.item-hover",zy="alloy.item-focus",Ly=function(n){(Nf(n.element()).isNone()||vy.isFocused(n))&&(vy.isFocused(n)||vy.focus(n),ei(n,Py,{item:n}))},jy=function(n){ei(n,zy,{item:n})},Uy=i(Py),Wy=i(zy),Gy=function(n){return{dom:n.dom,domModification:m(m({},n.domModification),{attributes:m(m(m({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Ng.augment(n.itemBehaviours,[n.toggling.fold(Vy.revoke,(function(n){return Vy.config(m({aria:{mode:"checked"}},n))})),vy.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){jy(n)}}),Jb.config({mode:"execution"}),Fg.config({store:{mode:"memory",initialValue:n.data}}),cy("item-type-events",p(Ny(),[li(yr(),Ly),li(Rr(),vy.focus)]))]),components:n.components,eventOrder:n.eventOrder}},Xy=[ce("data"),ce("components"),ce("dom"),Te("hasSubmenu",!1),ye("toggling"),Ng.field("itemBehaviours",[Vy,vy,Jb,Fg]),Te("ignoreFocus",!1),Te("domModification",{}),Os("builder",Gy),Te("eventOrder",{})],Yy=function(n){return{dom:n.dom,components:n.components,events:ai([yi(Rr())])}},qy=[ce("dom"),ce("components"),Os("builder",Yy)],Ky=function(){return"item-widget"},Jy=i([dp({name:"widget",overrides:function(n){return{behaviours:xf([Fg.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:function(){}}})])}}})]),$y=function(n){var t=Op(Ky(),n,Jy()),e=_p(Ky(),n,t.internals()),o=function(t){return Tp(t,n,"widget").map((function(n){return Jb.focusIn(n),n}))},r=function(t,e){return Qp(e.event().target())?w.none():function(){return n.autofocus?(e.setSource(t.element()),w.none()):w.none()}()};return{dom:n.dom,components:e,domModification:n.domModification,events:ai([ki((function(n,t){o(n).each((function(n){t.stop()}))})),li(yr(),Ly),li(Rr(),(function(t,e){n.autofocus?o(t):vy.focus(t)}))]),behaviours:Ng.augment(n.widgetBehaviours,[Fg.config({store:{mode:"memory",initialValue:n.data}}),vy.config({ignore:n.ignoreFocus,onFocus:function(n){jy(n)}}),Jb.config({mode:"special",focusIn:n.autofocus?function(n){o(n)}:Of(),onLeft:r,onRight:r,onEscape:function(t,e){return vy.isFocused(t)||n.autofocus?n.autofocus?(e.setSource(t.element()),w.none()):w.none():(vy.focus(t),w.some(!0))}})])}},Qy=[ce("uid"),ce("data"),ce("components"),ce("dom"),Te("autofocus",!1),Te("ignoreFocus",!1),Ng.field("widgetBehaviours",[Fg,vy,Jb]),Te("domModification",{}),Ip(Jy()),Os("builder",$y)],Zy=Qt("type",{widget:Qy,item:Xy,separator:qy}),nx=function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}},tx=function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}},ex=function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}},ox=i([pp({factory:{sketch:function(n){var t=Kt("menu.spec item",Zy,n);return t.builder(t)}},name:"items",unit:"item",defaults:function(n,t){return t.hasOwnProperty("uid")?t:m(m({},t),{uid:Bu("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),rx=i([ce("value"),ce("items"),ce("dom"),ce("components"),Te("eventOrder",{}),Ig("menuBehaviours",[Sh,Fg,eh,Jb]),Ee("movement",{mode:"menu",moveOnTab:!0},Qt("mode",{grid:[Ts(),Os("config",nx)],matrix:[Os("config",tx),ce("rowSelector")],menu:[Te("moveOnTab",!0),Os("config",ex)]})),vs(),Te("fakeFocus",!1),Te("focusManager",Wh()),ws("onHighlight")]),ix=i("alloy.menu-focus"),ux=function(n,t,e,o){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Vg(n.menuBehaviours,[Sh.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Fg.config({store:{mode:"memory",initialValue:n.value}}),eh.config({find:w.some}),Jb.config(n.movement.config(n,n.movement))]),events:ai([li(Wy(),(function(n,t){var e=t.event();n.getSystem().getByDom(e.target()).each((function(e){Sh.highlight(n,e),t.stop(),ei(n,ix(),{menu:n,item:e})}))})),li(Uy(),(function(n,t){var e=t.event().item();Sh.highlight(n,e)}))]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}},ax=Yp({name:"Menu",configFields:rx(),partFields:ox(),factory:ux}),cx=function(n){return hn(n,(function(n,t){return{k:n,v:t}}))},sx=function(n,t,e,o){return xn(e,o).bind((function(o){return xn(n,o).bind((function(o){var r=sx(n,t,e,o);return w.some([o].concat(r))}))})).getOr([])},fx=function(n,t){var e={};gn(n,(function(n,t){G(n,(function(n){e[n]=t}))}));var o=t,r=cx(t),i=pn(r,(function(n,t){return[t].concat(sx(e,o,r,t))}));return pn(e,(function(n){return xn(i,n).getOr([n])}))},lx=function(){var n=He({}),t=He({}),e=He({}),o=He(w.none()),r=He({}),i=function(){n.set({}),t.set({}),e.set({}),o.set(w.none())},u=function(){return o.get().isNone()},a=function(n,e){var o;t.set(m(m({},t.get()),(o={},o[n]={type:"prepared",menu:e},o)))},c=function(i,u,a,c){o.set(w.some(i)),n.set(a),t.set(u),r.set(c);var s=fx(c,a);e.set(s)},s=function(t){return bn(n.get(),(function(n,e){return n===t}))},f=function(n,t,e){return h(n).bind((function(o){return s(n).bind((function(n){return t(n).map((function(n){return{triggeredMenu:o,triggeringItem:n,triggeringPath:e}}))}))}))},l=function(n,t){var r=q(b(n).toArray(),(function(n){return h(n).isSome()}));return xn(e.get(),n).bind((function(n){var e=en(r.concat(n)),i=nn(e,(function(n,r){return f(n,t,e.slice(0,r+1)).fold((function(){return o.get().is(n)?[]:[w.none()]}),(function(n){return[w.some(n)]}))}));return Kp(i)}))},d=function(t){return xn(n.get(),t).map((function(n){var o=xn(e.get(),t).getOr([]);return[n].concat(o)}))},g=function(n){return xn(e.get(),n).bind((function(n){return n.length>1?w.some(n.slice(1)):w.none()}))},p=function(n){return xn(e.get(),n)},h=function(n){return v(n).bind(dx)},v=function(n){return xn(t.get(),n)},b=function(t){return xn(n.get(),t)},y=function(n){var t=r.get();return on(dn(t),n)},x=function(){return o.get().bind(h)},S=function(){return t.get()};return{setMenuBuilt:a,setContents:c,expand:d,refresh:p,collapse:g,lookupMenu:v,lookupItem:b,otherMenus:y,getPrimary:x,getMenus:S,clear:i,isClear:u,getTriggeringPath:l}},dx=function(n){return"prepared"===n.type?w.some(n.menu):w.none()},mx={init:lx,extractPreparedMenu:dx},gx=function(n,t){var e,o=He(w.none()),r=function(t,e,o){return pn(o,(function(o,r){var i=function(){return ax.sketch(m(m({dom:o.dom},o),{value:r,items:o.items,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?Gh():Wh()}))};return r===e?{type:"prepared",menu:t.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))},i=mx.init(),u=function(t){var e=r(t,n.data.primary,n.data.menus),o=s();return i.setContents(n.data.primary,e,n.data.expansions,o),i.getPrimary()},a=function(n){return Fg.getValue(n).value},c=function(n,t,e){return ln(t,(function(n){if(!n.getSystem().isConnected())return w.none();var t=Sh.getCandidates(n);return $(t,(function(n){return a(n)===e}))}))},s=function(t){return pn(n.data.menus,(function(n,t){return nn(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}))},f=function(n,t){Sh.highlight(n,t),Sh.getHighlighted(t).orThunk((function(){return Sh.getFirst(t)})).each((function(t){ri(n,t.element(),Rr())}))},l=function(n,t){return qp(W(t,(function(t){return n.lookupMenu(t).bind((function(n){return"prepared"===n.type?w.some(n.menu):w.none()}))})))},d=function(t,e,o){var r=l(e,e.otherMenus(o));G(r,(function(e){Oa(e.element(),[n.markers.backgroundMenu]),n.stayInDom||uy.remove(t,e)}))},g=function(t){return o.get().getOrThunk((function(){var e={},r=xd(t.element(),"."+n.markers.item),i=q(r,(function(n){return"true"===su(n,"aria-haspopup")}));return G(i,(function(n){t.getSystem().getByDom(n).each((function(n){var t=a(n);e[t]=n}))})),o.set(w.some(e)),e}))},p=function(n,t){var e=g(n);gn(e,(function(n,e){var o=z(t,e);au(n.element(),"aria-expanded",o)}))},h=function(t,e,o){return w.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return w.none();var i=r.menu,u=l(e,o.slice(1));return G(u,(function(t){xa(t.element(),n.markers.backgroundMenu)})),Ta(i.element())||uy.append(t,oc(i)),Oa(i.element(),[n.markers.backgroundMenu]),f(t,i),d(t,e,o),w.some(i)}))}))};(function(n){n[n["HighlightSubmenu"]=0]="HighlightSubmenu",n[n["HighlightParent"]=1]="HighlightParent"})(e||(e={}));var v=function(n,t,e){if("notbuilt"===e.type){var o=n.getSystem().build(e.nbMenu());return i.setMenuBuilt(t,o),o}return e.menu},b=function(t,o,r){void 0===r&&(r=e.HighlightSubmenu);var u=a(o);return i.expand(u).bind((function(u){return p(t,u),w.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=v(t,a,c);return Ta(s.element())||uy.append(t,oc(s)),n.onOpenSubmenu(t,o,s,en(u)),r===e.HighlightSubmenu?(Sh.highlightFirst(s),h(t,i,u)):(Sh.dehighlightAll(s),w.some(o))}))}))}))},y=function(t,e){var o=a(e);return i.collapse(o).bind((function(o){return p(t,o),h(t,i,o).map((function(o){return n.onCollapseMenu(t,e,o),o}))}))},x=function(n,t){var e=a(t);return i.refresh(e).bind((function(t){return p(n,t),h(n,i,t)}))},S=function(n,t){return Qp(t.element())?w.none():b(n,t,e.HighlightSubmenu)},C=function(n,t){return Qp(t.element())?w.none():y(n,t)},k=function(t,e){return y(t,e).orThunk((function(){return n.onEscape(t,e).map((function(){return t}))}))},O=function(t){return function(e,o){return Qc(o.getSource(),"."+n.markers.item).bind((function(n){return e.getSystem().getByDom(n).toOption().bind((function(n){return t(e,n).map((function(){return!0}))}))}))}},_=ai([li(ix(),(function(n,t){var e=t.event().item();i.lookupItem(a(e)).each((function(){var e=t.event().menu();Sh.highlight(n,e);var o=a(t.event().item());i.refresh(o).each((function(t){return d(n,i,t)}))}))})),ki((function(t,o){var r=o.event().target();t.getSystem().getByDom(r).each((function(o){var r=a(o);0===r.indexOf("collapse-item")&&y(t,o),b(t,o,e.HighlightSubmenu).fold((function(){n.onExecute(t,o)}),(function(){}))}))})),wi((function(t,e){u(t).each((function(e){uy.append(t,oc(e)),n.onOpenMenu(t,e),n.highlightImmediately&&f(t,e)}))}))].concat(n.navigateOnHover?[li(Uy(),(function(t,o){var r=o.event().item();x(t,r),b(t,r,e.HighlightParent),n.onHover(t,r)}))]:[])),T=function(n){return Sh.getHighlighted(n).bind(Sh.getHighlighted)},E=function(n){T(n).each((function(t){y(n,t)}))},B=function(n){i.getPrimary().each((function(t){f(n,t)}))},D=function(n){return w.from(n.components()[0]).filter((function(n){return"menu"===su(n.element(),"role")}))},A=function(t){var e=i.getPrimary().bind((function(n){return T(t).bind((function(n){var e=a(n),o=yn(i.getMenus()),r=qp(W(o,mx.extractPreparedMenu));return i.getTriggeringPath(e,(function(n){return c(t,r,n)}))})).map((function(t){return{primary:n,triggeringPath:t}}))}));e.fold((function(){D(t).each((function(e){n.onRepositionMenu(t,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;n.onRepositionMenu(t,o,r)}))},M={collapseMenu:E,highlightPrimary:B,repositionMenus:A};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Vg(n.tmenuBehaviours,[Jb.config({mode:"special",onRight:O(S),onLeft:O(C),onEscape:O(k),focusIn:function(n,t){i.getPrimary().each((function(t){ri(n,t.element(),Rr())}))}}),Sh.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),eh.config({find:function(n){return Sh.getHighlighted(n)}}),uy.config({})]),eventOrder:n.eventOrder,apis:M,events:_}},px=i("collapse-item"),hx=function(n,t,e){return{primary:n,menus:t,expansions:e}},vx=function(n,t){return{primary:n,menus:tt(n,t),expansions:{}}},bx=function(n){return{value:wu(px()),meta:{text:n}}},yx=Xp({name:"TieredMenu",configFields:[ks("onExecute"),ks("onEscape"),Cs("onOpenMenu"),Cs("onOpenSubmenu"),ws("onRepositionMenu"),ws("onCollapseMenu"),Te("highlightImmediately",!0),he("data",[ce("primary"),ce("menus"),ce("expansions")]),Te("fakeFocus",!1),ws("onHighlight"),ws("onHover"),bs(),ce("dom"),Te("navigateOnHover",!0),Te("stayInDom",!1),Ig("tmenuBehaviours",[Jb,Sh,eh,uy]),Te("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:gx,extraApis:{tieredData:hx,singleData:vx,collapseItem:bx}}),xx=function(n,t,e,o,r){var i=function(){return n.lazySink(t)},u="horizontal"===o.type?{layouts:{onLtr:function(){return lf()},onRtl:function(){return df()}}}:{},a=function(n){return 2===n.length},c=function(n){return a(n)?u:{}};return yx.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return $m.close(t),n.onEscape.map((function(n){return n(t)})),w.some(!0)},onExecute:function(){return w.some(!0)},onOpenMenu:function(n,t){vm.positionWithinBounds(i().getOrDie(),e,t,r())},onOpenSubmenu:function(n,t,e,o){var r=i().getOrDie();vm.position(r,m({anchor:"submenu",item:t},c(o)),e)},onRepositionMenu:function(n,t,o){var u=i().getOrDie();vm.positionWithinBounds(u,e,t,r()),G(o,(function(n){var t=c(n.triggeringPath);vm.position(u,m({anchor:"submenu",item:n.triggeringItem},t),n.triggeredMenu)}))}})},wx=function(n,t){var e=function(t,e){var o=n.getRelated(t);return o.exists((function(n){return es(n,e)}))},o=function(n,t){$m.setContent(n,t)},r=function(n,t,e){i(n,t,e,w.none())},i=function(n,t,e,o){u(n,t,e,(function(){return o.map((function(n){return Lc(n)}))}))},u=function(t,e,o,r){var i=n.lazySink(t).getOrDie();$m.openWhileCloaked(t,o,(function(){return vm.positionWithinBounds(i,e,t,r())})),Fg.setValue(t,w.some({mode:"position",anchor:e,getBounds:r}))},a=function(n,t,e){c(n,t,e,(function(){return w.none()}))},c=function(t,e,o,r){var i=xx(n,t,e,o,r);$m.open(t,i),Fg.setValue(t,w.some({mode:"menu",menu:i}))},s=function(n){$m.isOpen(n)&&(Fg.setValue(n,w.none()),$m.close(n))},f=function(n){return $m.getState(n)},l=function(t){$m.isOpen(t)&&Fg.getValue(t).each((function(e){switch(e.mode){case"menu":$m.getState(t).each((function(n){yx.repositionMenus(n)}));break;case"position":var o=n.lazySink(t).getOrDie();vm.positionWithinBounds(o,e.anchor,t,e.getBounds());break}}))},d={setContent:o,showAt:r,showWithin:i,showWithinBounds:u,showMenuAt:a,showMenuWithinBounds:c,hide:s,getContent:f,reposition:l,isOpen:$m.isOpen};return{uid:n.uid,dom:n.dom,behaviours:Vg(n.inlineBehaviours,[$m.config({isPartOf:function(n,t,o){return es(t,o)||e(n,o)},getAttachPoint:function(t){return n.lazySink(t).getOrDie()},onOpen:function(t){n.onShow(t)},onClose:function(t){n.onHide(t)}}),Fg.config({store:{mode:"memory",initialValue:w.none()}}),Df.config({channels:m(m({},eg(m({isExtraPart:t.isExtraPart},n.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),rg(m(m({},n.fireRepositionEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})),{doReposition:l})))})]),eventOrder:n.eventOrder,apis:d}},Sx=Xp({name:"InlineView",configFields:[ce("lazySink"),ws("onShow"),ws("onHide"),Ce("onEscape"),Ig("inlineBehaviours",[$m,Fg,Df]),Oe("fireDismissalEventInstead",[Te("event",Yr())]),Oe("fireRepositionEventInstead",[Te("event",qr())]),Te("getRelated",w.none),Te("isExtraPart",f),Te("eventOrder",w.none)],factory:wx,apis:{showAt:function(n,t,e,o){n.showAt(t,e,o)},showWithin:function(n,t,e,o,r){n.showWithin(t,e,o,r)},showWithinBounds:function(n,t,e,o,r){n.showWithinBounds(t,e,o,r)},showMenuAt:function(n,t,e,o){n.showMenuAt(t,e,o)},showMenuWithinBounds:function(n,t,e,o,r){n.showMenuWithinBounds(t,e,o,r)},hide:function(n,t){n.hide(t)},isOpen:function(n,t){return n.isOpen(t)},getContent:function(n,t){return n.getContent(t)},setContent:function(n,t,e){n.setContent(t,e)},reposition:function(n,t){n.reposition(t)}}}),Cx=function(n){return n.x()},kx=function(n,t){return n.x()+n.width()/2-t.width()/2},Ox=function(n,t){return n.x()+n.width()-t.width()},_x=function(n){return n.y()},Tx=function(n,t){return n.y()+n.height()-t.height()},Ex=function(n,t,e){return Es(Ox(n,t),Tx(n,t),e.innerSoutheast(),Vs(),js(n,{right:0,bottom:3}),"layout-inner-se")},Bx=function(n,t,e){return Es(Cx(n),Tx(n,t),e.innerSouthwest(),Rs(),js(n,{left:1,bottom:3}),"layout-inner-sw")},Dx=function(n,t,e){return Es(Ox(n,t),_x(n),e.innerNortheast(),Is(),js(n,{right:0,top:2}),"layout-inner-ne")},Ax=function(n,t,e){return Es(Cx(n),_x(n),e.innerNorthwest(),Fs(),js(n,{left:1,top:2}),"layout-inner-nw")},Mx=function(n,t,e){return Es(kx(n,t),_x(n),e.innerNorth(),Ns(),js(n,{top:2}),"layout-inner-n")},Fx=function(n,t,e){return Es(kx(n,t),Tx(n,t),e.innerSouth(),Hs(),js(n,{bottom:3}),"layout-inner-s")},Ix=tinymce.util.Tools.resolve("tinymce.util.Delay"),Rx=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Vx=tinymce.util.Tools.resolve("tinymce.EditorManager"),Nx=function(n){var t=n.settings,e=t.skin,o=t.skin_url;if(!1!==e){var r=e||"oxide";o=o?n.documentBaseURI.toAbsolute(o):Vx.baseURL+"/skins/ui/"+r}return o},Hx=function(n){return n.getParam("readonly",!1,"boolean")},Px=function(n){return!1===n.getParam("skin")},zx=function(n){return n.getParam("height",Math.max(n.getElement().offsetHeight,200))},Lx=function(n){return n.getParam("width",Rx.DOM.getStyle(n.getElement(),"width"))},jx=function(n){return w.from(n.settings.min_width).filter(F)},Ux=function(n){return w.from(n.settings.min_height).filter(F)},Wx=function(n){return w.from(n.getParam("max_width")).filter(F)},Gx=function(n){return w.from(n.getParam("max_height")).filter(F)},Xx=function(n){return w.from(n.getParam("style_formats")).filter(D)},Yx=function(n){return n.getParam("style_formats_merge",!1,"boolean")},qx=function(n){return n.getParam("removed_menuitems","")},Kx=function(n){return!1!==n.getParam("menubar",!0,"boolean")},Jx=function(n){var t=n.getParam("toolbar",!0),e=!0===t,o=E(t),r=D(t)&&t.length>0;return!Qx(n)&&(r||o||e)},$x=function(n){var t=dn(n.settings),e=q(t,(function(n){return/^toolbar([1-9])$/.test(n)})),o=W(e,(function(t){return n.getParam(t,!1,"string")})),r=q(o,(function(n){return"string"===typeof n}));return r.length>0?w.some(r):w.none()},Qx=function(n){return $x(n).fold((function(){var t=n.getParam("toolbar",[],"string[]");return t.length>0}),(function(){return!0}))};(function(n){n["default"]="wrap",n["floating"]="floating",n["sliding"]="sliding",n["scrolling"]="scrolling"})(Xh||(Xh={}));var Zx,nw=function(n){return n.getParam("toolbar_mode","","string")};(function(n){n["top"]="top",n["bottom"]="bottom"})(Zx||(Zx={}));var tw=function(n){return n.getParam("toolbar_groups",{},"object")},ew=function(n){return n.getParam("toolbar_location",Zx.top,"string")!==Zx.bottom},ow=function(n){return n.getParam("fixed_toolbar_container","","string")},rw=function(n){var t=ow(n);return t.length>0&&n.inline?$c(Ea(),t):w.none()},iw=function(n){return n.inline&&rw(n).isSome()},uw=function(n){var t=rw(n);return t.getOr(Ea())},aw=function(n){return n.inline&&!Kx(n)&&!Jx(n)&&!Qx(n)},cw=function(n){var t=n.getParam("toolbar_sticky",!1,"boolean");return(t||n.inline)&&!iw(n)&&!aw(n)},sw=function(n){return n.getParam("draggable_modal",!1,"boolean")},fw=function(n){var t=Hy(n.action),e=n.dom.tag,o=function(t){return xn(n.dom,"attributes").bind((function(n){return xn(n,t)}))},r=function(){if("button"===e){var n=o("type").getOr("button"),t=o("role").map((function(n){return{role:n}})).getOr({});return m({type:n},t)}var r=o("role").getOr("button");return{role:r}};return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:Ng.augment(n.buttonBehaviours,[vy.config({}),Jb.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:r()},eventOrder:n.eventOrder}},lw=Xp({name:"Button",factory:fw,configFields:[Te("uid",void 0),ce("dom"),Te("components",[]),Ng.field("buttonBehaviours",[vy,Jb]),ye("action"),ye("role"),Te("eventOrder",{})]}),dw=function(n){var t=jp(n)&&Sn(n,"uid")?n.uid:Bu("memento"),e=function(n){return n.getSystem().getByUid(t).getOrDie()},o=function(n){return n.getSystem().getByUid(t).toOption()},r=function(){return m(m({},n),{uid:t})};return{get:e,getOpt:o,asSpec:r}},mw=function(n){return w.from(n()["temporary-placeholder"]).getOr("!not found!")},gw=function(n,t){return w.from(t()[n]).getOrThunk((function(){return mw(t)}))},pw=function(n,t,e){return w.from(t()[n]).or(e).getOrThunk((function(){return mw(t)}))},hw=function(n,t){return ln(n,(function(n){return w.from(t()[n])})).getOrThunk((function(){return mw(t)}))},vw={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},bw=function(n){var t=dw({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:xf([uy.config({})])}),e=function(n){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+n+"%"}}}},o=function(n){return{dom:{tag:"div",classes:["tox-text"],innerHtml:n+"%"}}},r=dw({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:xf([uy.config({})])}),i=function(n,t){n.getSystem().isConnected()&&r.getOpt(n).each((function(n){uy.set(n,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(t)]},o(t)])}))},u=function(n,e){if(n.getSystem().isConnected()){var o=t.get(n);uy.set(o,[Za(e)])}},a={updateProgress:i,updateText:u},c=Z([n.icon.toArray(),n.level.toArray(),n.level.bind((function(n){return w.from(vw[n])})).toArray()]);return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map((function(n){return["tox-notification","tox-notification--in","tox-notification--"+n]})).getOr(["tox-notification","tox-notification--in"])},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:hw(c,n.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:xf([uy.config({})])}].concat(n.progress?[r.asSpec()]:[]).concat(n.closeButton?[lw.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:gw("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})]:[]),apis:a}},yw=Xp({name:"Notification",factory:bw,configFields:[ye("level"),ce("progress"),ce("icon"),ce("onAction"),ce("text"),ce("iconProvider"),ce("translationProvider"),Me("closeButton",!0)],apis:{updateProgress:function(n,t,e){n.updateProgress(t,e)},updateText:function(n,t,e){n.updateText(t,e)}}});function xw(n,t,e){var o=t.backstage,r=ew(n),i=function(n){switch(n){case"bc-bc":return Fx;case"tc-tc":return Mx;case"tc-bc":return ef;case"bc-tc":default:return of}},u=function(n){G(n,(function(n){return n.moveTo(0,0)}))},a=function(n){n.length>0&&(cn(n).each((function(n){return n.moveRel(null,"banner")})),G(n,(function(t,e){e>0&&t.moveRel(n[e-1].getEl(),"bc-tc")})))},c=function(n){u(n),a(n)},s=function(n,u){var a=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),c=function(){u(),Sx.hide(f)},s=ec(yw.sketch({text:n.text,level:z(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:w.from(n.icon),closeButton:!a,onAction:c,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),f=ec(Sx.sketch(m({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:t.backstage.shared.getSink,fireDismissalEventInstead:{}},r?{}:{fireRepositionEventInstead:{}})));return e.add(f),n.timeout>0&&Ix.setTimeout((function(){c()}),n.timeout),{close:c,moveTo:function(n,t){Sx.showAt(f,{anchor:"makeshift",x:n,y:t},oc(s))},moveRel:function(n,e){if("banner"!==e){var o=i(e),r={anchor:"node",root:Ea(),node:w.some(We.fromDom(n)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}};Sx.showAt(f,r,oc(s))}else Sx.showAt(f,t.backstage.shared.anchors.banner(),oc(s))},text:function(n){yw.updateText(s,n)},settings:n,getEl:function(){return s.element().dom()},progressBar:{value:function(n){yw.updateProgress(s,n)}}}},f=function(n){n.close()},l=function(n){return n.settings};return{open:s,close:f,reposition:c,getArgs:l}}var ww,Sw=function(n,e){var o=null,r=function(){null!==o&&(t.clearTimeout(o),o=null)},i=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];null===o&&(o=t.setTimeout((function(){n.apply(null,r),o=null}),e))};return{cancel:r,throttle:i}},Cw=function(n,e){var o=null,r=function(){null!==o&&(t.clearTimeout(o),o=null)},i=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];null!==o&&t.clearTimeout(o),o=t.setTimeout((function(){n.apply(null,r),o=null}),e)};return{cancel:r,throttle:i}},kw=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Ow=function(n,t){return n.isBlock(t)||z(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===n.getContentEditable(t)},_w=function(n,t,e,o,r){var i=kw(n,(function(t){return Ow(n,t)}));return w.from(i.backwards(t,e,o,r))},Tw="[data-mce-autocompleter]",Ew=function(n,t){return Bw(We.fromDom(n.selection.getNode())).getOrThunk((function(){var e=We.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',n.getDoc());return Gi(e,We.fromDom(t.extractContents())),t.insertNode(e.dom()),Ri(e).each((function(n){return n.dom().normalize()})),bd(e).map((function(t){n.selection.setCursorLocation(t.dom(),gd(t))})),e}))},Bw=function(n){return Qc(n,Tw)},Dw=function(n){return n.collapsed&&3===n.startContainer.nodeType},Aw=function(n){return n.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Mw=function(n){return""!==n&&-1!==" \f\n\r\t\v".indexOf(n)},Fw=function(n,t){return n.substring(t.length)},Iw=function(n,t,e){var o;for(o=t-1;o>=0;o--){var r=n.charAt(o);if(Mw(r))return w.none();if(r===e)break}return w.some(o)},Rw=function(n,t,e,o){if(void 0===o&&(o=0),!Dw(t))return w.none();var r=function(n,t,o){return Iw(o,t,e).getOr(t)},i=n.getParent(t.startContainer,n.isBlock)||n.getRoot();return _w(n,t.startContainer,t.startOffset,r,i).bind((function(n){var r=t.cloneRange();if(r.setStart(n.container,n.offset),r.setEnd(t.endContainer,t.endOffset),r.collapsed)return w.none();var i=Aw(r),u=i.lastIndexOf(e);return 0!==u||Fw(i,e).length<o?w.none():w.some({text:Fw(i,e),range:r,triggerChar:e})}))},Vw=function(n,t,e,o){return void 0===o&&(o=0),Bw(We.fromDom(t.startContainer)).fold((function(){return Rw(n,t,e,o)}),(function(t){var o=n.createRng();o.selectNode(t.dom());var r=Aw(o);return w.some({range:o,text:Fw(r,e),triggerChar:e})}))},Nw=function(n,t){t.on("keypress compositionend",n.onKeypress.throttle),t.on("remove",n.onKeypress.cancel);var e=function(n,t){ei(n,Sr(),{raw:t})};t.on("keydown",(function(t){var o=function(){return n.getView().bind(Sh.getHighlighted)};8===t.which&&n.onKeypress.throttle(t),n.isActive()&&(27===t.which&&n.cancelIfNecessary(),n.isMenuOpen()?13===t.which?(o().each(oi),t.preventDefault()):40===t.which?(o().fold((function(){n.getView().each(Sh.highlightFirst)}),(function(n){e(n,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||o().each((function(n){e(n,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==t.which&&38!==t.which&&40!==t.which||n.cancelIfNecessary())})),t.on("NodeChange",(function(t){n.isActive()&&!n.isProcessingAction()&&Bw(We.fromDom(t.element)).isNone()&&n.cancelIfNecessary()}))},Hw={setup:Nw},Pw=tinymce.util.Tools.resolve("tinymce.util.Promise"),zw=function(n,t){return{container:n,offset:t}},Lw=function(n){return n.nodeType===t.Node.TEXT_NODE},jw=function(n){return n.nodeType===t.Node.ELEMENT_NODE},Uw=function(n){if(Lw(n))return zw(n,n.data.length);var t=n.childNodes;return t.length>0?Uw(t[t.length-1]):zw(n,t.length)},Ww=function(n,t){var e=n.childNodes;return e.length>0&&t<e.length?Ww(e[t],0):e.length>0&&jw(n)&&e.length===t?Uw(e[e.length-1]):zw(n,t)},Gw=function(n,t){return _w(n,t.container,t.offset,(function(n,t){return 0===t?-1:t}),n.getRoot()).filter((function(n){var t=n.container.data.charAt(n.offset-1);return!Mw(t)})).isSome()},Xw=function(n){return function(t){var e=Ww(t.startContainer,t.startOffset);return!Gw(n,e)}},Yw=function(n,t,e){return ln(e.triggerChars,(function(e){return Vw(n,t,e)}))},qw=function(n,t){var e=t(),o=n.selection.getRng();return Yw(n.dom,o,e).bind((function(e){return Kw(n,t,e)}))},Kw=function(n,t,e,o){void 0===o&&(o={});var r=t(),i=n.selection.getRng(),u=i.startContainer.nodeValue,a=q(r.lookupByChar(e.triggerChar),(function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk((function(){return Xw(n.dom)}))(e.range,u,e.text)}));if(0===a.length)return w.none();var c=Pw.all(W(a,(function(n){var t=n.fetch(e.text,n.maxResults,o);return t.then((function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction}}))})));return w.some({lookupData:c,context:e})},Jw=Dt([le("type"),Se("text")]),$w=function(n){return Yt("separatormenuitem",Jw,n)},Qw=Dt([Ne("type",(function(){return"autocompleteitem"})),Ne("active",(function(){return!1})),Ne("disabled",(function(){return!1})),Te("meta",{}),le("value"),Se("text"),Se("icon")]),Zw=Dt([le("type"),le("ch"),Be("minChars",1),Te("columns",1),Be("maxResults",10),Ce("matches"),ge("fetch"),ge("onAction")]),nS=function(n){return Yt("Autocompleter.Separator",Jw,n)},tS=function(n){return Yt("Autocompleter.Item",Qw,n)},eS=function(n){return Yt("Autocompleter",Zw,n)},oS=function(n){var t={};return G(n,(function(n){t[n]={}})),dn(t)},rS=function(n){var t=n.ui.registry.getAll().popups,e=pn(t,(function(n){return eS(n).fold((function(n){throw new Error(Jt(n))}),(function(n){return n}))})),o=oS(vn(e,(function(n){return n.ch}))),r=yn(e),i=function(n){return q(r,(function(t){return t.ch===n}))};return{dataset:e,triggerChars:o,lookupByChar:i}},iS=[Me("disabled",!1),Se("text"),Se("shortcut"),Nt("value","value",qn((function(){return wu("menuitem-value")})),Zt()),Te("meta",{})],uS=Dt([le("type"),Fe("onSetup",(function(){return e})),Fe("onAction",e),Se("icon")].concat(iS)),aS=function(n){return Yt("menuitem",uS,n)},cS=Dt([le("type"),ge("getSubmenuItems"),Fe("onSetup",(function(){return e})),Se("icon")].concat(iS)),sS=function(n){return Yt("nestedmenuitem",cS,n)},fS=Dt([le("type"),Me("active",!1),Fe("onSetup",(function(){return e})),ge("onAction")].concat(iS)),lS=function(n){return Yt("togglemenuitem",fS,n)},dS=Dt([le("type"),Me("active",!1),Se("icon")].concat(iS)),mS=function(n){return Yt("choicemenuitem",dS,n)},gS=["inserttable","colorswatch"],pS=Dt([le("type"),de("fancytype",gS),Fe("onAction",e)]),hS=function(n){return Yt("fancymenuitem",pS,n)},vS=function(n,t,e){var o=xd(n.element(),"."+e);if(o.length>0){var r=Q(o,(function(n){var e=n.dom().getBoundingClientRect().top,r=o[0].dom().getBoundingClientRect().top;return Math.abs(e-r)>t})).getOr(o.length);return w.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return w.none()},bS=function(n,t){return xf([cy(n,t)])},yS=function(n){return bS(wu("unnamed-events"),n)},xS={namedEvents:bS,unnamedEvents:yS},wS=[ce("lazySink"),ce("tooltipDom"),Te("exclusive",!0),Te("tooltipComponents",[]),Te("delay",300),Ae("mode","normal",["normal","follow-highlight"]),Te("anchor",(function(n){return{anchor:"hotspot",hotspot:n,layouts:{onLtr:i([of,ef,Qs,nf,Zs,tf]),onRtl:i([of,ef,Qs,nf,Zs,tf])}}})),ws("onHide"),ws("onShow")],SS=function(){var n=He(w.none()),e=He(w.none()),o=function(){return e.get()},r=function(n){e.set(w.some(n))},u=function(){e.set(w.none())},a=function(){n.get().each((function(n){t.clearTimeout(n)}))},c=function(e,o){a(),n.set(w.some(t.setTimeout((function(){e()}),o)))},s=function(){return e.get().isSome()},f=i("not-implemented");return ju({getTooltip:o,isShowing:s,setTooltip:r,clearTooltip:u,clearTimer:a,resetTimer:c,readState:f})},CS=Object.freeze({__proto__:null,init:SS}),kS=wu("tooltip.exclusive"),OS=wu("tooltip.show"),_S=wu("tooltip.hide"),TS=function(n,t,e){n.getSystem().broadcastOn([kS],{})},ES=function(n,t,e,o){e.getTooltip().each((function(n){n.getSystem().isConnected()&&uy.set(n,o)}))},BS=Object.freeze({__proto__:null,hideAllExclusive:TS,setComponents:ES}),DS=function(n,t){var e=function(e){t.getTooltip().each((function(o){_m(o),n.onHide(e,o),t.clearTooltip()})),t.clearTimer()},o=function(e){if(!t.isShowing()){TS(e);var o=n.lazySink(e).getOrDie(),r=e.getSystem().build({dom:n.tooltipDom,components:n.tooltipComponents,events:ai("normal"===n.mode?[li(yr(),(function(n){ti(e,OS)})),li(vr(),(function(n){ti(e,_S)}))]:[]),behaviours:xf([uy.config({})])});t.setTooltip(r),Cm(o,r),n.onShow(e,r),vm.position(o,n.anchor(e),r)}};return ai(Z([[li(OS,(function(e){t.resetTimer((function(){o(e)}),n.delay)})),li(_S,(function(o){t.resetTimer((function(){e(o)}),n.delay)})),li(Fr(),(function(n,t){var o=t;z(o.channels(),kS)&&e(n)})),Si((function(n){e(n)}))],"normal"===n.mode?[li(xr(),(function(n){ti(n,OS)})),li(Ar(),(function(n){ti(n,_S)})),li(yr(),(function(n){ti(n,OS)})),li(vr(),(function(n){ti(n,_S)}))]:[li(Zr(),(function(n,t){ti(n,OS)})),li(ni(),(function(n){ti(n,_S)}))]]))},AS=Object.freeze({__proto__:null,events:DS}),MS=Sf({fields:wS,name:"tooltipping",active:AS,state:CS,apis:BS}),FS=tinymce.util.Tools.resolve("tinymce.util.I18n"),IS="tox-menu-nav__js",RS="tox-collection__item",VS="tox-swatch",NS={normal:IS,color:VS},HS="tox-collection__item--enabled",PS="tox-collection__group-heading",zS="tox-collection__item-icon",LS="tox-collection__item-label",jS="tox-collection__item-accessory",US="tox-collection__item-caret",WS="tox-collection__item-checkmark",GS="tox-collection__item--active",XS="tox-collection__item-icon-rtl",YS=function(n){return xn(NS,n).getOr(IS)},qS=tinymce.util.Tools.resolve("tinymce.Env"),KS=function(n){var t={alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"},e={meta:"Ctrl",access:"Shift+Alt"},o=qS.mac?t:e,r=n.split("+"),i=W(r,(function(n){var t=n.toLowerCase().trim();return wn(o,t)?o[t]:n}));return qS.mac?i.join(""):i.join("+")},JS={convertText:KS},$S=function(n){return{dom:{tag:"div",classes:[zS],innerHtml:n}}},QS=function(n){return{dom:{tag:"div",classes:[LS]},components:[Za(FS.translate(n))]}},ZS=function(n){return{dom:{tag:"div",classes:[LS],innerHtml:n}}},nC=function(n,t){return{dom:{tag:"div",classes:[LS]},components:[{dom:{tag:n.tag,styles:n.styles},components:[Za(FS.translate(t))]}]}},tC=function(n){return{dom:{tag:"div",classes:[jS],innerHtml:JS.convertText(n)}}},eC=function(n){return{dom:{tag:"div",classes:[zS,WS],innerHtml:gw("checkmark",n)}}},oC=function(n){return{dom:{tag:"div",classes:[US],innerHtml:gw("chevron-right",n)}}},rC=function(n){return{dom:{tag:"div",classes:[US],innerHtml:gw("chevron-down",n)}}},iC=function(n,t,e,o){var r="custom",i="remove",u=function(){var u=VS,a=e.getOr(""),c=n.map((function(n){return{title:o.translate(n)}})).getOr({}),s={tag:"div",attributes:c,classes:[u]};return m(m({},s),t===r?{tag:"button",classes:p(s.classes,["tox-swatches__picker-btn"]),innerHtml:a}:t===i?{classes:p(s.classes,["tox-swatch--remove"]),innerHtml:a}:{attributes:m(m({},s.attributes),{"data-mce-color":t}),styles:{"background-color":t}})};return{dom:u(),optComponents:[]}},uC=function(n,t,e,o,r){var i=e?n.checkMark.orThunk((function(){return t.or(w.some("")).map($S)})):w.none(),u=n.ariaLabel.map((function(n){return{attributes:{title:FS.translate(n)}}})).getOr({}),a=m({tag:"div",classes:[IS,RS].concat(r?[XS]:[])},u),c=n.htmlContent.fold((function(){return n.textContent.map(o)}),(function(n){return w.some(ZS(n))})),s={dom:a,optComponents:[i,c,n.shortcutContent.map(tC),n.caret]};return s},aC=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],cC=["list-bull-circle","list-bull-default","list-bull-square"],sC=function(n,t,e,o){void 0===o&&(o=w.none());var r=function(n){return n.map((function(n){return FS.isRtl()&&z(aC,n)?n+"-rtl":n}))},i=FS.isRtl()&&n.iconContent.exists((function(n){return z(cC,n)})),u=r(n.iconContent).map((function(n){return pw(n,t.icons,o)})),c=w.from(n.meta).fold((function(){return QS}),(function(n){return wn(n,"style")?a(nC,n.style):QS}));return"color"===n.presets?iC(n.ariaLabel,n.value,u,t):uC(n,u,e,c,i)},fC=["input","button","textarea","select"],lC=function(n,t,e){t.disabled&&yC(n,t)},dC=function(n,t){return!0===t.useNative&&z(fC,tu(n.element()))},mC=function(n){return lu(n.element(),"disabled")},gC=function(n){au(n.element(),"disabled","disabled")},pC=function(n){du(n.element(),"disabled")},hC=function(n){return"true"===su(n.element(),"aria-disabled")},vC=function(n){au(n.element(),"aria-disabled","true")},bC=function(n){au(n.element(),"aria-disabled","false")},yC=function(n,t,e){t.disableClass.each((function(t){xa(n.element(),t)}));var o=dC(n,t)?gC:vC;o(n),t.onDisabled(n)},xC=function(n,t,e){t.disableClass.each((function(t){Sa(n.element(),t)}));var o=dC(n,t)?pC:bC;o(n),t.onEnabled(n)},wC=function(n,t){return dC(n,t)?mC(n):hC(n)},SC=function(n,t,e,o){var r=o?yC:xC;r(n,t,e)},CC=Object.freeze({__proto__:null,enable:xC,disable:yC,isDisabled:wC,onLoad:lC,set:SC}),kC=function(n,t){return Yu({classes:t.disabled?t.disableClass.map(un).getOr([]):[]})},OC=function(n,t){return ai([ci(Ir(),(function(t,e){return wC(t,n)})),gf(n,t,lC)])},_C=Object.freeze({__proto__:null,exhibit:kC,events:OC}),TC=[Te("disabled",!1),Te("useNative",!0),ye("disableClass"),ws("onDisabled"),ws("onEnabled")],EC=Sf({fields:TC,name:"disabling",active:_C,apis:CC}),BC=function(n){return EC.config({disabled:n,disableClass:"tox-collection__item--state-disabled"})},DC=function(n){return EC.config({disabled:n})},AC=function(n){return EC.config({disabled:n,disableClass:"tox-tbtn--disabled"})},MC=function(n){return EC.config({disabled:n,disableClass:"tox-tbtn--disabled",useNative:!1})},FC={item:BC,button:DC,splitButton:AC,toolbarButton:MC},IC=function(n,t){var e=n.getApi(t);return function(n){n(e)}},RC=function(n,t){return wi((function(e){var o=IC(n,e);o((function(e){var o=n.onSetup(e);null!==o&&void 0!==o&&t.set(o)}))}))},VC=function(n,t){return Si((function(e){return IC(n,e)(t.get())}))};(function(n){n[n["CLOSE_ON_EXECUTE"]=0]="CLOSE_ON_EXECUTE",n[n["BUBBLE_TO_SANDBOX"]=1]="BUBBLE_TO_SANDBOX"})(ww||(ww={}));var NC=ww,HC=function(n,t){return ki((function(e,o){IC(n,e)(n.onAction),n.triggersSubmenu||t!==NC.CLOSE_ON_EXECUTE||(ti(e,Hr()),o.stop())}))},PC={"alloy.execute":["disabling","alloy.base.behaviour","toggling","item-events"]},zC=function(n){return nn(n,(function(n){return n.toArray()}))},LC=function(n,t,o){var r=He(e);return{type:"item",dom:t.dom,components:zC(t.optComponents),data:n.data,eventOrder:PC,hasSubmenu:n.triggersSubmenu,itemBehaviours:xf([cy("item-events",[HC(n,o),RC(n,r),VC(n,r)]),FC.item(n.disabled),uy.config({})].concat(n.itemBehaviours))}},jC=function(n){return{value:n.value,meta:m({text:n.text.getOr("")},n.meta)}},UC=function(n,t){return xn(n,"tooltipWorker").map((function(n){return[MS.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(n){return{anchor:"submenu",item:n,overrides:{maxHeightFunction:ml}}},mode:"follow-highlight",onShow:function(t,e){n((function(n){MS.setComponents(t,[nc({element:We.fromDom(n)})])}))}})]})).getOr([])},WC=function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},GC=function(n){return Rx.DOM.encode(n)},XC=function(n,t){var e=FS.translate(n),o=GC(e);if(t.length>0){var r=new RegExp(WC(t),"gi");return o.replace(r,(function(n){return'<span class="tox-autocompleter-highlight">'+n+"</span>"}))}return o},YC=function(n,t,e,o,r,i,u,a){void 0===a&&(a=!0);var c=sC({presets:o,textContent:w.none(),htmlContent:e?n.text.map((function(n){return XC(n,t)})):w.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:w.none(),checkMark:w.none(),caret:w.none(),value:n.value},u.providers,a,n.icon);return LC({data:jC(n),disabled:n.disabled,getApi:function(){return{}},onAction:function(t){return r(n.value,n.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:UC(n.meta,u)},c,i)},qC=function(n,t,e,o,r,i,u){var a=function(n){return{setActive:function(t){Vy.set(n,t)},isActive:function(){return Vy.isOn(n)},isDisabled:function(){return EC.isDisabled(n)},setDisabled:function(t){return EC.set(n,t)}}},c=sC({presets:e,textContent:t?n.text:w.none(),htmlContent:w.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:t?n.shortcut:w.none(),checkMark:t?w.some(eC(u.icons)):w.none(),caret:w.none(),value:n.value},u,!0);return Bn(LC({data:jC(n),disabled:n.disabled,getApi:a,onAction:function(t){return o(n.value)},onSetup:function(n){return n.setActive(r),function(){}},triggersSubmenu:!1,itemBehaviours:[]},c,i),{toggling:{toggleClass:HS,toggleOnExecute:!1,selected:n.active}})},KC=i(xp(Ky(),Jy())),JC=wu("cell-over"),$C=wu("cell-execute"),QC=function(n,t,e){var o,r=function(e){return ei(e,JC,{row:n,col:t})},i=function(e){return ei(e,$C,{row:n,col:t})},u=function(n,t){t.stop(),i(n)};return ec({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:xf([cy("insert-table-picker-cell",[li(yr(),vy.focus),li(Ir(),i),li(_r(),u),li(Vr(),u)]),Vy.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),vy.config({onFocus:r})])})},ZC=function(n,t,e){for(var o=[],r=0;r<t;r++){for(var i=[],u=0;u<e;u++)i.push(QC(r,u,n));o.push(i)}return o},nk=function(n,t,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)Vy.set(n[i][u],i<=t&&u<=e)},tk=function(n){return nn(n,(function(n){return W(n,oc)}))},ek=function(n,t){return Za(t+1+"x"+(n+1))};function ok(n){var t=10,e=10,o=wu("size-label"),r=ZC(o,t,e),i=dw({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:o}},components:[Za("0x0")],behaviours:xf([uy.config({})])});return{type:"widget",data:{value:wu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[KC().widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:tk(r).concat(i.asSpec()),behaviours:xf([cy("insert-table-picker",[vi(JC,(function(n,o,u){var a=u.event().row(),c=u.event().col();nk(r,a,c,t,e),uy.set(i.get(n),[ek(a,c)])})),vi($C,(function(t,e,o){n.onAction({numRows:o.event().row()+1,numColumns:o.event().col()+1}),ti(t,Hr())}))]),Jb.config({initSize:{numRows:t,numColumns:e},mode:"flatgrid",selector:'[role="button"]'})])})]}}var rk=function(n){return{value:i(n)}},ik=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,uk=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,ak=function(n){return ik.test(n)||uk.test(n)},ck=function(n){var t=n.value().replace(ik,(function(n,t,e,o){return t+t+e+e+o+o}));return{value:i(t)}},sk=function(n){var t=ck(n),e=uk.exec(t.value());return null===e?["FFFFFF","FF","FF","FF"]:e},fk=function(n){var t=n.toString(16);return 1===t.length?"0"+t:t},lk=function(n){var t=fk(n.red())+fk(n.green())+fk(n.blue());return rk(t)},dk=Math.min,mk=Math.max,gk=Math.round,pk=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,hk=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,vk=function(n,t,e,o){return{red:i(n),green:i(t),blue:i(e),alpha:i(o)}},bk=function(n){var t=parseInt(n,10);return t.toString()===n&&t>=0&&t<=255},yk=function(n){var t,e,o,r=(n.hue()||0)%360,i=n.saturation()/100,u=n.value()/100;if(i=mk(0,dk(i,1)),u=mk(0,dk(u,1)),0===i)return t=e=o=gk(255*u),vk(t,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:t=c,e=s,o=0;break;case 1:t=s,e=c,o=0;break;case 2:t=0,e=c,o=s;break;case 3:t=0,e=s,o=c;break;case 4:t=s,e=0,o=c;break;case 5:t=c,e=0,o=s;break;default:t=e=o=0}return t=gk(255*(t+f)),e=gk(255*(e+f)),o=gk(255*(o+f)),vk(t,e,o,1)},xk=function(n){var t=sk(n),e=parseInt(t[1],16),o=parseInt(t[2],16),r=parseInt(t[3],16);return vk(e,o,r,1)},wk=function(n,t,e,o){var r=parseInt(n,10),i=parseInt(t,10),u=parseInt(e,10),a=parseFloat(o);return vk(r,i,u,a)},Sk=function(n){if("transparent"===n)return w.some(vk(0,0,0,0));var t=pk.exec(n);if(null!==t)return w.some(wk(t[1],t[2],t[3],"1"));var e=hk.exec(n);return null!==e?w.some(wk(e[1],e[2],e[3],e[4])):w.none()},Ck=function(n){return"rgba("+n.red()+","+n.green()+","+n.blue()+","+n.alpha()+")"},kk=i(vk(255,0,0,1)),Ok=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),_k="tinymce-custom-colors";function Tk(n){void 0===n&&(n=10);var t=Ok.getItem(_k),e=E(t)?JSON.parse(t):[],o=function(t){var e=n-t.length;return e<0?t.slice(0,n):t},r=o(e),i=function(t){P(r,t).each(u),r.unshift(t),r.length>n&&r.pop(),Ok.setItem(_k,JSON.stringify(r))},u=function(n){r.splice(n,1)},a=function(){return r.slice(0)};return{add:i,state:a}}var Ek="choiceitem",Bk=[{type:Ek,text:"Light Green",value:"#BFEDD2"},{type:Ek,text:"Light Yellow",value:"#FBEEB8"},{type:Ek,text:"Light Red",value:"#F8CAC6"},{type:Ek,text:"Light Purple",value:"#ECCAFA"},{type:Ek,text:"Light Blue",value:"#C2E0F4"},{type:Ek,text:"Green",value:"#2DC26B"},{type:Ek,text:"Yellow",value:"#F1C40F"},{type:Ek,text:"Red",value:"#E03E2D"},{type:Ek,text:"Purple",value:"#B96AD9"},{type:Ek,text:"Blue",value:"#3598DB"},{type:Ek,text:"Dark Turquoise",value:"#169179"},{type:Ek,text:"Orange",value:"#E67E23"},{type:Ek,text:"Dark Red",value:"#BA372A"},{type:Ek,text:"Dark Purple",value:"#843FA1"},{type:Ek,text:"Dark Blue",value:"#236FA1"},{type:Ek,text:"Light Gray",value:"#ECF0F1"},{type:Ek,text:"Medium Gray",value:"#CED4D9"},{type:Ek,text:"Gray",value:"#95A5A6"},{type:Ek,text:"Dark Gray",value:"#7E8C8D"},{type:Ek,text:"Navy Blue",value:"#34495E"},{type:Ek,text:"Black",value:"#000000"},{type:Ek,text:"White",value:"#ffffff"}],Dk=Tk(10),Ak=function(n){var e=[],o=t.document.createElement("canvas");o.height=1,o.width=1;for(var r=o.getContext("2d"),i=function(n,t){var e=255,o=t/255,r=Math.round(n*o+e*(1-o));return("0"+r.toString(16)).slice(-2).toUpperCase()},u=function(n){if(/^[0-9A-Fa-f]{6}$/.test(n))return"#"+n.toUpperCase();r.clearRect(0,0,o.width,o.height),r.fillStyle="#FFFFFF",r.fillStyle=n,r.fillRect(0,0,1,1);var t=r.getImageData(0,0,1,1).data,e=t[0],u=t[1],a=t[2],c=t[3];return"#"+i(e,c)+i(u,c)+i(a,c)},a=0;a<n.length;a+=2)e.push({text:n[a+1],value:u(n[a]),type:"choiceitem"});return e},Mk=function(n,t){return n.getParam("color_cols",t,"number")},Fk=function(n){return!1!==n.getParam("custom_colors")},Ik=function(n){return n.getParam("color_map")},Rk=function(n){var t=Ik(n);return void 0!==t?Ak(t):Bk},Vk=function(){return W(Dk.state(),(function(n){return{type:Ek,text:n,value:n}}))},Nk=function(n){Dk.add(n)},Hk={mapColors:Ak,getColorCols:Mk,hasCustomColors:Fk,getColorMap:Ik,getColors:Rk,getCurrentColors:Vk,addColor:Nk},Pk=function(n){return n.fire("SkinLoaded")},zk=function(n,t){return n.fire("SkinLoadError",t)},Lk=function(n){return n.fire("ResizeEditor")},jk=function(n){return n.fire("BeforeRenderUI")},Uk=function(n,t){return n.fire("ResizeContent",t)},Wk=function(n,t){return n.fire("ScrollContent",t)},Gk=function(n,t){return n.fire("TextColorChange",t)},Xk={fireSkinLoaded:Pk,fireSkinLoadError:zk,fireResizeEditor:Lk,fireScrollContent:Wk,fireBeforeRenderUI:jk,fireResizeContent:Uk,fireTextColorChange:Gk},Yk=function(n,t){var e;return n.dom.getParents(n.selection.getStart(),(function(n){var o;(o=n.style["forecolor"===t?"color":"background-color"])&&(e=e||o)})),e},qk=function(n,t,e){n.undoManager.transact((function(){n.focus(),n.formatter.apply(t,{value:e}),n.nodeChanged()}))},Kk=function(n,t){n.undoManager.transact((function(){n.focus(),n.formatter.remove(t,{value:null},null,!0),n.nodeChanged()}))},Jk=function(n){n.addCommand("mceApplyTextcolor",(function(t,e){qk(n,t,e)})),n.addCommand("mceRemoveTextcolor",(function(t){Kk(n,t)}))},$k=function(n){return Math.max(5,Math.ceil(Math.sqrt(n)))},Qk=function(n){var t=Hk.getColors(n),e=$k(t.length);return Hk.getColorCols(n,e)},Zk=function(n){var t="choiceitem",e={type:t,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},o={type:t,text:"Custom color",icon:"color-picker",value:"custom"};return n?[e,o]:[e]},nO=function(n,t,e,o){if("custom"===e){var r=uO(n);r((function(e){e.each((function(e){Hk.addColor(e),n.execCommand("mceApplyTextcolor",t,e),o(e)}))}),"#000000")}else"remove"===e?(o(""),n.execCommand("mceRemoveTextcolor",t)):(o(e),n.execCommand("mceApplyTextcolor",t,e))},tO=function(n,t){return n.concat(Hk.getCurrentColors().concat(Zk(t)))},eO=function(n,t){return function(e){e(tO(n,t))}},oO=function(n,t,e){var o=function(t,e){n.setIconFill(t,e),n.setIconStroke(t,e)},r="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";o(r,e)},rO=function(n,t,e,o,r){n.ui.registry.addSplitButton(t,{tooltip:o,presets:"color",icon:"forecolor"===t?"text-color":"highlight-bg-color",select:function(t){var o=w.from(Yk(n,e));return o.bind((function(n){return Sk(n).map((function(n){var e=lk(n).value();return Do(t.toLowerCase(),e)}))})).getOr(!1)},columns:Qk(n),fetch:eO(Hk.getColors(n),Hk.hasCustomColors(n)),onAction:function(t){null!==r.get()&&nO(n,e,r.get(),(function(){}))},onItemAction:function(o,i){nO(n,e,i,(function(e){r.set(e),Xk.fireTextColorChange(n,{name:t,color:e})}))},onSetup:function(e){null!==r.get()&&oO(e,t,r.get());var o=function(n){n.name===t&&oO(e,n.name,n.color)};return n.on("TextColorChange",o),function(){n.off("TextColorChange",o)}}})},iO=function(n,t,o,r){n.ui.registry.addNestedMenuItem(t,{text:r,icon:"forecolor"===t?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(t){nO(n,o,t.value,e)}}]}})},uO=function(n){return function(t,e){var o=function(n){return function(t){var e=t.getData();n(w.from(e.colorpicker)),t.close()}},r=function(n,t){"hex-valid"===t.name&&(t.value?n.enable("ok"):n.disable("ok"))},i={colorpicker:e},u=o(t);n.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onAction:r,onSubmit:u,onClose:function(){},onCancel:function(){t(w.none())}})}},aO=function(n){Jk(n);var t=He(null),e=He(null);rO(n,"forecolor","forecolor","Text color",t),rO(n,"backcolor","hilitecolor","Background color",e),iO(n,"forecolor","forecolor","Text color"),iO(n,"backcolor","hilitecolor","Background color")},cO={register:aO,getColors:tO,getFetch:eO,colorPickerDialog:uO,getCurrentColor:Yk,getColorCols:Qk,calcCols:$k},sO=function(n){return"color"===n?"tox-swatches":"tox-menu"},fO=function(n){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:sO(n),tieredMenu:"tox-tiered-menu"}},lO=function(n){var t=fO(n);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:YS(n)}},dO=function(n,t,e){var o=fO(e);return{tag:"div",classes:Z([[o.menu,"tox-menu-"+t+"-column"],n?[o.hasIcons]:[]])}},mO=[ax.parts().items({})],gO=function(n,t,e){var o=fO(e),r={tag:"div",classes:Z([[o.tieredMenu]])};return{dom:r,markers:lO(e)}},pO=function(n,t){return function(e){var o=U(e,t);return W(o,(function(t){return{dom:n,components:t}}))}},hO=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[ax.parts().items({preprocess:"auto"!==n?pO({tag:"div",classes:["tox-swatches__row"]},n):u})]}]}},vO=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[ax.parts().items({preprocess:pO({tag:"div",classes:["tox-collection__group"]},n)})]}},bO=function(n,t){var e=[],o=[];return G(n,(function(n,r){t(n,r)?(o.length>0&&e.push(o),o=[],wn(n.dom,"innerHtml")&&o.push(n)):o.push(n)})),o.length>0&&e.push(o),W(e,(function(n){return{dom:{tag:"div",classes:["tox-collection__group"]},components:n}}))},yO=function(n,t,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[ax.parts().items({preprocess:function(e){return"auto"!==n&&n>1?pO({tag:"div",classes:["tox-collection__group"]},n)(e):bO(e,(function(n,e){return"separator"===t[e].type}))}})]}},xO=function(n,t){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[ax.parts().items({preprocess:function(t){return bO(t,(function(t,e){return"separator"===n[e].type}))}})]}},wO=function(n){return void 0!==n.icon||"togglemenuitem"===n.type||"choicemenuitem"===n.type},SO=function(n){return L(n,wO)},CO=function(n){return t.console.error(Jt(n)),t.console.log(n),w.none()},kO=function(n,t,e,o,r){var i=xO(e);return{value:n,dom:i.dom,components:i.components,items:e}},OO=function(n,t,e,o,r){if("color"===r){var i=hO(o);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===r&&"auto"===o){i=yO(o,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===r&&1===o){i=yO(1,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("normal"===r){i=yO(o,e);return{value:n,dom:i.dom,components:i.components,items:e}}if("listpreview"===r&&"auto"!==o){i=vO(o);return{value:n,dom:i.dom,components:i.components,items:e}}return{value:n,dom:dO(t,o,r),components:mO,items:e}},_O=function(n,t,e,o,r,i,u,a){var c=SO(t),s="color"!==r?"normal":"color",f=TO(t,e,o,s,i,u,a);return OO(n,c,f,o,r)},TO=function(n,t,e,o,r,i,u){return qp(W(n,(function(n){return"choiceitem"===n.type?mS(n).fold(CO,(function(a){return w.some(qC(a,1===e,o,t,i(n.value),r,u))})):w.none()})))},EO=function(n,t){var e=lO(t);if(1===n)return{mode:"menu",moveOnTab:!0};if("auto"===n)return{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}};var o="color"===t?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+o}},BO=function(n,t){return 1===n?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===n?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===t?".tox-swatches__row":".tox-collection__group",cell:"color"===t?"."+VS:"."+RS}}};function DO(n,t){var e=cO.getColors(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),r="color",i=_O(wu("menu-value"),e,(function(t){n.onAction({value:t})}),o,r,NC.CLOSE_ON_EXECUTE,(function(){return!1}),t.shared.providers),u=m(m({},i),{markers:lO(r),movement:EO(o,r)});return{type:"widget",data:{value:wu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[KC().widget(ax.sketch(u))]}}var AO,MO={inserttable:ok,colorswatch:DO},FO=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)?w.some(n[t]):w.none()},IO=function(n,t){return FO(MO,n.fancytype).map((function(e){return e(n,t)}))},RO=function(n,t,e,o){void 0===o&&(o=!0);var r=function(n){return{isDisabled:function(){return EC.isDisabled(n)},setDisabled:function(t){return EC.set(n,t)}}},i=sC({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:w.none(),ariaLabel:n.text,caret:w.none(),checkMark:w.none(),shortcutContent:n.shortcut},e,o);return LC({data:jC(n),getApi:r,disabled:n.disabled,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,t)},VO=function(n,t,o,r,i){void 0===r&&(r=!0),void 0===i&&(i=!1);var u=i?rC(o.icons):oC(o.icons),a=function(n){return{isDisabled:function(){return EC.isDisabled(n)},setDisabled:function(t){return EC.set(n,t)}}},c=sC({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:w.none(),ariaLabel:n.text,caret:w.some(u),checkMark:w.none(),shortcutContent:n.shortcut},o,r);return LC({data:jC(n),getApi:a,disabled:n.disabled,onAction:e,onSetup:n.onSetup,triggersSubmenu:!0,itemBehaviours:[]},c,t)},NO=function(n){var t=n.text.fold((function(){return{}}),(function(n){return{innerHtml:n}}));return{type:"separator",dom:m({tag:"div",classes:[RS,PS]},t),components:[]}},HO=function(n,t,e){var o=function(n){return{setActive:function(t){Vy.set(n,t)},isActive:function(){return Vy.isOn(n)},isDisabled:function(){return EC.isDisabled(n)},setDisabled:function(t){return EC.set(n,t)}}},r=sC({iconContent:w.none(),textContent:n.text,htmlContent:w.none(),ariaLabel:n.text,checkMark:w.some(eC(e.icons)),caret:w.none(),shortcutContent:n.shortcut,presets:"normal",meta:n.meta},e,!0);return Bn(LC({data:jC(n),disabled:n.disabled,getApi:o,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,t),{toggling:{toggleClass:HS,toggleOnExecute:!1,selected:n.active}})},PO=YC,zO=NO,LO=RO,jO=VO,UO=HO,WO=IO;(function(n){n[n["ContentFocus"]=0]="ContentFocus",n[n["UiFocus"]=1]="UiFocus"})(AO||(AO={}));var GO=function(n){return void 0!==n.icon||"togglemenuitem"===n.type||"choicemenuitem"===n.type},XO=function(n){return L(n,GO)},YO=function(n,e,o,r,i){var u=o.shared.providers,a=function(n){return i?m(m({},n),{shortcut:w.none(),icon:n.text.isSome()?w.none():n.icon}):n};switch(n.type){case"menuitem":return aS(n).fold(CO,(function(n){return w.some(LO(a(n),e,u,r))}));case"nestedmenuitem":return sS(n).fold(CO,(function(n){return w.some(jO(a(n),e,u,r,i))}));case"togglemenuitem":return lS(n).fold(CO,(function(n){return w.some(UO(a(n),e,u))}));case"separator":return $w(n).fold(CO,(function(n){return w.some(zO(n))}));case"fancymenuitem":return hS(n).fold(CO,(function(n){return WO(a(n),o)}));default:return t.console.error("Unknown item in general menu",n),w.none()}},qO=function(n,t,e,o,r,i){var u=1===o,a=!u||XO(n);return qp(W(n,(function(n){return"separator"===n.type?nS(n).fold(CO,(function(n){return w.some(zO(n))})):tS(n).fold(CO,(function(n){return w.some(PO(n,t,u,"normal",e,r,i,a))}))})))},KO=function(n,t,e,o,r){var i=XO(t),u=qp(W(t,(function(n){var t=function(n){return r?!n.hasOwnProperty("text"):i},u=function(n){return YO(n,e,o,t(n),r)};return"nestedmenuitem"===n.type&&n.getSubmenuItems().length<=0?u(m(m({},n),{disabled:!0})):u(n)}))),a=r?kO:OO;return a(n,i,u,1,"normal")},JO=function(n){return yx.singleData(n.value,n)},$O=function(n,t,e,o){var r=e===AO.ContentFocus?Gh():Wh(),i=EO(t,o),u=lO(o);return{dom:n.dom,components:n.components,items:n.items,value:n.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===AO.ContentFocus,focusManager:r,menuBehaviours:xS.unnamedEvents("auto"!==t?[]:[wi((function(n,t){vS(n,4,u.item).each((function(t){var e=t.numColumns,o=t.numRows;Jb.setGridSize(n,o,e)}))}))])}},QO=function(n,e){var o=He(w.none()),r=He(!1),i=ec(Sx.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:xf([cy("dismissAutocompleter",[li(Yr(),(function(){return s()}))])]),lazySink:e.getSink})),u=function(){return Sx.isOpen(i)},a=function(){return o.get().isSome()},c=function(){a()&&Sx.hide(i)},s=function(){if(a()){var t=o.get().map((function(n){return n.element}));Bw(t.getOr(We.fromDom(n.selection.getNode()))).each($i),c(),o.set(w.none()),r.set(!1)}},f=An((function(){return rS(n)})),l=function(o,i){var u=ln(i,(function(n){return w.from(n.columns)})).getOr(1);return nn(i,(function(i){var a=i.items;return qO(a,i.matchText,(function(e,u){var a=n.selection.getRng();Vw(n.dom,a,o).fold((function(){return t.console.error("Lost context. Cursor probably moved")}),(function(n){var t=n.range,o={hide:function(){s()},reload:function(n){c(),p(n)}};r.set(!0),i.onAction(o,t,e,u),r.set(!1)}))}),u,NC.BUBBLE_TO_SANDBOX,e)}))},d=function(t){if(!a()){var e=Ew(n,t.range);o.set(w.some({triggerChar:t.triggerChar,element:e,matchLength:t.text.length})),r.set(!1)}},m=function(t,e,o,r){t.matchLength=e.text.length;var u=ln(o,(function(n){return w.from(n.columns)})).getOr(1);Sx.showAt(i,{anchor:"node",root:We.fromDom(n.getBody()),node:w.from(t.element)},ax.sketch($O(OO("autocompleter-value",!0,r,u,"normal"),u,AO.ContentFocus,"normal"))),Sx.getContent(i).each(Sh.highlightFirst)},g=function(t){return o.get().map((function(e){return Vw(n.dom,n.selection.getRng(),e.triggerChar).bind((function(e){return Kw(n,f,e,t)}))})).getOrThunk((function(){return qw(n,f)}))},p=function(n){g(n).fold(s,(function(n){d(n.context),n.lookupData.then((function(t){o.get().map((function(e){var o=n.context;if(e.triggerChar===o.triggerChar){var r=l(o.triggerChar,t);r.length>0?m(e,o,t,r):o.text.length-e.matchLength>=10?s():c()}}))}))}))},h=Cw((function(n){27!==n.which&&p()}),50),v={onKeypress:h,cancelIfNecessary:s,isMenuOpen:u,isActive:a,isProcessingAction:r.get,getView:function(){return Sx.getContent(i)}};Hw.setup(v,n)},ZO={register:QO},n_=i(!0),t_=function(n,t,e){return kc(n,t,n_,e)},e_=function(n,t,e){return Oc(n,t,n_,e)},o_=wc,r_=function(n,t,e){return Qc(n,t,e).isSome()};function i_(n,e){var o=null,r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o=t.setTimeout((function(){n.apply(null,r),o=null}),e)},i=function(){null!==o&&(t.clearTimeout(o),o=null)};return{cancel:i,schedule:r}}var u_=5,a_=400,c_=function(n){var t=n.raw();return void 0===t.touches||1!==t.touches.length?w.none():w.some(t.touches[0])},s_=function(n,t){var e=Math.abs(n.clientX-t.x()),o=Math.abs(n.clientY-t.y());return e>u_||o>u_},f_=function(n){var t=He(w.none()),e=He(!1),o=i_((function(t){n.triggerEvent(Nr(),t),e.set(!0)}),a_),r=function(n){return c_(n).each((function(r){o.cancel();var u={x:i(r.clientX),y:i(r.clientY),target:n.target};o.schedule(n),e.set(!1),t.set(w.some(u))})),w.none()},u=function(n){return o.cancel(),c_(n).each((function(n){t.get().each((function(e){s_(n,e)&&t.set(w.none())}))})),w.none()},a=function(r){o.cancel();var i=function(n){return Qo(n.target(),r.target())};return t.get().filter(i).map((function(t){return e.get()?(r.prevent(),!1):n.triggerEvent(Vr(),r)}))},c=et([{key:lr(),value:r},{key:dr(),value:u},{key:mr(),value:a}]),s=function(n,t){return xn(c,t).bind((function(t){return t(n)}))};return{fireIfReady:s}},l_=function(n){var t=n.raw();return t.which===Ch()[0]&&!z(["input","textarea"],tu(n.target()))&&!r_(n.target(),'[contenteditable="true"]')},d_=jo().browser.isFirefox(),m_=Bt([ge("triggerEvent"),Te("stopBackspace",!0)]),g_=function(n,t){return d_?e_(n,"focus",t):t_(n,"focusin",t)},p_=function(n,t){return d_?e_(n,"blur",t):t_(n,"focusout",t)},h_=function(n,e){var o=Kt("Getting GUI events settings",m_,e),r=["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"],i=f_(o),u=W(r.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(t){return t_(n,t,(function(n){i.fireIfReady(n,t).each((function(t){t&&n.kill()}));var e=o.triggerEvent(t,n);e&&n.kill()}))})),a=He(w.none()),c=t_(n,"paste",(function(n){i.fireIfReady(n,"paste").each((function(t){t&&n.kill()}));var e=o.triggerEvent("paste",n);e&&n.kill(),a.set(w.some(t.setTimeout((function(){o.triggerEvent(Mr(),n)}),0)))})),s=t_(n,"keydown",(function(n){var t=o.triggerEvent("keydown",n);t?n.kill():!0===o.stopBackspace&&l_(n)&&n.prevent()})),f=g_(n,(function(n){var t=o.triggerEvent("focusin",n);t&&n.kill()})),l=He(w.none()),d=p_(n,(function(n){var e=o.triggerEvent("focusout",n);e&&n.kill(),l.set(w.some(t.setTimeout((function(){o.triggerEvent(Ar(),n)}),0)))})),m=function(){G(u,(function(n){n.unbind()})),s.unbind(),f.unbind(),d.unbind(),c.unbind(),a.get().each(t.clearTimeout),l.get().each(t.clearTimeout)};return{unbind:m}},v_=function(n,t){var e=xn(n,"target").map((function(n){return n()})).getOr(t);return He(e)},b_=function(n,t){var e=He(!1),o=He(!1),r=function(){e.set(!0)},u=function(){o.set(!0)};return{stop:r,cut:u,isStopped:e.get,isCut:o.get,event:i(n),setSource:t.set,getSource:t.get}},y_=function(n){var t=He(!1),o=function(){t.set(!0)};return{stop:o,cut:e,isStopped:t.get,isCut:i(!1),event:i(n),setSource:s("Cannot set source of a broadcasted event"),getSource:s("Cannot get source of a broadcasted event")}},x_=kn.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),w_=function(n,t,e,o,r,i){var u=n(t,o),a=b_(e,r);return u.fold((function(){return i.logEventNoHandlers(t,o),x_.complete()}),(function(n){var e=n.descHandler(),o=na(e);return o(a),a.isStopped()?(i.logEventStopped(t,n.element(),e.purpose()),x_.stopped()):a.isCut()?(i.logEventCut(t,n.element(),e.purpose()),x_.complete()):Ri(n.element()).fold((function(){return i.logNoParent(t,n.element(),e.purpose()),x_.complete()}),(function(o){return i.logEventResponse(t,n.element(),e.purpose()),x_.resume(o)}))}))},S_=function(n,t,e,o,r,i){return w_(n,t,e,o,r,i).fold((function(){return!0}),(function(o){return S_(n,t,e,o,r,i)}),(function(){return!1}))},C_=function(n,t,e,o,r){var i=v_(e,o);return w_(n,t,e,o,i,r)},k_=function(n,t,e){var o=y_(t);return G(n,(function(n){var t=n.descHandler(),e=na(t);e(o)})),o.isStopped()},O_=function(n,t,e,o){var r=e.target();return __(n,t,e,r,o)},__=function(n,t,e,o,r){var i=v_(e,o);return S_(n,t,e,o,i,r)},T_=Oi("element","descHandler"),E_=function(n,t){return{id:i(n),descHandler:i(t)}};function B_(){var n={},t=function(t,e,o){gn(o,(function(o,r){var i=void 0!==n[r]?n[r]:{};i[e]=Zu(o,t),n[r]=i}))},e=function(n,t){return Eu(t).fold((function(){return w.none()}),(function(e){return n.bind((function(n){return xn(n,e)})).map((function(n){return T_(t,n)}))}))},o=function(t){return xn(n,t).map((function(n){return vn(n,(function(n,t){return E_(t,n)}))})).getOr([])},r=function(t,o,r){var i=xn(n,o);return rr(r,(function(n){return e(i,n)}),t)},i=function(t){gn(n,(function(n,e){n.hasOwnProperty(t)&&delete n[t]}))};return{registerId:t,unregisterId:i,filterByType:o,find:r}}function D_(){var n=B_(),t={},e=function(n){var t=n.element();return Eu(t).fold((function(){return _u("uid-",n.element())}),(function(n){return n}))},o=function(n,e){var o=t[e];if(o!==n)throw new Error('The tagId "'+e+'" is already used by: '+hu(o.element())+"\nCannot use it for: "+hu(n.element())+"\nThe conflicting element is"+(Ta(o.element())?" ":" not ")+"already in the DOM");i(n)},r=function(r){var i=e(r);Sn(t,i)&&o(r,i);var u=[r];n.registerId(u,i,r.events()),t[i]=r},i=function(e){Eu(e.element()).each((function(e){delete t[e],n.unregisterId(e)}))},u=function(t){return n.filterByType(t)},a=function(t,e,o){return n.find(t,e,o)},c=function(n){return xn(t,n)};return{find:a,filter:u,register:r,unregister:i,getById:c}}var A_=function(n){var t=n.dom,e=t.attributes,o=g(t,["attributes"]);return{uid:n.uid,dom:m({tag:"div",attributes:m({role:"presentation"},e)},o),components:n.components,behaviours:Rg(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},M_=Xp({name:"Container",factory:A_,configFields:[Te("components",[]),Ig("containerBehaviours",[]),Te("events",{}),Te("domModification",{}),Te("eventOrder",{})]}),F_=function(n){var t=function(t){return Ri(n.element()).fold((function(){return!0}),(function(n){return Qo(t,n)}))},o=D_(),r=function(n,e){return o.find(t,n,e)},u=h_(n.element(),{triggerEvent:function(n,t){return ls(n,t.target(),(function(e){return O_(r,n,t,e)}))}}),a={debugInfo:i("real"),triggerEvent:function(n,t,e){ls(n,t,(function(o){return __(r,n,e,t,o)}))},triggerFocus:function(n,t){Eu(n).fold((function(){Ff(n)}),(function(o){ls(Dr(),n,(function(o){return C_(r,Dr(),{originator:i(t),kill:e,prevent:e,target:i(n)},n,o),!1}))}))},triggerEscape:function(n,t){a.triggerEvent("keydown",n.element(),t.event())},getByUid:function(n){return v(n)},getByDom:function(n){return b(n)},build:ec,addToGui:function(n){f(n)},removeFromGui:function(n){l(n)},addToWorld:function(n){c(n)},removeFromWorld:function(n){s(n)},broadcast:function(n){g(n)},broadcastOn:function(n,t){p(n,t)},broadcastEvent:function(n,t){h(n,t)},isConnected:i(!0)},c=function(n){n.connect(a),iu(n.element())||(o.register(n),G(n.components(),c),a.triggerEvent(zr(),n.element(),{target:i(n.element())}))},s=function(n){iu(n.element())||(G(n.components(),s),o.unregister(n)),n.disconnect()},f=function(t){Cm(n,t)},l=function(n){_m(n)},d=function(){u.unbind(),Ji(n.element())},m=function(n){var t=o.filter(Fr());G(t,(function(t){var e=t.descHandler(),o=na(e);o(n)}))},g=function(n){m({universal:i(!0),data:i(n)})},p=function(n,t){m({universal:i(!1),channels:i(n),data:i(t)})},h=function(n,t){var e=o.filter(n);return k_(e,t)},v=function(n){return o.getById(n).fold((function(){return O.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),O.value)},b=function(n){var t=Eu(n).getOr("not found");return v(t)};return c(n),{root:i(n),element:n.element,destroy:d,add:f,remove:l,getByUid:v,getByDom:b,addToWorld:c,removeFromWorld:s,broadcast:g,broadcastOn:p,broadcastEvent:h}},I_=wu("form-component-change"),R_=wu("form-close"),V_=wu("form-cancel"),N_=wu("form-action"),H_=wu("form-submit"),P_=wu("form-block"),z_=wu("form-unblock"),L_=wu("form-tabchange"),j_=wu("form-resize"),U_=function(n,t){return M_.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+n.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[lw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:gw(n.icon,t.icons),attributes:{title:t.translate(n.iconTooltip)}},action:function(t){ei(t,N_,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(n.text)}}]})},W_=function(n,t){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:W(n.items,t.interpreter)}},G_=i([Te("prefix","form-field"),Ig("fieldBehaviours",[eh,Fg])]),X_=i([gp({schema:[ce("dom")],name:"label"}),gp({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[ce("text")],name:"aria-descriptor"}),dp({factory:{sketch:function(n){var t=nt(n,["factory"]);return n.factory.sketch(t)}},schema:[ce("factory")],name:"field"})]),Y_=function(n,t,e,o){var r=Vg(n.fieldBehaviours,[eh.config({find:function(t){return Tp(t,n,"field")}}),Fg.config({store:{mode:"manual",getValue:function(n){return eh.getCurrent(n).bind(Fg.getValue)},setValue:function(n,t){eh.getCurrent(n).each((function(n){Fg.setValue(n,t)}))}}})]),i=ai([wi((function(t,e){var o=Bp(t,n,["label","field","aria-descriptor"]);o.field().each((function(t){var e=wu(n.prefix);o.label().each((function(n){au(n.element(),"for",e),au(t.element(),"id",e)})),o["aria-descriptor"]().each((function(e){var o=wu(n.prefix);au(e.element(),"id",o),au(t.element(),"aria-describedby",o)}))}))}))]),u={getField:function(t){return Tp(t,n,"field")},getLabel:function(t){return Tp(t,n,"label")}};return{uid:n.uid,dom:n.dom,components:t,behaviours:r,events:i,apis:u}},q_=Yp({name:"FormField",configFields:G_(),partFields:X_(),factory:Y_,apis:{getField:function(n,t){return n.getField(t)},getLabel:function(n,t){return n.getLabel(t)}}}),K_=i([ye("data"),Te("inputAttributes",{}),Te("inputStyles",{}),Te("tag","input"),Te("inputClasses",[]),ws("onSetValue"),Te("styles",{}),Te("eventOrder",{}),Ig("inputBehaviours",[Fg,vy]),Te("selectOnFocus",!0)]),J_=function(n){return xf([vy.config({onFocus:n.selectOnFocus?function(n){var t=n.element(),e=ja(t);t.dom().setSelectionRange(0,e.length)}:e})])},$_=function(n){return m(m({},J_(n)),Vg(n.inputBehaviours,[Fg.config({store:m(m({mode:"manual"},n.data.map((function(n){return{initialValue:n}})).getOr({})),{getValue:function(n){return ja(n.element())},setValue:function(n,t){var e=ja(n.element());e!==t&&Ua(n.element(),t)}}),onSetValue:n.onSetValue})]))},Q_=function(n){return{tag:n.tag,attributes:m({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}},Z_=function(n,t){return{uid:n.uid,dom:Q_(n),components:[],behaviours:$_(n),eventOrder:n.eventOrder}},nT=Xp({name:"Input",configFields:K_(),factory:Z_}),tT={},eT={exports:tT};(function(t,e,o,r){(function(r){if("object"===typeof e&&"undefined"!==typeof o)o.exports=r();else if("function"===typeof t&&t.amd)t([],r);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof n?n:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=r()}})((function(){return function(){function n(t,e,o){function i(a,c){if(!e[a]){if(!t[a]){var s="function"==typeof r&&r;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}};t[a][0].call(l.exports,(function(n){var e=t[a][1][n];return i(e||n)}),l,l.exports,n,t,e,o)}return e[a].exports}for(var u="function"==typeof r&&r,a=0;a<o.length;a++)i(o[a]);return i}return n}()({1:[function(n,t,e){var o,r,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(n){if(o===setTimeout)return setTimeout(n,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(n,0);try{return o(n,0)}catch(t){try{return o.call(null,n,0)}catch(t){return o.call(this,n,0)}}}function s(n){if(r===clearTimeout)return clearTimeout(n);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n);try{return r(n)}catch(t){try{return r.call(null,n)}catch(t){return r.call(this,n)}}}(function(){try{o="function"===typeof setTimeout?setTimeout:u}catch(n){o=u}try{r="function"===typeof clearTimeout?clearTimeout:a}catch(n){r=a}})();var f,l=[],d=!1,m=-1;function g(){d&&f&&(d=!1,f.length?l=f.concat(l):m=-1,l.length&&p())}function p(){if(!d){var n=c(g);d=!0;var t=l.length;while(t){f=l,l=[];while(++m<t)f&&f[m].run();m=-1,t=l.length}f=null,d=!1,s(n)}}function h(n,t){this.fun=n,this.array=t}function v(){}i.nextTick=function(n){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];l.push(new h(n,t)),1!==l.length||d||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){(function(e){var o=setTimeout;function r(){}function i(n,t){return function(){n.apply(t,arguments)}}function u(n){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(n,this)}function a(n,t){while(3===n._state)n=n._value;0!==n._state?(n._handled=!0,u._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected;if(null!==e){var o;try{o=e(n._value)}catch(r){return void s(t.promise,r)}c(t.promise,o)}else(1===n._state?c:s)(t.promise,n._value)}))):n._deferreds.push(t)}function c(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var e=t.then;if(t instanceof u)return n._state=3,n._value=t,void f(n);if("function"===typeof e)return void d(i(e,t),n)}n._state=1,n._value=t,f(n)}catch(o){s(n,o)}}function s(n,t){n._state=2,n._value=t,f(n)}function f(n){2===n._state&&0===n._deferreds.length&&u._immediateFn((function(){n._handled||u._unhandledRejectionFn(n._value)}));for(var t=0,e=n._deferreds.length;t<e;t++)a(n,n._deferreds[t]);n._deferreds=null}function l(n,t,e){this.onFulfilled="function"===typeof n?n:null,this.onRejected="function"===typeof t?t:null,this.promise=e}function d(n,t){var e=!1;try{n((function(n){e||(e=!0,c(t,n))}),(function(n){e||(e=!0,s(t,n))}))}catch(o){if(e)return;e=!0,s(t,o)}}u.prototype["catch"]=function(n){return this.then(null,n)},u.prototype.then=function(n,t){var e=new this.constructor(r);return a(this,new l(n,t,e)),e},u.all=function(n){var t=Array.prototype.slice.call(n);return new u((function(n,e){if(0===t.length)return n([]);var o=t.length;function r(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(n){r(i,n)}),e)}t[i]=u,0===--o&&n(t)}catch(c){e(c)}}for(var i=0;i<t.length;i++)r(i,t[i])}))},u.resolve=function(n){return n&&"object"===typeof n&&n.constructor===u?n:new u((function(t){t(n)}))},u.reject=function(n){return new u((function(t,e){e(n)}))},u.race=function(n){return new u((function(t,e){for(var o=0,r=n.length;o<r;o++)n[o].then(t,e)}))},u._immediateFn="function"===typeof n?function(t){n(t)}:function(n){o(n,0)},u._unhandledRejectionFn=function(n){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},u._setImmediateFn=function(n){u._immediateFn=n},u._setUnhandledRejectionFn=function(n){u._unhandledRejectionFn=n},"undefined"!==typeof t&&t.exports?t.exports=u:e.Promise||(e.Promise=u)})(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,o){var r=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"===typeof t?t:function(n){var t=c++,o=!(arguments.length<2)&&u.call(arguments,1);return a[t]=!0,r((function(){a[t]&&(o?n.apply(null,o):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"===typeof o?o:function(n){delete a[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var o=n("promise-polyfill"),r=function(){return"undefined"!==typeof window?window:Function("return this;")()}();t.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,tT,eT,void 0);var oT,rT=eT.exports.boltExport,iT=function(n){var e=w.none(),o=[],r=function(n){return iT((function(t){i((function(e){t(n(e))}))}))},i=function(n){a()?s(n):o.push(n)},u=function(n){e=w.some(n),c(o),o=[]},a=function(){return e.isSome()},c=function(n){G(n,s)},s=function(n){e.each((function(e){t.setTimeout((function(){n(e)}),0)}))};return n(u),{get:i,map:r,isReady:a}},uT=function(n){return iT((function(t){t(n)}))},aT={nu:iT,pure:uT},cT=function(n){t.setTimeout((function(){throw n}),0)},sT=function(n){var t=function(t){n().then(t,cT)},e=function(t){return sT((function(){return n().then(t)}))},o=function(t){return sT((function(){return n().then((function(n){return t(n).toPromise()}))}))},r=function(t){return sT((function(){return n().then((function(){return t.toPromise()}))}))},i=function(){return aT.nu(t)},u=function(){var t=null;return sT((function(){return null===t&&(t=n()),t}))},a=n;return{map:e,bind:o,anonBind:r,toLazy:i,toCached:u,toPromise:a,get:t}},fT=function(n){return sT((function(){return new rT(n)}))},lT=function(n){return sT((function(){return rT.resolve(n)}))},dT={nu:fT,pure:lT},mT=["input","textarea"],gT=function(n){var t=tu(n);return z(mT,t)},pT=function(n,t){var e=t.getRoot(n).getOr(n.element());Sa(e,t.invalidClass),t.notify.each((function(t){gT(n.element())&&au(n.element(),"aria-invalid",!1),t.getContainer(n).each((function(n){Zi(n,t.validHtml)})),t.onValid(n)}))},hT=function(n,t,e,o){var r=t.getRoot(n).getOr(n.element());xa(r,t.invalidClass),t.notify.each((function(t){gT(n.element())&&au(n.element(),"aria-invalid",!0),t.getContainer(n).each((function(n){Zi(n,o)})),t.onInvalid(n,o)}))},vT=function(n,t,e){return t.validator.fold((function(){return dT.pure(O.value(!0))}),(function(t){return t.validate(n)}))},bT=function(n,t,e){return t.notify.each((function(t){t.onValidate(n)})),vT(n,t).map((function(o){return n.getSystem().isConnected()?o.fold((function(o){return hT(n,t,e,o),O.error(o)}),(function(e){return pT(n,t),O.value(e)})):O.error("No longer in system")}))},yT=function(n,t){var e=t.getRoot(n).getOr(n.element());return Ca(e,t.invalidClass)},xT=Object.freeze({__proto__:null,markValid:pT,markInvalid:hT,query:vT,run:bT,isInvalid:yT}),wT=function(n,t){return n.validator.map((function(o){return ai([li(o.onEvent,(function(e){bT(e,n,t).get(u)}))].concat(o.validateOnLoad?[wi((function(o){bT(o,n,t).get(e)}))]:[]))})).getOr({})},ST=Object.freeze({__proto__:null,events:wT}),CT=[ce("invalidClass"),Te("getRoot",w.none),Oe("notify",[Te("aria","alert"),Te("getContainer",w.none),Te("validHtml",""),ws("onValid"),ws("onInvalid"),ws("onValidate")]),Oe("validator",[ce("validate"),Te("onEvent","input"),Te("validateOnLoad",!0)])],kT=Sf({fields:CT,name:"invalidating",active:ST,apis:xT,extra:{validation:function(n){return function(t){var e=Fg.getValue(t);return dT.pure(n(e))}}}}),OT=function(n,t){return Yu({attributes:et([{key:t.tabAttr,value:"true"}])})},_T=Object.freeze({__proto__:null,exhibit:OT}),TT=[Te("tabAttr","data-alloy-tabstop")],ET=Sf({fields:TT,name:"tabstopping",active:_T}),BT=function(n,t,e,o){var r=AT(n,t,e,o);return q_.sketch(r)},DT=function(n,t){return BT(n,t,[],[])},AT=function(n,t,e,o){return{dom:FT(e),components:n.toArray().concat([t]),fieldBehaviours:xf(o)}},MT=function(){return FT([])},FT=function(n){return{tag:"div",classes:["tox-form__group"].concat(n)}},IT=function(n,t){return q_.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}})},RT=function(n,t,e,o){return e.getOrCreate(n,t,o)},VT=Object.freeze({__proto__:null,getCoupled:RT}),NT=[se("others",Gt(O.value,Zt()))],HT=function(){var n={},t=function(t,e,o){var r=dn(e.others);if(r)return xn(n,o).getOrThunk((function(){var r=xn(e.others,o).getOrDie("No information found for coupled component: "+o),i=r(t),u=t.getSystem().build(i);return n[o]=u,u}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))},e=i({});return ju({readState:e,getOrCreate:t})},PT=Object.freeze({__proto__:null,init:HT}),zT=Sf({fields:NT,name:"coupling",apis:VT,state:PT}),LT=i("sink"),jT=i(gp({name:LT(),overrides:i({dom:{tag:"div"},behaviours:xf([vm.config({useFixed:l})]),events:ai([bi(Sr()),bi(pr()),bi(_r())])})}));(function(n){n[n["HighlightFirst"]=0]="HighlightFirst",n[n["HighlightNone"]=1]="HighlightNone"})(oT||(oT={}));var UT=function(n,t){var e=n.getHotspot(t).getOr(t),o="hotspot",r=n.getAnchorOverrides();return n.layouts.fold((function(){return{anchor:o,hotspot:e,overrides:r}}),(function(n){return{anchor:o,hotspot:e,overrides:r,layouts:n}}))},WT=function(n,t,e){var o=n.fetch;return o(e).map(t)},GT=function(n,t,e,o,r,i,u){var a=WT(n,t,o),c=JT(o,n);return a.map((function(n){return n.bind((function(n){return w.from(yx.sketch(m(m({},i.menu()),{uid:Bu(""),data:n,highlightImmediately:u===oT.HighlightFirst,onOpenMenu:function(n,t){var o=c().getOrDie();vm.position(o,e,t),$m.decloak(r)},onOpenSubmenu:function(n,t,e){var o=c().getOrDie();vm.position(o,{anchor:"submenu",item:t},e),$m.decloak(r)},onRepositionMenu:function(n,t,o){var r=c().getOrDie();vm.position(r,e,t),G(o,(function(n){vm.position(r,{anchor:"submenu",item:n.triggeringItem},n.triggeredMenu)}))},onEscape:function(){return vy.focus(o),$m.close(r),w.some(!0)}})))}))}))},XT=function(n,t,e,o,r,i,u){var a=UT(n,e),c=GT(n,t,a,e,o,r,u);return c.map((function(n){return n.fold((function(){$m.isOpen(o)&&$m.close(o)}),(function(n){$m.cloak(o),$m.open(o,n),i(o)})),o}))},YT=function(n,t,e,o,r,i,u){return $m.close(o),dT.pure(o)},qT=function(n,t,e,o,r,i){var u=zT.getCoupled(e,"sandbox"),a=$m.isOpen(u),c=a?YT:XT;return c(n,t,e,u,o,r,i)},KT=function(n,t,e){var o=eh.getCurrent(t).getOr(t),r=vc(n.element());e?Ma(o.element(),"min-width",r+"px"):hc(o.element(),r)},JT=function(n,t){return n.getSystem().getByUid(t.uid+"-"+LT()).map((function(n){return function(){return O.value(n)}})).getOrThunk((function(){return t.lazySink.fold((function(){return function(){return O.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(t){return function(){return t(n)}}))}))},$T=function(n){$m.getState(n).each((function(n){yx.repositionMenus(n)}))},QT=function(n,t,e){var o=ns(),r=function(r,i){var u=UT(n,t);o.link(t.element()),n.matchWidth&&KT(u.hotspot,i,n.useMinWidth),n.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},i=function(n,r){o.unlink(t.element()),void 0!==e&&void 0!==e.onClose&&e.onClose(n,r)},u=JT(t,n);return{dom:{tag:"div",classes:n.sandboxClasses,attributes:{id:o.id(),role:"listbox"}},behaviours:Ng.augment(n.sandboxBehaviours,[Fg.config({store:{mode:"memory",initialValue:t}}),$m.config({onOpen:r,onClose:i,isPartOf:function(n,e,o){return es(e,o)||es(t,o)},getAttachPoint:function(){return u().getOrDie()}}),eh.config({find:function(n){return $m.getState(n).bind((function(n){return eh.getCurrent(n)}))}}),Df.config({channels:m(m({},eg({isExtraPart:f})),rg({doReposition:$T}))})])}},ZT=function(n){var t=zT.getCoupled(n,"sandbox");$T(t)},nE=function(){return[Te("sandboxClasses",[]),Ng.field("sandboxBehaviours",[eh,Df,$m,Fg])]},tE=i([ce("dom"),ce("fetch"),ws("onOpen"),Ss("onExecute"),Te("getHotspot",w.some),Te("getAnchorOverrides",i({})),_l(),Ig("dropdownBehaviours",[Vy,zT,Jb,vy]),ce("toggleClass"),Te("eventOrder",{}),ye("lazySink"),Te("matchWidth",!1),Te("useMinWidth",!1),ye("role")].concat(nE())),eE=i([mp({schema:[bs()],name:"menu",defaults:function(n){return{onExecute:n.onExecute}}}),jT()]),oE=function(n,t,o,r){var i,u=function(t){return xn(n.dom,"attributes").bind((function(n){return xn(n,t)}))},a=function(n){$m.getState(n).each((function(n){yx.highlightPrimary(n)}))},c=function(t){var o=a;qT(n,(function(n){return n}),t,r,o,oT.HighlightFirst).get(e)},s={expand:function(t){Vy.isOn(t)||qT(n,(function(n){return n}),t,r,e,oT.HighlightNone).get(e)},open:function(t){Vy.isOn(t)||qT(n,(function(n){return n}),t,r,e,oT.HighlightFirst).get(e)},isOpen:Vy.isOn,close:function(t){Vy.isOn(t)&&qT(n,(function(n){return n}),t,r,e,oT.HighlightFirst).get(e)},repositionMenus:function(n){Vy.isOn(n)&&ZT(n)}},f=function(n,t){return oi(n),w.some(!0)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Vg(n.dropdownBehaviours,[Vy.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),zT.config({others:{sandbox:function(t){return QT(n,t,{onOpen:function(){Vy.on(t)},onClose:function(){Vy.off(t)}})}}}),Jb.config({mode:"special",onSpace:f,onEnter:f,onDown:function(n,t){if(rE.isOpen(n)){var e=zT.getCoupled(n,"sandbox");a(e)}else rE.open(n);return w.some(!0)},onEscape:function(n,t){return rE.isOpen(n)?(rE.close(n),w.some(!0)):w.none()}}),vy.config({})]),events:Hy(w.some(c)),eventOrder:m(m({},n.eventOrder),(i={},i[Ir()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:s,domModification:{attributes:m(m({"aria-haspopup":"true"},n.role.fold((function(){return{}}),(function(n){return{role:n}}))),"button"===n.dom.tag?{type:u("type").getOr("button")}:{})}}},rE=Yp({name:"Dropdown",configFields:tE(),partFields:eE(),factory:oE,apis:{open:function(n,t){return n.open(t)},expand:function(n,t){return n.expand(t)},close:function(n,t){return n.close(t)},isOpen:function(n,t){return n.isOpen(t)},repositionMenus:function(n,t){return n.repositionMenus(t)}}}),iE=function(){return Yu({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})},uE=function(){return ai([ci(Er(),i(!0))])},aE=Object.freeze({__proto__:null,events:uE,exhibit:iE}),cE=Sf({fields:[],name:"unselecting",active:aE}),sE=function(n,t){return rE.sketch({dom:n.dom,components:n.components,toggleClass:"mce-active",dropdownBehaviours:xf([cE.config({}),ET.config({})]),layouts:n.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:function(e){return dT.nu((function(t){return n.fetch(t)})).map((function(o){return w.from(JO(Bn(_O(wu("menu-value"),o,(function(t){n.onItemAction(e,t)}),n.columns,n.presets,NC.CLOSE_ON_EXECUTE,(function(){return!1}),t.providers),{movement:EO(n.columns,n.presets)})))}))},parts:{menu:gO(!1,1,n.presets)}})},fE=wu("color-input-change"),lE=wu("color-swatch-change"),dE=wu("color-picker-cancel"),mE=function(n,t,e){var o=q_.parts().field({factory:nT,inputClasses:["tox-textfield"],onSetValue:function(n){return kT.run(n).get((function(){}))},inputBehaviours:xf([ET.config({}),kT.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(n){return Ri(n.element())},notify:{onValid:function(n){var t=Fg.getValue(n);ei(n,fE,{color:t})}},validator:{validateOnLoad:!1,validate:function(n){var t=Fg.getValue(n);if(0===t.length)return dT.pure(O.value(!0));var e=We.fromTag("span");Ma(e,"background-color",t);var o=Na(e,"background-color").fold((function(){return O.error("blah")}),(function(n){return O.value(t)}));return dT.pure(o)}}})]),selectOnFocus:!1}),r=n.label.map((function(n){return IT(n,t.providers)})),i=function(n,t){ei(n,lE,{value:t})},u=function(n,t){a.getOpt(n).each((function(n){"custom"===t?e.colorPicker((function(t){t.fold((function(){return ti(n,dE)}),(function(t){i(n,t),Hk.addColor(t)}))}),"#ffffff"):i(n,"remove"===t?"":t)}))},a=dw(sE({dom:{tag:"span",attributes:{"aria-label":t.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Zs,Qs,of]},onLtr:function(){return[Qs,Zs,of]}},components:[],fetch:cO.getFetch(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:u},t));return q_.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,a.asSpec()]}]),fieldBehaviours:xf([cy("form-field-events",[li(fE,(function(t,e){a.getOpt(t).each((function(n){Ma(n.element(),"background-color",e.event().color())})),ei(t,I_,{name:n.name})})),li(lE,(function(n,t){q_.getField(n).each((function(e){Fg.setValue(e,t.event().value()),eh.getCurrent(n).each(vy.focus)}))})),li(dE,(function(n,t){q_.getField(n).each((function(t){eh.getCurrent(n).each(vy.focus)}))}))])])})},gE=function(n,t,e){return{hue:i(n),saturation:i(t),value:i(e)}},pE=function(n){var t=0,e=0,o=0,r=n.red()/255,i=n.green()/255,u=n.blue()/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));if(a===c)return o=a,gE(0,0,100*o);var s=r===a?i-u:u===a?r-i:u-r;return t=r===a?3:u===a?1:5,t=60*(t-s/(c-a)),e=(c-a)/c,o=c,gE(Math.round(t),Math.round(100*e),Math.round(100*o))},hE=function(n){var t=(100-n)/100*360,e=gE(t,100,100),o=yk(e);return lk(o)},vE=i(wu("rgb-hex-update")),bE=i(wu("slider-update")),yE=i(wu("palette-update")),xE=gp({schema:[ce("dom")],name:"label"}),wE=function(n){return gp({name:n+"-edge",overrides:function(t){var e=t.model.manager.edgeActions[n];return e.fold((function(){return{}}),(function(n){return{events:ai([di(lr(),(function(t,e,o){return n(t,o)}),[t]),di(pr(),(function(t,e,o){return n(t,o)}),[t]),di(hr(),(function(t,e,o){o.mouseIsDown.get()&&n(t,o)}),[t])])}}))}})},SE=wE("top-left"),CE=wE("top"),kE=wE("top-right"),OE=wE("right"),_E=wE("bottom-right"),TE=wE("bottom"),EE=wE("bottom-left"),BE=wE("left"),DE=dp({name:"thumb",defaults:i({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:ai([hi(lr(),n,"spectrum"),hi(dr(),n,"spectrum"),hi(mr(),n,"spectrum"),hi(pr(),n,"spectrum"),hi(hr(),n,"spectrum"),hi(br(),n,"spectrum")])}}}),AE=dp({schema:[Ne("mouseIsDown",(function(){return He(!1)}))],name:"spectrum",overrides:function(n){var t=n.model,e=t.manager,o=function(t,o){return e.getValueFromEvent(o).map((function(o){return e.setValueFrom(t,n,o)}))};return{behaviours:xf([Jb.config({mode:"special",onLeft:function(t){return e.onLeft(t,n)},onRight:function(t){return e.onRight(t,n)},onUp:function(t){return e.onUp(t,n)},onDown:function(t){return e.onDown(t,n)}}),vy.config({})]),events:ai([li(lr(),o),li(dr(),o),li(pr(),o),li(hr(),(function(t,e){n.mouseIsDown.get()&&o(t,e)}))])}}}),ME=[xE,BE,OE,CE,TE,SE,kE,EE,_E,DE,AE],FE="slider.change.value",IE=i(FE),RE=function(n){return-1!==n.type.indexOf("touch")},VE=function(n){var t=n.event().raw();if(RE(t)){var e=t;return void 0!==e.touches&&1===e.touches.length?w.some(e.touches[0]).map((function(n){return fc(n.clientX,n.clientY)})):w.none()}var o=t;return void 0!==o.clientX?w.some(o).map((function(n){return fc(n.clientX,n.clientY)})):w.none()},NE="top",HE="right",PE="bottom",zE="left",LE=function(n){return n.model.minX},jE=function(n){return n.model.minY},UE=function(n){return n.model.minX-1},WE=function(n){return n.model.minY-1},GE=function(n){return n.model.maxX},XE=function(n){return n.model.maxY},YE=function(n){return n.model.maxX+1},qE=function(n){return n.model.maxY+1},KE=function(n,t,e){return t(n)-e(n)},JE=function(n){return KE(n,GE,LE)},$E=function(n){return KE(n,XE,jE)},QE=function(n){return JE(n)/2},ZE=function(n){return $E(n)/2},nB=function(n){return n.stepSize},tB=function(n){return n.snapToGrid},eB=function(n){return n.snapStart},oB=function(n){return n.rounded},rB=function(n,t){return void 0!==n[t+"-edge"]},iB=function(n){return rB(n,zE)},uB=function(n){return rB(n,HE)},aB=function(n){return rB(n,NE)},cB=function(n){return rB(n,PE)},sB=function(n){return n.model.value.get()},fB=function(n){return{x:i(n)}},lB=function(n){return{y:i(n)}},dB=function(n,t){return{x:i(n),y:i(t)}},mB=function(n,t){ei(n,IE(),{value:t})},gB=function(n,t){mB(n,dB(UE(t),WE(t)))},pB=function(n,t){mB(n,lB(WE(t)))},hB=function(n,t){mB(n,dB(QE(t),WE(t)))},vB=function(n,t){mB(n,dB(YE(t),WE(t)))},bB=function(n,t){mB(n,fB(YE(t)))},yB=function(n,t){mB(n,dB(YE(t),ZE(t)))},xB=function(n,t){mB(n,dB(YE(t),qE(t)))},wB=function(n,t){mB(n,lB(qE(t)))},SB=function(n,t){mB(n,dB(QE(t),qE(t)))},CB=function(n,t){mB(n,dB(UE(t),qE(t)))},kB=function(n,t){mB(n,fB(UE(t)))},OB=function(n,t){mB(n,dB(UE(t),ZE(t)))},_B=function(n,t,e,o){return n<t?n:n>e?e:n===t?t-1:Math.max(t,n-o)},TB=function(n,t,e,o){return n>e?n:n<t?t:n===e?e+1:Math.min(e,n+o)},EB=function(n,t,e){return Math.max(t,Math.min(e,n))},BB=function(n,t,e,o,r){return r.fold((function(){var r=n-t,i=Math.round(r/o)*o;return EB(t+i,t-1,e+1)}),(function(t){var r=(n-t)%o,i=Math.round(r/o),u=Math.floor((n-t)/o),a=Math.floor((e-t)/o),c=Math.min(a,u+i),s=t+c*o;return Math.max(t,s)}))},DB=function(n,t,e){return Math.min(e,Math.max(n,t))-t},AB=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,i=n.step,u=n.snap,a=n.snapStart,c=n.rounded,s=n.hasMinEdge,f=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=s?t-1:t,p=f?e+1:e;if(r<l)return g;if(r>d)return p;var h=DB(r,l,d),v=EB(h/m*o+t,g,p);return u&&v>=t&&v<=e?BB(v,t,e,i,a):c?Math.round(v):v},MB=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,a=n.maxBound,c=n.maxOffset,s=n.centerMinEdge,f=n.centerMaxEdge;return r<t?i?0:s:r>e?u?a:f:(r-t)/o*c},FB="top",IB="right",RB="bottom",VB="left",NB="width",HB="height",PB=function(n){return n.element().dom().getBoundingClientRect()},zB=function(n,t){return n[t]},LB=function(n){var t=PB(n);return zB(t,VB)},jB=function(n){var t=PB(n);return zB(t,IB)},UB=function(n){var t=PB(n);return zB(t,FB)},WB=function(n){var t=PB(n);return zB(t,RB)},GB=function(n){var t=PB(n);return zB(t,NB)},XB=function(n){var t=PB(n);return zB(t,HB)},YB=function(n,t,e){return(n+t)/2-e},qB=function(n,t){var e=PB(n),o=PB(t),r=zB(e,VB),i=zB(e,IB),u=zB(o,VB);return YB(r,i,u)},KB=function(n,t){var e=PB(n),o=PB(t),r=zB(e,FB),i=zB(e,RB),u=zB(o,FB);return YB(r,i,u)},JB=function(n,t){ei(n,IE(),{value:t})},$B=function(n){return{x:i(n)}},QB=function(n,t,e){var o={min:LE(t),max:GE(t),range:JE(t),value:e,step:nB(t),snap:tB(t),snapStart:eB(t),rounded:oB(t),hasMinEdge:iB(t),hasMaxEdge:uB(t),minBound:LB(n),maxBound:jB(n),screenRange:GB(n)};return AB(o)},ZB=function(n,t,e){var o=QB(n,t,e),r=$B(o);return JB(n,r),o},nD=function(n,t){var e=LE(t);JB(n,$B(e))},tD=function(n,t){var e=GE(t);JB(n,$B(e))},eD=function(n,t,e){var o=n>0?TB:_B,r=o(sB(e).x(),LE(e),GE(e),nB(e));return JB(t,$B(r)),w.some(r)},oD=function(n){return function(t,e){return eD(n,t,e).map((function(){return!0}))}},rD=function(n){var t=VE(n);return t.map((function(n){return n.left()}))},iD=function(n,t,e,o,r){var i=0,u=GB(n),a=o.bind((function(t){return w.some(qB(t,n))})).getOr(i),c=r.bind((function(t){return w.some(qB(t,n))})).getOr(u),s={min:LE(t),max:GE(t),range:JE(t),value:e,hasMinEdge:iB(t),hasMaxEdge:uB(t),minBound:LB(n),minOffset:i,maxBound:jB(n),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return MB(s)},uD=function(n,t,e,o,r,i){var u=iD(t,i,e,o,r);return LB(t)-LB(n)+u},aD=function(n,t,e,o){var r=sB(e),i=uD(n,o.getSpectrum(n),r.x(),o.getLeftEdge(n),o.getRightEdge(n),e),u=vc(t.element())/2;Ma(t.element(),"left",i-u+"px")},cD=oD(-1),sD=oD(1),fD=w.none,lD=w.none,dD={"top-left":w.none(),top:w.none(),"top-right":w.none(),right:w.some(bB),"bottom-right":w.none(),bottom:w.none(),"bottom-left":w.none(),left:w.some(kB)},mD=Object.freeze({__proto__:null,setValueFrom:ZB,setToMin:nD,setToMax:tD,findValueOfOffset:QB,getValueFromEvent:rD,findPositionOfValue:uD,setPositionFromValue:aD,onLeft:cD,onRight:sD,onUp:fD,onDown:lD,edgeActions:dD}),gD=function(n,t){ei(n,IE(),{value:t})},pD=function(n){return{y:i(n)}},hD=function(n,t,e){var o={min:jE(t),max:XE(t),range:$E(t),value:e,step:nB(t),snap:tB(t),snapStart:eB(t),rounded:oB(t),hasMinEdge:aB(t),hasMaxEdge:cB(t),minBound:UB(n),maxBound:WB(n),screenRange:XB(n)};return AB(o)},vD=function(n,t,e){var o=hD(n,t,e),r=pD(o);return gD(n,r),o},bD=function(n,t){var e=jE(t);gD(n,pD(e))},yD=function(n,t){var e=XE(t);gD(n,pD(e))},xD=function(n,t,e){var o=n>0?TB:_B,r=o(sB(e).y(),jE(e),XE(e),nB(e));return gD(t,pD(r)),w.some(r)},wD=function(n){return function(t,e){return xD(n,t,e).map((function(){return!0}))}},SD=function(n){var t=VE(n);return t.map((function(n){return n.top()}))},CD=function(n,t,e,o,r){var i=0,u=XB(n),a=o.bind((function(t){return w.some(KB(t,n))})).getOr(i),c=r.bind((function(t){return w.some(KB(t,n))})).getOr(u),s={min:jE(t),max:XE(t),range:$E(t),value:e,hasMinEdge:aB(t),hasMaxEdge:cB(t),minBound:UB(n),minOffset:i,maxBound:WB(n),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return MB(s)},kD=function(n,t,e,o,r,i){var u=CD(t,i,e,o,r);return UB(t)-UB(n)+u},OD=function(n,t,e,o){var r=sB(e),i=kD(n,o.getSpectrum(n),r.y(),o.getTopEdge(n),o.getBottomEdge(n),e),u=uc(t.element())/2;Ma(t.element(),"top",i-u+"px")},_D=w.none,TD=w.none,ED=wD(-1),BD=wD(1),DD={"top-left":w.none(),top:w.some(pB),"top-right":w.none(),right:w.none(),"bottom-right":w.none(),bottom:w.some(wB),"bottom-left":w.none(),left:w.none()},AD=Object.freeze({__proto__:null,setValueFrom:vD,setToMin:bD,setToMax:yD,findValueOfOffset:hD,getValueFromEvent:SD,findPositionOfValue:kD,setPositionFromValue:OD,onLeft:_D,onRight:TD,onUp:ED,onDown:BD,edgeActions:DD}),MD=function(n,t){ei(n,IE(),{value:t})},FD=function(n,t){return{x:i(n),y:i(t)}},ID=function(n,t,e){var o=QB(n,t,e.left()),r=hD(n,t,e.top()),i=FD(o,r);return MD(n,i),i},RD=function(n,t,e,o){var r=n>0?TB:_B,i=t?sB(o).x():r(sB(o).x(),LE(o),GE(o),nB(o)),u=t?r(sB(o).y(),jE(o),XE(o),nB(o)):sB(o).y();return MD(e,FD(i,u)),w.some(i)},VD=function(n,t){return function(e,o){return RD(n,t,e,o).map((function(){return!0}))}},ND=function(n,t){var e=LE(t),o=jE(t);MD(n,FD(e,o))},HD=function(n,t){var e=GE(t),o=XE(t);MD(n,FD(e,o))},PD=function(n){return VE(n)},zD=function(n,t,e,o){var r=sB(e),i=uD(n,o.getSpectrum(n),r.x(),o.getLeftEdge(n),o.getRightEdge(n),e),u=kD(n,o.getSpectrum(n),r.y(),o.getTopEdge(n),o.getBottomEdge(n),e),a=vc(t.element())/2,c=uc(t.element())/2;Ma(t.element(),"left",i-a+"px"),Ma(t.element(),"top",u-c+"px")},LD=VD(-1,!1),jD=VD(1,!1),UD=VD(-1,!0),WD=VD(1,!0),GD={"top-left":w.some(gB),top:w.some(hB),"top-right":w.some(vB),right:w.some(yB),"bottom-right":w.some(xB),bottom:w.some(SB),"bottom-left":w.some(CB),left:w.some(OB)},XD=Object.freeze({__proto__:null,setValueFrom:ID,setToMin:ND,setToMax:HD,getValueFromEvent:PD,setPositionFromValue:zD,onLeft:LD,onRight:jD,onUp:UD,onDown:WD,edgeActions:GD}),YD=[Te("stepSize",1),Te("onChange",e),Te("onChoose",e),Te("onInit",e),Te("onDragStart",e),Te("onDragEnd",e),Te("snapToGrid",!1),Te("rounded",!0),ye("snapStart"),se("model",Qt("mode",{x:[Te("minX",0),Te("maxX",100),Ne("value",(function(n){return He(n.mode.minX)})),ce("getInitialValue"),Os("manager",mD)],y:[Te("minY",0),Te("maxY",100),Ne("value",(function(n){return He(n.mode.minY)})),ce("getInitialValue"),Os("manager",AD)],xy:[Te("minX",0),Te("maxX",100),Te("minY",0),Te("maxY",100),Ne("value",(function(n){return He({x:i(n.mode.minX),y:i(n.mode.minY)})})),ce("getInitialValue"),Os("manager",XD)]})),Ig("sliderBehaviours",[Jb,Fg]),Ne("mouseIsDown",(function(){return He(!1)}))],qD=function(n,t,e,o){var r,u=function(t){return Ep(t,n,"thumb")},a=function(t){return Ep(t,n,"spectrum")},c=function(t){return Tp(t,n,"left-edge")},s=function(t){return Tp(t,n,"right-edge")},f=function(t){return Tp(t,n,"top-edge")},l=function(t){return Tp(t,n,"bottom-edge")},d=n.model,m=d.manager,g=function(t,e){m.setPositionFromValue(t,e,n,{getLeftEdge:c,getRightEdge:s,getTopEdge:f,getBottomEdge:l,getSpectrum:a})},p=function(t,e){d.value.set(e);var o=u(t);return g(t,o),n.onChange(t,o,e),w.some(!0)},h=function(t){m.setToMin(t,n)},v=function(t){m.setToMax(t,n)},b=function(t){var e=function(){Tp(t,n,"thumb").each((function(e){var o=d.value.get();n.onChoose(t,e,o)}))},o=n.mouseIsDown.get();n.mouseIsDown.set(!1),o&&e()},y=function(t,e){e.stop(),n.mouseIsDown.set(!0),n.onDragStart(t,u(t))},x=function(t,e){e.stop(),n.onDragEnd(t,u(t)),b(t)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Vg(n.sliderBehaviours,[Jb.config({mode:"special",focusIn:function(t){return Tp(t,n,"spectrum").map(Jb.focusIn).map(i(!0))}}),Fg.config({store:{mode:"manual",getValue:function(n){return d.value.get()}}}),Df.config({channels:(r={},r[ng()]={onReceive:b},r)})]),events:ai([li(IE(),(function(n,t){p(n,t.event().value())})),wi((function(t,e){var o=d.getInitialValue();d.value.set(o);var r=u(t);g(t,r);var i=a(t);n.onInit(t,r,i,d.value.get())})),li(lr(),y),li(mr(),x),li(pr(),y),li(br(),x)]),apis:{resetToMin:h,resetToMax:v,changeValue:p,refresh:g},domModification:{styles:{position:"relative"}}}},KD=Yp({name:"Slider",configFields:YD,partFields:ME,factory:qD,apis:{resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),JD=function(n,t){var e=KD.parts().spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=KD.parts().thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return KD.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:i({y:i(0)})},components:[e,o],sliderBehaviours:xf([vy.config({})]),onChange:function(n,t,e){ei(n,bE(),{value:e})}})},$D="form",QD=[Ig("formBehaviours",[Fg])],ZD=function(n){return"<alloy.field."+n+">"},nA=function(n){var t=function(){var n=[],t=function(t,e){return n.push(t),Sp($D,ZD(t),e)};return{field:t,record:function(){return n}}}(),e=n(t),o=t.record(),r=W(o,(function(n){return dp({name:n,pname:ZD(n)})}));return Pp($D,QD,r,eA,e)},tA=function(n,t){return n.fold((function(){return O.error(t)}),O.value)},eA=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:Vg(n.formBehaviours,[Fg.config({store:{mode:"manual",getValue:function(t){var e=Dp(t,n);return pn(e,(function(n,t){return n().bind((function(n){var e=eh.getCurrent(n);return tA(e,new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+hu(n.element())))})).map(Fg.getValue)}))},setValue:function(t,e){gn(e,(function(e,o){Tp(t,n,o).each((function(n){eh.getCurrent(n).each((function(n){Fg.setValue(n,e)}))}))}))}}})]),apis:{getField:function(t,e){return Tp(t,n,e).bind(eh.getCurrent)}}}},oA={getField:zu((function(n,t,e){return n.getField(t,e)})),sketch:nA},rA=wu("valid-input"),iA=wu("invalid-input"),uA=wu("validating-input"),aA="colorcustom.rgb.",cA=function(n,t,o,r){var u=function(e,o){return kT.config({invalidClass:t("invalid"),notify:{onValidate:function(n){ei(n,uA,{type:e})},onValid:function(n){ei(n,rA,{type:e,value:Fg.getValue(n)})},onInvalid:function(n){ei(n,iA,{type:e,value:Fg.getValue(n)})}},validator:{validate:function(t){var e=Fg.getValue(t),r=o(e)?O.value(!0):O.error(n("aria.input.invalid"));return dT.pure(r)},validateOnLoad:!1}})},a=function(o,r,i,a,c){var s=n(aA+"range"),f=q_.parts().label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":a}}}),l=q_.parts().field({data:c,factory:nT,inputAttributes:m({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[t("textfield")],inputBehaviours:xf([u(r,o),ET.config({})]),onSetValue:function(n){if(kT.isInvalid(n)){var t=kT.run(n);t.get(e)}}}),d=[f,l],g="hex"!==r?[q_.parts()["aria-descriptor"]({text:s})]:[],p=d.concat(g);return{dom:{tag:"div",attributes:{role:"presentation"}},components:p}},c=function(n,t){var e=lk(t);return oA.getField(n,"hex").each((function(t){vy.isFocused(t)||Fg.setValue(n,{hex:e.value()})})),e},s=function(n,t){var e=t.red(),o=t.green(),r=t.blue();Fg.setValue(n,{red:e,green:o,blue:r})},f=dw({dom:{tag:"div",classes:[t("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),l=function(n,t){f.getOpt(n).each((function(n){Ma(n.element(),"background-color","#"+t.value())}))},d=function(){var e={red:i(He(w.some(255))),green:i(He(w.some(255))),blue:i(He(w.some(255))),hex:i(He(w.some("ffffff")))},u=function(n,t){var e=xk(t);s(n,e),p(e)},d=function(n){return e[n]().get()},m=function(n,t){e[n]().set(t)},g=function(){return d("red").bind((function(n){return d("green").bind((function(t){return d("blue").map((function(e){return vk(n,t,e,1)}))}))}))},p=function(n){var t=n.red(),e=n.green(),o=n.blue();m("red",w.some(t)),m("green",w.some(e)),m("blue",w.some(o))},h=function(n,t){var e=t.event();"hex"!==e.type()?m(e.type(),w.none()):r(n)},v=function(n,t){o(n);var e=rk(t);m("hex",w.some(t));var r=xk(e);s(n,r),p(r),ei(n,vE(),{hex:e}),l(n,e)},b=function(n,t,e){var o=parseInt(e,10);m(t,w.some(o)),g().each((function(t){var e=c(n,t);l(n,e)}))},y=function(n){return"hex"===n.type()},x=function(n,t){var e=t.event();y(e)?v(n,e.value()):b(n,e.type(),e.value())},S=function(t){return{label:n(aA+t+".label"),description:n(aA+t+".description")}},C=S("red"),k=S("green"),O=S("blue"),_=S("hex");return Bn(oA.sketch((function(e){return{dom:{tag:"form",classes:[t("rgb-form")],attributes:{"aria-label":n("aria.color.picker")}},components:[e.field("red",q_.sketch(a(bk,"red",C.label,C.description,255))),e.field("green",q_.sketch(a(bk,"green",k.label,k.description,255))),e.field("blue",q_.sketch(a(bk,"blue",O.label,O.description,255))),e.field("hex",q_.sketch(a(ak,"hex",_.label,_.description,"ffffff"))),f.asSpec()],formBehaviours:xf([kT.config({invalidClass:t("form-invalid")}),cy("rgb-form-events",[li(rA,x),li(iA,h),li(uA,h)])])}})),{apis:{updateHex:function(n,t){Fg.setValue(n,{hex:t.value()}),u(n,t),l(n,t)}}})},g=Xp({factory:d,name:"RgbForm",configFields:[],apis:{updateHex:function(n,t,e){n.updateHex(t,e)}},extraApis:{}});return g},sA=function(n,t){var e=KD.parts().spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),o=KD.parts().thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(n,t){var e=n.width,o=n.height,r=n.getContext("2d");if(null!==r){r.fillStyle=t,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}},u=function(n,t){var e=n.components()[0].element().dom();r(e,Ck(t))},a=function(n){var u=i({x:i(0),y:i(0)}),a=function(n,t,e){ei(n,yE(),{value:e})},c=function(n,t,e,o){r(e.element().dom(),Ck(kk()))},s=xf([eh.config({find:w.some}),vy.config({})]);return KD.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[e,o],onChange:a,onInit:c,sliderBehaviours:s})},c=Xp({factory:a,name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(n,t,e){u(t,e)}},extraApis:{}});return c},fA=function(n,t){var o=function(e){var o=cA(n,t,e.onValidHex,e.onInvalidHex),r=sA(n,t),u={paletteRgba:i(He(kk()))},a=dw(r.sketch({})),c=dw(o.sketch({})),s=function(n,t){a.getOpt(n).each((function(n){var e=xk(t);u.paletteRgba().set(e),r.setRgba(n,e)}))},f=function(n,t){c.getOpt(n).each((function(n){o.updateHex(n,t)}))},l=function(n,t,e){G(e,(function(e){e(n,t)}))},d=function(){var n=[f];return function(t,e){var o=e.event().value(),r=u.paletteRgba().get(),i=pE(r),a=gE(i.hue(),o.x(),100-o.y()),c=yk(a),s=lk(c);l(t,s,n)}},m=function(){var n=[s,f];return function(t,e){var o=e.event().value(),r=hE(o.y());l(t,r,n)}};return{uid:e.uid,dom:e.dom,components:[a.asSpec(),JD(n,t),c.asSpec()],behaviours:xf([cy("colour-picker-events",[li(yE(),d()),li(bE(),m())]),eh.config({find:function(n){return c.getOpt(n)}}),Jb.config({mode:"acyclic"})])}},r=Xp({name:"ColourPicker",configFields:[ce("dom"),Te("onValidHex",e),Te("onInvalidHex",e)],factory:o});return r},lA=function(){return eh.config({find:w.some})},dA=function(n){return eh.config({find:n.getOpt})},mA=function(n){return eh.config({find:function(t){return Pi(t.element(),n).bind((function(n){return t.getSystem().getByDom(n).toOption()}))}})},gA={self:lA,memento:dA,childAt:mA},pA={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},hA=function(n){return pA[n]},vA=function(n){return hA(n)},bA=function(n){var e=function(n){return"tox-"+n},o=fA(vA,e),r=function(n){ei(n,N_,{name:"hex-valid",value:!0})},i=function(n){ei(n,N_,{name:"hex-valid",value:!1})},u=dw(o.sketch({dom:{tag:"div",classes:[e("color-picker-container")],attributes:{role:"presentation"}},onValidHex:r,onInvalidHex:i}));return{dom:{tag:"div"},components:[u.asSpec()],behaviours:xf([Fg.config({store:{mode:"manual",getValue:function(n){var t=u.get(n),e=eh.getCurrent(t),o=e.bind((function(n){var t=Fg.getValue(n);return t.hex}));return o.map((function(n){return"#"+n})).getOr("")},setValue:function(n,e){var o=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,r=o.exec(e),i=u.get(n),a=eh.getCurrent(i);a.fold((function(){t.console.log("Can not find form")}),(function(n){Fg.setValue(n,{hex:w.from(r[1]).getOr("")}),oA.getField(n,"hex").each((function(n){ti(n,kr())}))}))}}}),gA.self()])}},yA=tinymce.util.Tools.resolve("tinymce.Resource"),xA=function(n){return Object.prototype.hasOwnProperty.call(n,"init")},wA=function(n){var t=He(w.none()),e=dw({dom:{tag:n.tag}}),o=He(w.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:xf([cy("editor-foo-events",[wi((function(r){e.getOpt(r).each((function(e){(xA(n)?n.init(e.element().dom()):yA.load(n.scriptId,n.scriptUrl).then((function(t){return t(e.element().dom(),n.settings)}))).then((function(n){o.get().each((function(t){n.setValue(t)})),o.set(w.none()),t.set(w.some(n))}))}))}))]),Fg.config({store:{mode:"manual",getValue:function(){return t.get().fold((function(){return o.get().getOr("")}),(function(n){return n.getValue()}))},setValue:function(n,e){t.get().fold((function(){o.set(w.some(e))}),(function(n){return n.setValue(e)}))}}}),gA.self()]),components:[e.asSpec()]}},SA=Dt([Te("preprocess",u),Te("postprocess",u)]),CA=function(n,t){var e=Kt("RepresentingConfigs.memento processors",SA,t);return Fg.config({store:{mode:"manual",getValue:function(t){var o=n.get(t),r=Fg.getValue(o);return e.postprocess(r)},setValue:function(t,o){var r=e.preprocess(o),i=n.get(t);Fg.setValue(i,r)}}})},kA=function(n,t,e){return Fg.config(Bn({store:{mode:"manual",getValue:t,setValue:e}},n.map((function(n){return{store:{initialValue:n}}})).getOr({})))},OA=function(n,t,e){return kA(n,(function(n){return t(n.element())}),(function(n,t){return e(n.element(),t)}))},_A=function(n){return OA(n,ja,Ua)},TA=function(n){return OA(n,Qi,Zi)},EA=function(n){return Fg.config({store:{mode:"memory",initialValue:n}})},BA={memento:CA,withElement:OA,withComp:kA,domValue:_A,domHtml:TA,memory:EA},DA=".jpg,.jpeg,.png,.gif",AA=function(n){var t=new RegExp("("+DA.split(/\s*,\s*/).join("|")+")$","i");return q(fn(n),(function(n){return t.test(n.name)}))},MA=function(n,t){var e=function(n,t){t.stop()},o=function(n){return function(t,e){G(n,(function(n){n(t,e)}))}},r=function(n,t){if(!EC.isDisabled(n)){var e=t.event().raw();u(n,e.dataTransfer.files)}},i=function(n,t){var e=t.event().raw().target.files;u(n,e)},u=function(t,e){Fg.setValue(t,AA(e)),ei(t,I_,{name:n.name})},a=dw({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:xf([cy("input-file-events",[bi(_r()),bi(Vr())])])}),c=function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:xf([BA.memory([]),gA.self(),EC.config({}),Vy.config({toggleClass:"dragenter",toggleOnExecute:!1}),cy("dropzone-events",[li("dragenter",o([e,Vy.toggle])),li("dragleave",o([e,Vy.toggle])),li("dragover",e),li("drop",o([e,r])),li(Or(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},lw.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(n){var t=a.get(n);t.element().dom().click()},buttonBehaviours:xf([ET.config({})])})]}]}},s=n.label.map((function(n){return IT(n,t)})),f=q_.parts().field({factory:{sketch:c}});return BT(s,f,["tox-form__group--stretched"],[])},FA=function(n,t){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+n.columns+"col"]},components:W(n.items,t.interpreter)}},IA=wu("alloy-fake-before-tabstop"),RA=wu("alloy-fake-after-tabstop"),VA=function(n){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:n},behaviours:xf([vy.config({ignore:!0}),ET.config({})])}},NA=function(n){return{dom:{tag:"div",classes:["tox-navobj"]},components:[VA([IA]),n,VA([RA])],behaviours:xf([gA.childAt(1)])}},HA=function(n,t){ei(n,Sr(),{raw:{which:9,shiftKey:t}})},PA=function(n,t){var e=t.element();Ca(e,IA)?HA(n,!0):Ca(e,RA)&&HA(n,!1)},zA=function(n){return r_(n,["."+IA,"."+RA].join(","),i(!1))},LA={isPseudoStop:zA,onFocus:PA,craft:NA},jA=!(jo().browser.isIE()||jo().browser.isEdge()),UA=function(n){var t=He("");return{getValue:function(n){return t.get()},setValue:function(e,o){if(n)au(e.element(),"srcdoc",o);else{au(e.element(),"src","javascript:''");var r=e.element().dom().contentWindow.document;r.open(),r.write(o),r.close()}t.set(o)}}},WA=function(n,t){var e=jA&&n.sandboxed,o=m(m({},n.label.map((function(n){return{title:n}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=UA(e),i=n.label.map((function(n){return IT(n,t)})),u=function(n){return LA.craft({uid:n.uid,dom:{tag:"iframe",attributes:o},behaviours:xf([ET.config({}),vy.config({}),BA.withComp(w.none(),r.getValue,r.setValue)])})},a=q_.parts().field({factory:{sketch:u}});return BT(i,a,["tox-form__group--stretched"],[])};function GA(n,e){return qA(t.document.createElement("canvas"),n,e)}function XA(n){var t=GA(n.width,n.height),e=YA(t);return e.drawImage(n,0,0),t}function YA(n){return n.getContext("2d")}function qA(n,t,e){return n.width=t,n.height=e,n}function KA(n){return n.naturalWidth||n.width}function JA(n){return n.naturalHeight||n.height}var $A=function(){var n=function(n){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],f(n,o(u,this),o(a,this))},e=n.immediateFn||"function"===typeof window.setImmediate&&window.setImmediate||function(n){t.setTimeout(n,1)};function o(n,t){return function(){return n.apply(t,arguments)}}var r=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function i(n){var t=this;null!==this._state?e((function(){var e=t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(r){return void n.reject(r)}n.resolve(o)}else(t._state?n.resolve:n.reject)(t._value)})):this._deferreds.push(n)}function u(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"===typeof n||"function"===typeof n)){var t=n.then;if("function"===typeof t)return void f(o(t,n),o(u,this),o(a,this))}this._state=!0,this._value=n,c.call(this)}catch(e){a.call(this,e)}}function a(n){this._state=!1,this._value=n,c.call(this)}function c(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n];i.call(this,e)}this._deferreds=[]}function s(n,t,e,o){this.onFulfilled="function"===typeof n?n:null,this.onRejected="function"===typeof t?t:null,this.resolve=e,this.reject=o}function f(n,t,e){var o=!1;try{n((function(n){o||(o=!0,t(n))}),(function(n){o||(o=!0,e(n))}))}catch(r){if(o)return;o=!0,e(r)}}return n.prototype.catch=function(n){return this.then(null,n)},n.prototype.then=function(t,e){var o=this;return new n((function(n,r){i.call(o,new s(t,e,n,r))}))},n.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=Array.prototype.slice.call(1===t.length&&r(t[0])?t[0]:t);return new n((function(n,t){if(0===o.length)return n([]);var e=o.length;function r(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(n){r(i,n)}),t)}o[i]=u,0===--e&&n(o)}catch(c){t(c)}}for(var i=0;i<o.length;i++)r(i,o[i])}))},n.resolve=function(t){return t&&"object"===typeof t&&t.constructor===n?t:new n((function(n){n(t)}))},n.reject=function(t){return new n((function(n,e){e(t)}))},n.race=function(t){return new n((function(n,e){for(var o=0,r=t;o<r.length;o++){var i=r[o];i.then(n,e)}}))},n},QA=window.Promise?window.Promise:$A();function ZA(n){return new QA((function(e,o){var r=t.URL.createObjectURL(n),i=new t.Image,u=function(){i.removeEventListener("load",a),i.removeEventListener("error",c)};function a(){u(),e(i)}function c(){u(),o("Unable to load data of type "+n.type+": "+r)}i.addEventListener("load",a),i.addEventListener("error",c),i.src=r,i.complete&&a()}))}function nM(n){var e=n.split(","),o=/data:([^;]+)/.exec(e[0]);if(!o)return w.none();for(var r=o[1],i=e[1],u=1024,a=t.atob(i),c=a.length,s=Math.ceil(c/u),f=new Array(s),l=0;l<s;++l){for(var d=l*u,m=Math.min(d+u,c),g=new Array(m-d),p=d,h=0;p<m;++h,++p)g[h]=a[p].charCodeAt(0);f[l]=new Uint8Array(g)}return w.some(new t.Blob(f,{type:r}))}function tM(n){return new QA((function(t,e){nM(n).fold((function(){e("uri is not base64: "+n)}),t)}))}function eM(n,e,o){return e=e||"image/png",t.HTMLCanvasElement.prototype.toBlob?new QA((function(t,r){n.toBlob((function(n){n?t(n):r()}),e,o)})):tM(n.toDataURL(e,o))}function oM(n,t,e){return t=t||"image/png",n.toDataURL(t,e)}function rM(n){return ZA(n).then((function(n){uM(n);var t=GA(KA(n),JA(n)),e=YA(t);return e.drawImage(n,0,0),t}))}function iM(n){return new QA((function(e){var o=new t.FileReader;o.onloadend=function(){e(o.result)},o.readAsDataURL(n)}))}function uM(n){t.URL.revokeObjectURL(n.src)}function aM(n,t,e){var o=t.type,r=i(o);function u(){return QA.resolve(t)}function a(){return e}function c(){return e.split(",")[1]}function s(t,e){return n.then((function(n){return eM(n,t,e)}))}function f(t,e){return n.then((function(n){return oM(n,t,e)}))}function l(n,t){return f(n,t).then((function(n){return n.split(",")[1]}))}function d(){return n.then(XA)}return{getType:r,toBlob:u,toDataURL:a,toBase64:c,toAdjustedBlob:s,toAdjustedDataURL:f,toAdjustedBase64:l,toCanvas:d}}function cM(n){return iM(n).then((function(t){return aM(rM(n),n,t)}))}function sM(n,t){return eM(n,t).then((function(t){return aM(QA.resolve(n),t,n.toDataURL())}))}var fM=function(n){return cM(n)};function lM(n,t,e){var o="string"===typeof n?parseFloat(n):n;return o>e?o=e:o<t&&(o=t),o}function dM(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}var mM=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function gM(n,t){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=t[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=n[u+5*a]*o[a];r[u+5*i]=e}}return r}function pM(n,t){var e;return t=lM(t,-1,1),t*=100,t<0?e=127+t/100*127:(e=t%1,e=0===e?mM[t]:mM[Math.floor(t)]*(1-e)+mM[Math.floor(t)+1]*e,e=127*e+127),gM(n,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])}function hM(n,t){return t=lM(255*t,-255,255),gM(n,[1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])}function vM(n,t,e,o){return t=lM(t,0,2),e=lM(e,0,2),o=lM(o,0,2),gM(n,[t,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])}function bM(n,t){return n.toCanvas().then((function(e){return yM(e,n.getType(),t)}))}function yM(n,t,e){var o=YA(n);function r(n,t){for(var e,o,r,i,u=n.data,a=t[0],c=t[1],s=t[2],f=t[3],l=t[4],d=t[5],m=t[6],g=t[7],p=t[8],h=t[9],v=t[10],b=t[11],y=t[12],x=t[13],w=t[14],S=t[15],C=t[16],k=t[17],O=t[18],_=t[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*C+r*k+i*O+_;return n}var i=r(o.getImageData(0,0,n.width,n.height),e);return o.putImageData(i,0,0),sM(n,t)}function xM(n,t){return n.toCanvas().then((function(e){return wM(e,n.getType(),t)}))}function wM(n,t,e){var o=YA(n);function r(n,t,e){function o(n,t,e){return n>e?n=e:n<t&&(n=t),n}for(var r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=n.data,a=t.data,c=n.width,s=n.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(l+h-i,0,c-1),b=o(f+p-i,0,s-1),y=4*(b*c+v),x=e[p*r+h];d+=u[y]*x,m+=u[y+1]*x,g+=u[y+2]*x}var w=4*(f*c+l);a[w]=o(d,0,255),a[w+1]=o(m,0,255),a[w+2]=o(g,0,255)}return t}var i=o.getImageData(0,0,n.width,n.height),u=o.getImageData(0,0,n.width,n.height);return u=r(i,u,e),o.putImageData(u,0,0),sM(n,t)}function SM(n){var t=function(t,e,o){var r=YA(t),i=new Array(256);function u(n,t){for(var e=n.data,o=0;o<e.length;o+=4)e[o]=t[e[o]],e[o+1]=t[e[o+1]],e[o+2]=t[e[o+2]];return n}for(var a=0;a<i.length;a++)i[a]=n(a,o);var c=u(r.getImageData(0,0,t.width,t.height),i);return r.putImageData(c,0,0),sM(t,e)};return function(n,e){return n.toCanvas().then((function(o){return t(o,n.getType(),e)}))}}function CM(n){return function(t,e){return bM(t,n(dM(),e))}}function kM(n){return function(t){return bM(t,n)}}function OM(n){return function(t){return xM(t,n)}}var _M=kM([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),TM=CM(hM),EM=CM(pM),BM=function(n,t,e,o){return bM(n,vM(dM(),t,e,o))},DM=OM([0,-1,0,-1,5,-1,0,-1,0]),AM=SM((function(n,t){return 255*Math.pow(n/255,1-t)}));function MM(n,t,e){var o=KA(n),r=JA(n),i=t/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=FM(n,i,u);return a?c.then((function(n){return MM(n,t,e)})):c}function FM(n,t,e){return new QA((function(o){var r=KA(n),i=JA(n),u=Math.floor(r*t),a=Math.floor(i*e),c=GA(u,a),s=YA(c);s.drawImage(n,0,0,r,i,0,0,u,a),o(c)}))}function IM(n,t){return n.toCanvas().then((function(e){return RM(e,n.getType(),t)}))}function RM(n,t,e){var o=GA(n.width,n.height),r=YA(o),i=0,u=0;return e=e<0?360+e:e,90!==e&&270!==e||qA(o,o.height,o.width),90!==e&&180!==e||(i=o.width),270!==e&&180!==e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(n,0,0),sM(o,t)}function VM(n,t){return n.toCanvas().then((function(e){return NM(e,n.getType(),t)}))}function NM(n,t,e){var o=GA(n.width,n.height),r=YA(o);return"v"===e?(r.scale(1,-1),r.drawImage(n,0,-o.height)):(r.scale(-1,1),r.drawImage(n,-o.width,0)),sM(o,t)}function HM(n,t,e,o,r){return n.toCanvas().then((function(i){return PM(i,n.getType(),t,e,o,r)}))}function PM(n,t,e,o,r,i){var u=GA(r,i),a=YA(u);return a.drawImage(n,-e,-o),sM(u,t)}function zM(n,t,e){return n.toCanvas().then((function(o){return MM(o,t,e).then((function(t){return sM(t,n.getType())}))}))}var LM=function(n){return _M(n)},jM=function(n){return DM(n)},UM=function(n,t){return AM(n,t)},WM=function(n,t,e,o){return BM(n,t,e,o)},GM=function(n,t){return TM(n,t)},XM=function(n,t){return EM(n,t)},YM=function(n,t){return VM(n,t)},qM=function(n,t,e,o,r){return HM(n,t,e,o,r)},KM=function(n,t,e){return zM(n,t,e)},JM=function(n,t){return IM(n,t)},$M=function(n,t){return m({dom:{tag:"span",innerHtml:n,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)},QM=function(n,t){return $M(gw(n,t),{})},ZM=function(n,t){return $M(gw(n,t),{behaviours:xf([uy.config({})])})},nF=function(n,t,e){return{dom:{tag:"span",innerHtml:e.translate(n),classes:[t+"__select-label"]},behaviours:xf([uy.config({})])}},tF=wu("toolbar.button.execute"),eF=function(n){return ki((function(t,e){IC(n,t)((function(e){ei(t,tF,{buttonApi:e}),n.onAction(e)}))}))},oF={"alloy.execute":["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},rF=wu("update-menu-text"),iF=wu("update-menu-icon"),uF=function(n,t,o){var r=He(e),i=n.text.map((function(n){return dw(nF(n,t,o.providers))})),u=n.icon.map((function(n){return dw(ZM(n,o.providers.icons))})),a=function(n,t){var e=Fg.getValue(n);return vy.focus(e),ei(e,"keydown",{raw:t.event().raw()}),rE.close(e),w.some(!0)},c=n.role.fold((function(){return{}}),(function(n){return{role:n}})),s=n.tooltip.fold((function(){return{}}),(function(n){var t=o.providers.translate(n);return{title:t,"aria-label":t}})),f=dw(rE.sketch(m(m({},c),{dom:{tag:"button",classes:[t,t+"--select"].concat(W(n.classes,(function(n){return t+"--"+n}))),attributes:m({},s)},components:zC([u.map((function(n){return n.asSpec()})),i.map((function(n){return n.asSpec()})),w.some({dom:{tag:"div",classes:[t+"__select-chevron"],innerHtml:gw("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:xf(p(n.dropdownBehaviours,[FC.button(n.disabled),cE.config({}),uy.config({}),cy("dropdown-events",[RC(n,r),VC(n,r)]),cy("menubutton-update-display-text",[li(rF,(function(n,t){i.bind((function(t){return t.getOpt(n)})).each((function(n){uy.set(n,[Za(o.providers.translate(t.event().text()))])}))})),li(iF,(function(n,t){u.bind((function(t){return t.getOpt(n)})).each((function(n){uy.set(n,[ZM(t.event().icon(),o.providers.icons)])}))}))])])),eventOrder:Bn(oF,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:xf([Jb.config({mode:"special",onLeft:a,onRight:a})]),lazySink:o.getSink,toggleClass:t+"--active",parts:{menu:gO(!1,n.columns,n.presets)},fetch:function(){return dT.nu(n.fetch)}})));return f.asSpec()},aF=function(n){return E(n)},cF=function(n){return"separator"===n.type},sF=function(n){return wn(n,"getSubmenuItems")},fF={type:"separator"},lF=function(n,t){var e=J(n,(function(n,e){return aF(e)?""===e?n:"|"===e?n.length>0&&!cF(n[n.length-1])?n.concat([fF]):n:wn(t,e.toLowerCase())?n.concat([t[e.toLowerCase()]]):n:n.concat([e])}),[]);return e.length>0&&cF(e[e.length-1])&&e.pop(),e},dF=function(n,t){var e=n.getSubmenuItems(),o=pF(e,t),r=Bn(o.menus,tt(n.value,o.items)),i=Bn(o.expansions,tt(n.value,n.value));return{item:n,menus:r,expansions:i}},mF=function(n,t){return sF(n)?dF(n,t):{item:n,menus:{},expansions:{}}},gF=function(n){if(cF(n))return n;var t=xn(n,"value").getOrThunk((function(){return wu("generated-menu-item")}));return Bn({value:t},n)},pF=function(n,t){var e=lF(E(n)?n.split(" "):n,t);return K(e,(function(n,e){var o=gF(e),r=mF(o,t);return{menus:Bn(n.menus,r.menus),items:[r.item].concat(n.items),expansions:Bn(n.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},hF=function(n,t,e,o){var r=wu("primary-menu"),i=pF(n,e.shared.providers.menuItems());if(0===i.items.length)return w.none();var u=KO(r,i.items,t,e,o),a=pn(i.menus,(function(n,o){return KO(o,n,t,e,!1)})),c=Bn(a,tt(r,u));return w.from(yx.tieredData(r,c,i.expansions))},vF=function(n){return{isDisabled:function(){return EC.isDisabled(n)},setDisabled:function(t){return EC.set(n,t)},setActive:function(t){var e=n.element();t?(xa(e,"tox-tbtn--enabled"),au(e,"aria-pressed",!0)):(Sa(e,"tox-tbtn--enabled"),du(e,"aria-pressed"))},isActive:function(){return Ca(n.element(),"tox-tbtn--enabled")}}},bF=function(n,t,e,o){return uF({text:n.text,icon:n.icon,tooltip:n.tooltip,role:o,fetch:function(t){n.fetch((function(n){t(hF(n,NC.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:n.onSetup,getApi:vF,columns:1,presets:"normal",classes:[],dropdownBehaviours:[ET.config({})]},t,e.shared)},yF=function(n,t,e){var o=function(n){return function(o){var r=!o.isActive();o.setActive(r),n.storage.set(r),e.shared.getSink().each((function(e){t().getOpt(e).each((function(t){Ff(t.element()),ei(t,N_,{name:n.name,value:n.storage.get()})}))}))}},r=function(n){return function(t){t.setActive(n.storage.get())}};return function(t){t(W(n,(function(n){var t=n.text.fold((function(){return{}}),(function(n){return{text:n}}));return m(m({type:n.type,active:!1},t),{onAction:o(n),onSetup:r(n)})})))}},xF=function(n,t,e,o,r){void 0===e&&(e=[]);var i=t.fold((function(){return{}}),(function(n){return{action:n}})),u=m({buttonBehaviours:xf([FC.button(n.disabled),ET.config({}),cy("button press",[fi("click"),fi("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},i),a=Bn(u,{dom:o});return Bn(a,{components:r})},wF=function(n,t,e,o){void 0===o&&(o=[]);var r=n.tooltip.map((function(n){return{"aria-label":e.translate(n),title:e.translate(n)}})).getOr({}),i={tag:"button",classes:["tox-tbtn"],attributes:r},u=n.icon.map((function(n){return QM(n,e.icons)})),a=zC([u]);return xF(n,t,o,i,a)},SF=function(n,t,e,o){void 0===o&&(o=[]);var r=wF(n,w.some(t),e,o);return lw.sketch(r)},CF=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(n.text),u=n.icon?n.icon.map((function(n){return QM(n,e.icons)})):w.none(),a=u.isSome()?zC([u]):[],c=u.isSome()?{}:{innerHtml:i},s=p(n.primary||n.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],n.borderless?["tox-button--naked"]:[],r),f=m(m({tag:"button",classes:s},c),{attributes:{title:i}});return xF(n,t,o,f,a)},kF=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=CF(n,w.some(t),e,o,r);return lw.sketch(i)},OF=function(n,e){return function(o){"custom"===e?ei(o,N_,{name:n,value:{}}):"submit"===e?ti(o,H_):"cancel"===e?ti(o,V_):t.console.error("Unknown button type: ",e)}},_F=function(n,t){return"menu"===t},TF=function(n,t){return"custom"===t||"cancel"===t||"submit"===t},EF=function(n,o,r){if(_F(n,o)){var i=function(){return c},u=n,a=m(m({},n),{onSetup:function(t){return t.setDisabled(n.disabled),e},fetch:yF(u.items,i,r)}),c=dw(bF(a,"tox-tbtn",r,w.none()));return c.asSpec()}if(TF(n,o)){var s=OF(n.name,o),f=m(m({},n),{borderless:!1});return kF(f,s,r.shared.providers,[])}t.console.error("Unknown footer button type: ",o)},BF=function(n,t){var e=OF(n.name,"custom");return DT(w.none(),q_.parts().field(m({factory:lw},CF(n,w.some(e),t,[BA.memory(""),gA.self()]))))},DF=i([Te("field1Name","field1"),Te("field2Name","field2"),Cs("onLockedChange"),ys(["lockClass"]),Te("locked",!1),Ng.field("coupledFieldBehaviours",[eh,Fg])]),AF=function(n,t,e){return Tp(n,t,e).bind(eh.getCurrent)},MF=function(n,t){return dp({factory:q_,name:n,overrides:function(n){return{fieldBehaviours:xf([cy("coupled-input-behaviour",[li(kr(),(function(e){AF(e,n,t).each((function(t){Tp(e,n,"lock").each((function(o){Vy.isOn(o)&&n.onLockedChange(e,t,o)}))}))}))])])}}})},FF=i([MF("field1","field2"),MF("field2","field1"),dp({factory:lw,schema:[ce("dom")],name:"lock",overrides:function(n){return{buttonBehaviours:xf([Vy.config({selected:n.locked,toggleClass:n.markers.lockClass,aria:{mode:"pressed"}})])}}})]),IF=function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Ng.augment(n.coupledFieldBehaviours,[eh.config({find:w.some}),Fg.config({store:{mode:"manual",getValue:function(t){var e,o=Mp(t,n,["field1","field2"]);return e={},e[n.field1Name]=Fg.getValue(o.field1()),e[n.field2Name]=Fg.getValue(o.field2()),e},setValue:function(t,e){var o=Mp(t,n,["field1","field2"]);Sn(e,n.field1Name)&&Fg.setValue(o.field1(),e[n.field1Name]),Sn(e,n.field2Name)&&Fg.setValue(o.field2(),e[n.field2Name])}}})]),apis:{getField1:function(t){return Tp(t,n,"field1")},getField2:function(t){return Tp(t,n,"field2")},getLock:function(t){return Tp(t,n,"lock")}}}},RF=Yp({name:"FormCoupledInputs",configFields:DF(),partFields:FF(),factory:IF,apis:{getField1:function(n,t){return n.getField1(t)},getField2:function(n,t){return n.getField2(t)},getLock:function(n,t){return n.getLock(t)}}}),VF=function(n){var t={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},e=function(n){return n in t?t[n]:1},o=n.value.toFixed(e(n.unit));return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+n.unit},NF=function(n){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,e=t.exec(n);if(null!==e){var o=parseFloat(e[1]),r=e[2];return O.value({value:o,unit:r})}return O.error(n)},HF=function(n,t){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(n){return Object.prototype.hasOwnProperty.call(e,n)};return n.unit===t?w.some(n.value):o(n.unit)&&o(t)?e[n.unit]===e[t]?w.some(n.value):w.some(n.value/e[n.unit]*e[t]):w.none()},PF=function(n){return w.none()},zF=function(n,t){return function(e){return HF(e,t).map((function(e){return{value:e*n,unit:t}}))}},LF=function(n,t){var e=NF(n).toOption(),o=NF(t).toOption();return Jp(e,o,(function(n,t){return HF(n,t.unit).map((function(n){return t.value/n})).map((function(n){return zF(n,t.unit)})).getOr(PF)})).getOr(PF)},jF=function(n,t){var e=PF,o=wu("ratio-event"),r=RF.parts().lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(n.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:gw("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:gw("unlock",t.icons)}}],buttonBehaviours:xf([FC.button(n.disabled),ET.config({})])}),i=function(n){return{dom:{tag:"div",classes:["tox-form__group"]},components:n}},u=function(t){return q_.parts().field({factory:nT,inputClasses:["tox-textfield"],inputBehaviours:xf([EC.config({disabled:n.disabled}),ET.config({}),cy("size-input-events",[li(xr(),(function(n,e){ei(n,o,{isField1:t})})),li(Or(),(function(t,e){ei(t,I_,{name:n.name})}))])]),selectOnFocus:!1})},a=function(n){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}}},c=RF.parts().field1(i([q_.parts().label(a("Width")),u(!0)])),s=RF.parts().field2(i([q_.parts().label(a("Height")),u(!1)]));return RF.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(n,t,o){NF(Fg.getValue(n)).each((function(n){e(n).each((function(n){Fg.setValue(t,VF(n))}))}))},coupledFieldBehaviours:xf([EC.config({disabled:n.disabled,onDisabled:function(n){RF.getField1(n).bind(q_.getField).each(EC.disable),RF.getField2(n).bind(q_.getField).each(EC.disable),RF.getLock(n).each(EC.disable)},onEnabled:function(n){RF.getField1(n).bind(q_.getField).each(EC.enable),RF.getField2(n).bind(q_.getField).each(EC.enable),RF.getLock(n).each(EC.enable)}}),cy("size-input-events2",[li(o,(function(n,t){var o=t.event().isField1(),r=o?RF.getField1(n):RF.getField2(n),i=o?RF.getField2(n):RF.getField1(n),u=r.map(Fg.getValue).getOr(""),a=i.map(Fg.getValue).getOr("");e=LF(u,a)}))])])})},UF=i(wu("undo")),WF=i(wu("redo")),GF=i(wu("zoom")),XF=i(wu("back")),YF=i(wu("apply")),qF=i(wu("swap")),KF=i(wu("transform")),JF=i(wu("temp-transform")),$F=i(wu("transform-apply")),QF={undo:UF,redo:WF,zoom:GF,back:XF,apply:YF,swap:qF,transform:KF,tempTransform:JF,transformApply:$F},ZF=i("save-state"),nI=i("disable"),tI=i("enable"),eI={formActionEvent:N_,saveState:ZF,disable:nI,enable:tI},oI=function(n,t){var o=function(n,e,o,r){return dw(kF({name:n,text:n,disabled:o,primary:r,icon:w.none(),borderless:!1},e,t))},r=function(n,e,o,r){return dw(SF({name:n,icon:w.some(n),tooltip:w.some(e),disabled:r,primary:!1,borderless:!1},o,t))},u=function(n,t){n.map((function(n){var e=n.get(t);e.hasConfigured(EC)&&EC.disable(e)}))},a=function(n,t){n.map((function(n){var e=n.get(t);e.hasConfigured(EC)&&EC.enable(e)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=e,f=function(n,t,e){ei(n,t,e)},l=function(n){return ti(n,eI.disable())},d=function(n){return ti(n,eI.enable())},m=function(n,t){l(n),f(n,QF.transform(),{transform:t}),d(n)},g=function(n,t){l(n),f(n,QF.tempTransform(),{transform:t}),d(n)},p=function(n){return function(){an.getOpt(n).each((function(n){uy.set(n,[rn])}))}},h=function(n,t){l(n),f(n,QF.transformApply(),{transform:t,swap:p(n)}),d(n)},v=function(){return o("Back",(function(n){return f(n,QF.back(),{swap:p(n)})}),!1,!1)},b=function(){return dw({dom:{tag:"div",classes:["tox-spacer"]},behaviours:xf([EC.config({})])})},y=function(){return o("Apply",(function(n){return f(n,QF.apply(),{swap:p(n)})}),!0,!0)},x=function(){return function(t){var e=n.getRect();return qM(t,e.x,e.y,e.w,e.h)}},S=[v(),b(),o("Apply",(function(t){var e=x();h(t,e),n.hideCrop()}),!1,!0)],C=M_.sketch({dom:c,components:S.map((function(n){return n.asSpec()})),containerBehaviours:xf([cy("image-tools-crop-buttons-events",[li(eI.disable(),(function(n,t){u(S,n)})),li(eI.enable(),(function(n,t){a(S,n)}))])])}),k=dw(jF({name:"size",label:w.none(),constrain:!0,disabled:!1},t)),O=function(n,t){return function(e){return KM(e,n,t)}},_=[v(),b(),k,b(),o("Apply",(function(n){k.getOpt(n).each((function(t){var e=Fg.getValue(t),o=parseInt(e.width,10),r=parseInt(e.height,10),i=O(o,r);h(n,i)}))}),!1,!0)],T=M_.sketch({dom:c,components:_.map((function(n){return n.asSpec()})),containerBehaviours:xf([cy("image-tools-resize-buttons-events",[li(eI.disable(),(function(n,t){u(_,n)})),li(eI.enable(),(function(n,t){a(_,n)}))])])}),E=function(n,t){return function(e){return n(e,t)}},B=E(YM,"h"),D=E(YM,"v"),A=E(JM,-90),M=E(JM,90),F=function(n,t){g(n,t)},I=[v(),b(),r("flip-horizontally","Flip horizontally",(function(n){F(n,B)}),!1),r("flip-vertically","Flip vertically",(function(n){F(n,D)}),!1),r("rotate-left","Rotate counterclockwise",(function(n){F(n,A)}),!1),r("rotate-right","Rotate clockwise",(function(n){F(n,M)}),!1),b(),y()],R=M_.sketch({dom:c,components:I.map((function(n){return n.asSpec()})),containerBehaviours:xf([cy("image-tools-fliprotate-buttons-events",[li(eI.disable(),(function(n,t){u(I,n)})),li(eI.enable(),(function(n,t){a(I,n)}))])])}),V=function(n,e,o,r,u){var a=KD.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}}),c=KD.parts().spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=KD.parts().thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return dw(KD.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:u,getInitialValue:i({x:i(r)})},components:[a,c,s],sliderBehaviours:xf([vy.config({})]),onChoose:e}))},N=function(n,t,e,o,r){var i=function(n,e,o){var r=E(t,o.x()/100);m(n,r)};return V(n,i,e,o,r)},H=function(n,t,e,o,r){return[v(),N(n,t,e,o,r),y()]},P=function(n,t,e,o,r){var i=H(n,t,e,o,r);return M_.sketch({dom:c,components:i.map((function(n){return n.asSpec()})),containerBehaviours:xf([cy("image-tools-filter-panel-buttons-events",[li(eI.disable(),(function(n,t){u(i,n)})),li(eI.enable(),(function(n,t){a(i,n)}))])])})},z=[v(),b(),y()],L=M_.sketch({dom:c,components:z.map((function(n){return n.asSpec()}))}),j=P("Brightness",GM,-100,0,100),U=P("Contrast",XM,-100,0,100),W=P("Gamma",UM,-100,0,100),G=function(n,t,e){return function(o){return WM(o,n,t,e)}},X=function(n){var t=function(n,t,e){var o=Y.getOpt(n),r=K.getOpt(n),i=q.getOpt(n);o.each((function(t){r.each((function(e){i.each((function(o){var r=Fg.getValue(t).x()/100,i=Fg.getValue(o).x()/100,u=Fg.getValue(e).x()/100,a=G(r,i,u);m(n,a)}))}))}))};return V(n,t,0,100,200)},Y=X("R"),q=X("G"),K=X("B"),J=[v(),Y,q,K,y()],$=M_.sketch({dom:c,components:J.map((function(n){return n.asSpec()}))}),Q=function(n,t,e){return function(o){var r=function(){an.getOpt(o).each((function(t){uy.set(t,[n]),e(t)}))};f(o,QF.swap(),{transform:t,swap:r})}},Z=function(t){n.showCrop()},nn=function(t){k.getOpt(t).each((function(t){var e=n.getMeasurements(),o=e.width,r=e.height;Fg.setValue(t,{width:o,height:r})}))},tn=w.some(jM),en=w.some(LM),on=[r("crop","Crop",Q(C,w.none(),Z),!1),r("resize","Resize",Q(T,w.none(),nn),!1),r("orientation","Orientation",Q(R,w.none(),s),!1),r("brightness","Brightness",Q(j,w.none(),s),!1),r("sharpen","Sharpen",Q(L,tn,s),!1),r("contrast","Contrast",Q(U,w.none(),s),!1),r("color-levels","Color levels",Q($,w.none(),s),!1),r("gamma","Gamma",Q(W,w.none(),s),!1),r("invert","Invert",Q(L,en,s),!1)],rn=M_.sketch({dom:c,components:on.map((function(n){return n.asSpec()}))}),un=M_.sketch({dom:{tag:"div"},components:[rn],containerBehaviours:xf([uy.config({})])}),an=dw(un),cn=function(n){return an.getOpt(n).map((function(n){var t=n.components()[0];return t.components()[t.components().length-1]}))};return{memContainer:an,getApplyButton:cn}},rI=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),iI=tinymce.util.Tools.resolve("tinymce.geom.Rect"),uI=tinymce.util.Tools.resolve("tinymce.util.Observable"),aI=tinymce.util.Tools.resolve("tinymce.util.Tools"),cI=tinymce.util.Tools.resolve("tinymce.util.VK");function sI(n){var t,e,o,r,i,u,a,c,s=Math.max;return t=n.documentElement,e=n.body,o=s(t.scrollWidth,e.scrollWidth),r=s(t.clientWidth,e.clientWidth),i=s(t.offsetWidth,e.offsetWidth),u=s(t.scrollHeight,e.scrollHeight),a=s(t.clientHeight,e.clientHeight),c=s(t.offsetHeight,e.offsetHeight),{width:o<i?r:o,height:u<c?a:u}}function fI(n){var t,e;if(n.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<t.length;e++)n[t[e]]=n.changedTouches[0][t[e]]}function lI(n,e){var o,r,i,u,a,c,s,f=e.document||t.document;e=e||{};var l=f.getElementById(e.handle||n);i=function(n){var i,d,m=sI(f);fI(n),n.preventDefault(),r=n.button,i=l,c=n.screenX,s=n.screenY,d=t.window.getComputedStyle?t.window.getComputedStyle(i,null).getPropertyValue("cursor"):i.runtimeStyle.cursor,o=rI("<div></div>").css({position:"absolute",top:0,left:0,width:m.width,height:m.height,zIndex:2147483647,opacity:1e-4,cursor:d}).appendTo(f.body),rI(f).on("mousemove touchmove",a).on("mouseup touchend",u),e.start(n)},a=function(n){if(fI(n),n.button!==r)return u(n);n.deltaX=n.screenX-c,n.deltaY=n.screenY-s,n.preventDefault(),e.drag(n)},u=function(n){fI(n),rI(f).off("mousemove touchmove",a).off("mouseup touchend",u),o.remove(),e.stop&&e.stop(n)},this.destroy=function(){rI(l).off()},rI(l).on("mousedown touchstart",i)}var dI=0,mI=function(n,t,e,o,r){var i,u,a,c="tox-",s=c+"crid-"+dI++,f=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}];a=["top","right","bottom","left"];var l=function(n,t){return{x:t.x+n.x,y:t.y+n.y,w:t.w,h:t.h}},d=function(n,t){return{x:t.x-n.x,y:t.y-n.y,w:t.w,h:t.h}},m=function(){return d(e,n)};function g(t,o,r,u){var a,c,s,f,l;a=o.x,c=o.y,s=o.w,f=o.h,a+=r*t.deltaX,c+=u*t.deltaY,s+=r*t.deltaW,f+=u*t.deltaH,s<20&&(s=20),f<20&&(f=20),l=n=iI.clamp({x:a,y:c,w:s,h:f},e,"move"===t.name),l=d(e,l),i.fire("updateRect",{rect:l}),x(l)}function p(){function t(t){var e;return new lI(s,{document:o.ownerDocument,handle:s+"-"+t.name,start:function(){e=n},drag:function(n){g(t,e,n.deltaX,n.deltaY)}})}rI('<div id="'+s+'" class="'+c+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),aI.each(a,(function(n){rI("#"+s,o).append('<div id="'+s+"-"+n+'"class="'+c+'croprect-block" style="display: none" data-mce-bogus="all">')})),aI.each(f,(function(n){rI("#"+s,o).append('<div id="'+s+"-"+n.name+'" class="'+c+"croprect-handle "+c+"croprect-handle-"+n.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+n.label+'" aria-grabbed="false" title="'+n.label+'">')})),u=aI.map(f,t),v(n),rI(o).on("focusin focusout",(function(n){rI(n.target).attr("aria-grabbed","focus"===n.type?"true":"false")})),rI(o).on("keydown",(function(t){var e;function o(n,t,o,r,i){n.stopPropagation(),n.preventDefault(),g(e,o,r,i)}switch(aI.each(f,(function(n){if(t.target.id===s+"-"+n.name)return e=n,!1})),t.keyCode){case cI.LEFT:o(t,e,n,-10,0);break;case cI.RIGHT:o(t,e,n,10,0);break;case cI.UP:o(t,e,n,0,-10);break;case cI.DOWN:o(t,e,n,0,10);break;case cI.ENTER:case cI.SPACEBAR:t.preventDefault(),r();break}}))}function h(n){var t;t=aI.map(f,(function(n){return"#"+s+"-"+n.name})).concat(aI.map(a,(function(n){return"#"+s+"-"+n}))).join(","),n?rI(t,o).show():rI(t,o).hide()}function v(n){function e(n,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),rI("#"+s+"-"+n,o).css({left:t.x,top:t.y,width:t.w,height:t.h})}aI.each(f,(function(t){rI("#"+s+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})})),e("top",{x:t.x,y:t.y,w:t.w,h:n.y-t.y}),e("right",{x:n.x+n.w,y:n.y,w:t.w-n.x-n.w+t.x,h:n.h}),e("bottom",{x:t.x,y:n.y+n.h,w:t.w,h:t.h-n.y-n.h+t.y}),e("left",{x:t.x,y:n.y,w:n.x-t.x,h:n.h}),e("move",n)}function b(t){n=t,v(n)}function y(e){t=e,v(n)}function x(n){b(l(e,n))}function w(t){e=t,v(n)}function S(){aI.each(u,(function(n){n.destroy()})),u=[]}return p(),i=aI.extend({toggleVisibility:h,setClampRect:w,setRect:b,getInnerRect:m,setInnerRect:x,setViewPortRect:y,destroy:S},uI),i},gI={create:mI},pI=function(n){return new Pw((function(t){var e=function(){n.removeEventListener("load",e),t(n)};n.complete?t(n):n.addEventListener("load",e)}))},hI=function(n){var t=dw({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=He(1),o=He(w.none()),r=He({x:0,y:0,w:1,h:1}),i=He({x:0,y:0,w:1,h:1}),u=function(n,i){g.getOpt(n).each((function(n){var u=e.get(),a=vc(n.element()),c=uc(n.element()),s=i.dom().naturalWidth*u,f=i.dom().naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};Fa(i,m),t.getOpt(n).each((function(n){Fa(n.element(),m)})),o.get().each((function(n){var t=r.get();n.setRect({x:t.x*u+l,y:t.y*u+d,w:t.w*u,h:t.h*u}),n.setClampRect({x:l,y:d,w:s,h:f}),n.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(n,t){g.getOpt(n).each((function(n){var o=vc(n.element()),r=uc(n.element()),i=t.dom().naturalWidth,u=t.dom().naturalHeight,a=Math.min(o/i,r/u);a>=1?e.set(1):e.set(a)}))},c=function(n,t){var e=We.fromTag("img");return au(e,"src",t),pI(e.dom()).then((function(){return g.getOpt(n).map((function(n){var t=nc({element:e});uy.replaceAt(n,1,w.some(t));var o=i.get(),c={x:0,y:0,w:e.dom().naturalWidth,h:e.dom().naturalHeight};i.set(c);var s=iI.inflate(c,-20,-20);return r.set(s),o.w===c.w&&o.h===c.h||a(n,e),u(n,e),e}))}))},s=function(n,t){var o=e.get(),r=t>0?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),g.getOpt(n).each((function(n){var t=n.components()[1].element();u(n,t)}))},f=function(){o.get().each((function(n){n.toggleVisibility(!0)}))},l=function(){o.get().each((function(n){n.toggleVisibility(!1)}))},d=function(){return r.get()},m=M_.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[t.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:xf([cy("image-panel-crop-events",[wi((function(n){g.getOpt(n).each((function(n){var t=n.element().dom(),i=gI.create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},t,(function(){}));i.toggleVisibility(!1),i.on("updateRect",(function(n){var t=n.rect,o=e.get(),i={x:Math.round(t.x/o),y:Math.round(t.y/o),w:Math.round(t.w/o),h:Math.round(t.h/o)};r.set(i)})),o.set(w.some(i))}))}))])])}],containerBehaviours:xf([uy.config({}),cy("image-panel-events",[wi((function(t){c(t,n)}))])])}),g=dw(m),p=function(){var n=i.get();return{width:n.w,height:n.h}};return{memContainer:g,updateSrc:c,zoom:s,showCrop:f,hideCrop:l,getRect:d,getMeasurements:p}},vI=function(n,t,e,o,r){return SF({name:n,icon:w.some(t),disabled:e,tooltip:w.some(n),primary:!1,borderless:!1},o,r)},bI=function(n,t){t?EC.enable(n):EC.disable(n)},yI=function(n){var t=function(n,t,r){e.getOpt(n).each((function(n){bI(n,t)})),o.getOpt(n).each((function(n){bI(n,r)}))},e=dw(vI("Undo","undo",!0,(function(n){ei(n,QF.undo(),{direction:1})}),n)),o=dw(vI("Redo","redo",!0,(function(n){ei(n,QF.redo(),{direction:1})}),n)),r=M_.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[e.asSpec(),o.asSpec(),vI("Zoom in","zoom-in",!1,(function(n){ei(n,QF.zoom(),{direction:1})}),n),vI("Zoom out","zoom-out",!1,(function(n){ei(n,QF.zoom(),{direction:-1})}),n)]});return{container:r,updateButtonUndoStates:t}};function xI(){var n=[],t=-1;function e(e){var o;return o=n.splice(++t),n.push(e),{state:e,removed:o}}function o(){if(i())return n[--t]}function r(){if(u())return n[++t]}function i(){return t>0}function u(){return-1!==t&&t<n.length-1}return{data:n,add:e,undo:o,redo:r,canUndo:i,canRedo:u}}var wI,SI=function(n){var e=He(n),o=He(w.none()),r=xI();r.add(n);var i=function(){return e.get()},u=function(n){e.set(n)},a=function(){return o.get().fold((function(){return e.get()}),(function(n){return n}))},c=function(n){var t=s(n);return d(),o.set(w.some(t)),t.url},s=function(n){return{blob:n,url:t.URL.createObjectURL(n)}},f=function(n){t.URL.revokeObjectURL(n.url)},l=function(n){aI.each(n,f)},d=function(){o.get().each(f),o.set(w.none())},m=function(n){var t=s(n);u(t);var e=r.add(t).removed;return l(e),t.url},g=function(n){var t=s(n);return o.set(w.some(t)),t.url},p=function(n){return o.get().fold((function(){}),(function(t){m(t.blob),n()}))},h=function(){var n=r.undo();return u(n),n.url},v=function(){var n=r.redo();return u(n),n.url},b=function(){var n=r.canUndo(),t=r.canRedo();return{undoEnabled:n,redoEnabled:t}};return{getBlobState:i,setBlobState:u,addBlobState:m,getTempState:a,updateTempState:c,addTempState:g,applyTempState:p,destroyTempState:d,undo:h,redo:v,getHistoryStates:b}},CI=function(n,o){var r=SI(n.currentState),i=function(n,t){var e=t.event().direction();O.zoom(n,e)},u=function(n){var t=r.getHistoryStates();_.updateButtonUndoStates(n,t.undoEnabled,t.redoEnabled),ei(n,eI.formActionEvent,{name:eI.saveState(),value:t.undoEnabled})},a=function(n){_.updateButtonUndoStates(n,!1,!1)},c=function(n,t){var e=r.undo();m(n,e).then((function(t){d(n),u(n)}))},s=function(n,t){var e=r.redo();m(n,e).then((function(t){d(n),u(n)}))},f=function(n){return n.toBlob()},l=function(n){ei(n,eI.formActionEvent,{name:eI.disable(),value:{}})},d=function(n){T.getApplyButton(n).each((function(n){EC.enable(n)})),ei(n,eI.formActionEvent,{name:eI.enable(),value:{}})},m=function(n,t){return l(n),O.updateSrc(n,t)},g=function(n,e,o,r,i){return l(n),fM(e).then(o).then(f).then(r).then((function(t){return m(n,t).then((function(t){return u(n),i(),d(n),t}))})).catch((function(e){return t.console.log(e),d(n),e}))},p=function(n,t,e){var o=r.getBlobState().blob,i=function(n){return r.updateTempState(n)};g(n,o,t,i,e)},h=function(n,t){var o=r.getTempState().blob,i=function(n){return r.addTempState(n)};g(n,o,t,i,e)},v=function(n,t,e){var o=r.getBlobState().blob,i=function(t){var e=r.addBlobState(t);return y(n),e};g(n,o,t,i,e)},b=function(n,t){var e=function(){y(n);var e=t.event().swap();e()};r.applyTempState(e)},y=function(n){var t=r.getBlobState().url;return r.destroyTempState(),u(n),t},x=function(n){var t=y(n);m(n,t).then((function(t){d(n)}))},w=function(n,t){x(n);var e=t.event().swap();e(),O.hideCrop()},S=function(n,t){return p(n,t.event().transform(),e)},C=function(n,t){return h(n,t.event().transform())},k=function(n,t){return v(n,t.event().transform(),t.event().swap())},O=hI(n.currentState.url),_=yI(o),T=oI(O,o),E=function(n,t){a(n);var e=t.event().transform(),o=t.event().swap();e.fold((function(){o()}),(function(t){p(n,t,o)}))};return{dom:{tag:"div",attributes:{role:"presentation"}},components:[T.memContainer.asSpec(),O.memContainer.asSpec(),_.container],behaviours:xf([Fg.config({store:{mode:"manual",getValue:function(){return r.getBlobState()}}}),cy("image-tools-events",[li(QF.undo(),c),li(QF.redo(),s),li(QF.zoom(),i),li(QF.back(),w),li(QF.apply(),b),li(QF.transform(),S),li(QF.tempTransform(),C),li(QF.transformApply(),k),li(QF.swap(),E)]),gA.self()])}},kI=function(n,t){var e=W(n.options,(function(n){return{dom:{tag:"option",value:n.value,innerHtml:n.text}}})),o=n.data.map((function(n){return tt("initialValue",n)})).getOr({});return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:e,behaviours:Vg(n.selectBehaviours,[vy.config({}),Fg.config({store:m({mode:"manual",getValue:function(n){return ja(n.element())},setValue:function(t,e){var o=$(n.options,(function(n){return n.value===e}));o.isSome()&&Ua(t.element(),e)}},o)})])}},OI=Xp({name:"HtmlSelect",configFields:[ce("options"),Ig("selectBehaviours",[vy,Fg]),Te("selectClasses",[]),Te("selectAttributes",{}),ye("data")],factory:kI}),_I=function(n,t){var e=W(n.items,(function(n){return{text:t.translate(n.text),value:n.value}})),o=n.label.map((function(n){return IT(n,t)})),r=q_.parts().field({dom:{},selectAttributes:{size:n.size},options:e,factory:OI,selectBehaviours:xf([EC.config({disabled:n.disabled}),ET.config({}),cy("selectbox-change",[li(Or(),(function(t,e){ei(t,I_,{name:n.name})}))])])}),i=n.size>1?w.none():w.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:gw("chevron-down",t.icons)}}),u={dom:{tag:"div",classes:["tox-selectfield"]},components:Z([[r],i.toArray()])};return q_.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Z([o.toArray(),[u]]),fieldBehaviours:xf([EC.config({disabled:n.disabled,onDisabled:function(n){q_.getField(n).each(EC.disable)},onEnabled:function(n){q_.getField(n).each(EC.enable)}})])})},TI=function(n,t){var e=n.label.map((function(n){return IT(n,t)})),o=[EC.config({disabled:n.disabled}),Jb.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(n){return ti(n,H_),w.some(!0)}}),cy("textfield-change",[li(kr(),(function(t,e){ei(t,I_,{name:n.name})})),li(Mr(),(function(t,e){ei(t,I_,{name:n.name})}))]),ET.config({})],r=n.validation.map((function(n){return kT.config({getRoot:function(n){return Ri(n.element())},invalidClass:"tox-invalid",validator:{validate:function(t){var e=Fg.getValue(t),o=n.validator(e);return dT.pure(!0===o?O.value(e):O.error(o))},validateOnLoad:n.validateOnLoad}})})).toArray(),u=n.placeholder.fold(i({}),(function(n){return{placeholder:t.translate(n)}})),a=n.inputMode.fold(i({}),(function(n){return{inputmode:n}})),c=m(m({},u),a),s=q_.parts().field({tag:!0===n.multiline?"textarea":"input",inputAttributes:c,inputClasses:[n.classname],inputBehaviours:xf(Z([o,r])),selectOnFocus:!1,factory:nT}),f=n.flex?["tox-form__group--stretched"]:[],l=f.concat(n.maximized?["tox-form-group--maximize"]:[]),d=[EC.config({disabled:n.disabled,onDisabled:function(n){q_.getField(n).each(EC.disable)},onEnabled:function(n){q_.getField(n).each(EC.enable)}})];return BT(e,s,l,d)},EI=function(n,t){return TI({name:n.name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:n.disabled,classname:"tox-textfield",validation:w.none(),maximized:n.maximized},t)},BI=function(n,t){return TI({name:n.name,multiline:!0,label:n.label,inputMode:w.none(),placeholder:n.placeholder,flex:!0,disabled:n.disabled,classname:"tox-textarea",validation:w.none(),maximized:n.maximized},t)},DI=function(n,t){var e=n.stream.streams,o=e.setup(n,t);return ai([li(n.event,o),Si((function(){return t.cancel()}))].concat(n.cancelEvent.map((function(n){return[li(n,(function(){return t.cancel()}))]})).getOr([])))},AI=Object.freeze({__proto__:null,events:DI}),MI=function(n){var t=He(null),e=function(){return{timer:null!==t.get()?"set":"unset"}},o=function(n){t.set(n)},r=function(){var n=t.get();null!==n&&n.cancel()};return ju({readState:e,setTimer:o,cancel:r})},FI=function(n){return n.stream.streams.state(n)},II=Object.freeze({__proto__:null,throttle:MI,init:FI}),RI=function(n,t){var e=n.stream,o=Cw(n.onStream,e.delay);return t.setTimer(o),function(n,t){o.throttle(n,t),e.stopEvent&&t.stop()}},VI=[se("stream",Qt("mode",{throttle:[ce("delay"),Te("stopEvent",!0),Os("streams",{setup:RI,state:MI})]})),Te("event","input"),ye("cancelEvent"),Cs("onStream")],NI=Sf({fields:VI,name:"streaming",active:AI,state:II}),HI=function(n,t,e){var o=Fg.getValue(e);Fg.setValue(t,o),zI(t)},PI=function(n,t){var e=n.element(),o=ja(e),r=e.dom();"number"!==su(e,"type")&&t(r,o)},zI=function(n){PI(n,(function(n,t){return n.setSelectionRange(t.length,t.length)}))},LI=function(n,t){PI(n,(function(n,e){return n.setSelectionRange(t,e.length)}))},jI=function(n,t,e){if(n.selectsOver){var o=Fg.getValue(t),r=n.getDisplayText(o),i=Fg.getValue(e),u=n.getDisplayText(i);return 0===u.indexOf(r)?w.some((function(){HI(n,t,e),LI(t,r.length)})):w.none()}return w.none()},UI=i("alloy.typeahead.itemexecute"),WI=function(n,t,o,r){var i=function(t,o,i){n.previewing.set(!1);var u=zT.getCoupled(t,"sandbox");if($m.isOpen(u))eh.getCurrent(u).each((function(n){Sh.getHighlighted(n).fold((function(){i(n)}),(function(){ui(u,n.element(),"keydown",o)}))}));else{var c=function(n){eh.getCurrent(n).each(i)};XT(n,a(t),t,u,r,c,oT.HighlightFirst).get(e)}},u=J_(n),a=function(n){return function(t){return t.map((function(t){var e=yn(t.menus),o=nn(e,(function(n){return q(n.items,(function(n){return"item"===n.type}))})),r=Fg.getState(n);return r.update(W(o,(function(n){return n.data}))),t}))}},c=[vy.config({}),Fg.config({onSetValue:n.onSetValue,store:m({mode:"dataset",getDataKey:function(n){return ja(n.element())},getFallbackEntry:function(n){return{value:n,meta:{}}},setValue:function(t,e){Ua(t.element(),n.model.getDisplayText(e))}},n.initialData.map((function(n){return tt("initialValue",n)})).getOr({}))}),NI.config({stream:{mode:"throttle",delay:n.responseTime,stopEvent:!1},onStream:function(t,o){var i=zT.getCoupled(t,"sandbox"),u=vy.isFocused(t);if(u&&ja(t.element()).length>=n.minChars){var c=eh.getCurrent(i).bind((function(n){return Sh.getHighlighted(n).map(Fg.getValue)}));n.previewing.set(!0);var s=function(t){eh.getCurrent(i).each((function(t){c.fold((function(){n.model.selectsOver&&Sh.highlightFirst(t)}),(function(n){Sh.highlightBy(t,(function(t){var e=Fg.getValue(t);return e.value===n.value})),Sh.getHighlighted(t).orThunk((function(){return Sh.highlightFirst(t),w.none()}))}))}))};XT(n,a(t),t,i,r,s,oT.HighlightFirst).get(e)}},cancelEvent:Pr()}),Jb.config({mode:"special",onDown:function(n,t){return i(n,t,Sh.highlightFirst),w.some(!0)},onEscape:function(n){var t=zT.getCoupled(n,"sandbox");return $m.isOpen(t)?($m.close(t),w.some(!0)):w.none()},onUp:function(n,t){return i(n,t,Sh.highlightLast),w.some(!0)},onEnter:function(t){var e=zT.getCoupled(t,"sandbox"),o=$m.isOpen(e);if(o&&!n.previewing.get())return eh.getCurrent(e).bind((function(n){return Sh.getHighlighted(n)})).map((function(n){return ei(t,UI(),{item:n}),!0}));var r=Fg.getValue(t);return ti(t,Pr()),n.onExecute(e,t,r),o&&$m.close(e),w.some(!0)}}),Vy.config({toggleClass:n.markers.openClass,aria:{mode:"expanded"}}),zT.config({others:{sandbox:function(t){return QT(n,t,{onOpen:function(){return Vy.on(t)},onClose:function(){return Vy.off(t)}})}}}),cy("typeaheadevents",[ki((function(t){var o=e;qT(n,a(t),t,r,o,oT.HighlightFirst).get(e)})),li(UI(),(function(t,e){var o=zT.getCoupled(t,"sandbox");HI(n.model,t,e.event().item()),ti(t,Pr()),n.onItemExecute(t,o,e.event().item(),Fg.getValue(t)),$m.close(o),zI(t)}))].concat(n.dismissOnBlur?[li(Ar(),(function(n){var t=zT.getCoupled(n,"sandbox");Nf(t.element()).isNone()&&$m.close(t)}))]:[]))];return{uid:n.uid,dom:Q_(Bn(n,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:m(m({},u),Vg(n.typeaheadBehaviours,c)),eventOrder:n.eventOrder}},GI=i([ye("lazySink"),ce("fetch"),Te("minChars",5),Te("responseTime",1e3),ws("onOpen"),Te("getHotspot",w.some),Te("getAnchorOverrides",i({})),Te("layouts",w.none()),Te("eventOrder",{}),Ve("model",{},[Te("getDisplayText",(function(n){return void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.value})),Te("selectsOver",!0),Te("populateFromBrowse",!0)]),ws("onSetValue"),Ss("onExecute"),ws("onItemExecute"),Te("inputClasses",[]),Te("inputAttributes",{}),Te("inputStyles",{}),Te("matchWidth",!0),Te("useMinWidth",!1),Te("dismissOnBlur",!0),ys(["openClass"]),ye("initialData"),Ig("typeaheadBehaviours",[vy,Fg,NI,Jb,Vy,zT]),Ne("previewing",(function(){return He(!0)}))].concat(K_()).concat(nE())),XI=i([mp({schema:[bs()],name:"menu",overrides:function(n){return{fakeFocus:!0,onHighlight:function(t,e){n.previewing.get()?t.getSystem().getByUid(n.uid).each((function(o){jI(n.model,o,e).fold((function(){return Sh.dehighlight(t,e)}),(function(n){return n()}))})):t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&HI(n.model,t,e)})),n.previewing.set(!1)},onExecute:function(t,e){return t.getSystem().getByUid(n.uid).toOption().map((function(n){return ei(n,UI(),{item:e}),!0}))},onHover:function(t,e){n.previewing.set(!1),t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&HI(n.model,t,e)}))}}}})]),YI=Yp({name:"Typeahead",configFields:GI(),partFields:XI(),factory:WI}),qI=function(n){var e=function(){return qI(n.toCached())},o=function(t){return qI(n.bind((function(n){return n.fold((function(n){return dT.pure(O.error(n))}),(function(n){return t(n)}))})))},r=function(t){return qI(n.map((function(n){return n.bind(t)})))},i=function(t){return qI(n.map((function(n){return n.map(t)})))},u=function(t){return qI(n.map((function(n){return n.mapError(t)})))},a=function(t,e){return n.map((function(n){return n.fold(t,e)}))},c=function(e,o){return qI(dT.nu((function(r){var i=!1,u=t.setTimeout((function(){i=!0,r(O.error(o()))}),e);n.get((function(n){i||(t.clearTimeout(u),r(n))}))})))};return m(m({},n),{toCached:e,bindFuture:o,bindResult:r,mapResult:i,mapError:u,foldResult:a,withTimeout:c})},KI=function(n){return qI(dT.nu(n))},JI=function(n){return qI(dT.pure(O.value(n)))},$I=function(n){return qI(dT.pure(O.error(n)))},QI=function(n){return qI(dT.pure(n))},ZI=function(n){return qI(n.map(O.value))},nR=function(n){return KI((function(t){n.then((function(n){t(O.value(n))}),(function(n){t(O.error(n))}))}))},tR={nu:KI,wrap:qI,pure:JI,value:JI,error:$I,fromResult:QI,fromFuture:ZI,fromPromise:nR},eR={type:"separator"},oR=function(n){return{type:"menuitem",value:n.url,text:n.title,meta:{attach:n.attach},onAction:function(){}}},rR=function(n,t){return{type:"menuitem",value:t,text:n,meta:{attach:void 0},onAction:function(){}}},iR=function(n){return W(n,oR)},uR=function(n,t){return q(t,(function(t){return t.type===n}))},aR=function(n,t){return iR(uR(n,t))},cR=function(n){return aR("header",n.targets)},sR=function(n){return aR("anchor",n.targets)},fR=function(n){return w.from(n.anchorTop).map((function(n){return rR("<top>",n)})).toArray()},lR=function(n){return w.from(n.anchorBottom).map((function(n){return rR("<bottom>",n)})).toArray()},dR=function(n){return W(n,(function(n){return rR(n,n)}))},mR=function(n){return J(n,(function(n,t){var e=0===n.length||0===t.length;return e?n.concat(t):n.concat(eR,t)}),[])},gR=function(n,t){var e=n.toLowerCase();return q(t,(function(n){var t=void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.text;return Do(t.toLowerCase(),e)||Do(n.value.toLowerCase(),e)}))},pR=function(n,t,e){var o=Fg.getValue(t),r=void 0!==o.meta.text?o.meta.text:o.value,i=e.getLinkInformation();return i.fold((function(){return[]}),(function(t){var o=gR(r,dR(e.getHistory(n)));return"file"===n?mR([o,gR(r,cR(t)),gR(r,Z([fR(t),sR(t),lR(t)]))]):o}))},hR=wu("aria-invalid"),vR=function(n,t,o){var r,i=t.shared.providers,u=function(t){var e=Fg.getValue(t);o.addToHistory(e.value,n.filetype)},a=q_.parts().field({factory:YI,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":hR,type:"url"},minChars:0,responseTime:0,fetch:function(e){var r=pR(n.filetype,e,o),i=hF(r,NC.BUBBLE_TO_SANDBOX,t,!1);return dT.pure(i)},getHotspot:function(n){return p.getOpt(n)},onSetValue:function(n,t){n.hasConfigured(kT)&&kT.run(n).get(e)},typeaheadBehaviours:xf(Z([o.getValidationHandler().map((function(t){return kT.config({getRoot:function(n){return Ri(n.element())},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(n,t){f.getOpt(n).each((function(n){au(n.element(),"title",i.translate(t))}))}},validator:{validate:function(e){var o=Fg.getValue(e);return tR.nu((function(e){t({type:n.filetype,url:o.value},(function(n){if("invalid"===n.status){var t=O.error(n.message);e(t)}else{var o=O.value(n.message);e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[EC.config({disabled:n.disabled}),ET.config({}),cy("urlinput-events",Z(["file"===n.filetype?[li(kr(),(function(t){ei(t,I_,{name:n.name})}))]:[],[li(Or(),(function(t){ei(t,I_,{name:n.name}),u(t)})),li(Mr(),(function(t){ei(t,I_,{name:n.name}),u(t)}))]]))]])),eventOrder:(r={},r[kr()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(n){return n.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:t.shared.getSink,parts:{menu:gO(!1,1,"normal")},onExecute:function(n,t,e){ei(t,H_,{})},onItemExecute:function(t,e,o,r){u(t),ei(t,I_,{name:n.name})}}),c=n.label.map((function(n){return IT(n,i)})),s=function(n,t,e,o){return void 0===e&&(e=n),void 0===o&&(o=n),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+n],innerHtml:gw(e,i.icons),attributes:m({title:i.translate(o),"aria-live":"polite"},t.fold((function(){return{}}),(function(n){return{id:n}})))}}},f=dw(s("invalid",w.some(hR),"warning")),l=dw({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[f.asSpec()]}),d=o.getUrlPicker(n.filetype),g=wu("browser.url.event"),p=dw({dom:{tag:"div",classes:["tox-control-wrap"]},components:[a,l.asSpec()],behaviours:xf([EC.config({disabled:n.disabled})])}),h=dw(kF({name:n.name,icon:w.some("browse"),text:n.label.getOr(""),disabled:n.disabled,primary:!1,borderless:!0},(function(n){return ti(n,g)}),i,[],["tox-browse-url"])),v=function(){return{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Z([[p.asSpec()],d.map((function(){return h.asSpec()})).toArray()])}},b=function(t){eh.getCurrent(t).each((function(e){var o=Fg.getValue(e),r=m({fieldname:n.name},o);d.each((function(o){o(r).get((function(o){Fg.setValue(e,o),ei(t,I_,{name:n.name})}))}))}))};return q_.sketch({dom:MT(),components:c.toArray().concat([v()]),fieldBehaviours:xf([EC.config({disabled:n.disabled,onDisabled:function(n){q_.getField(n).each(EC.disable),h.getOpt(n).each(EC.disable)},onEnabled:function(n){q_.getField(n).each(EC.enable),h.getOpt(n).each(EC.enable)}}),cy("url-input-events",[li(g,b)])])})},bR=function(n,t){var e=Fg.config({store:{mode:"manual",getValue:function(n){var t=n.element().dom();return t.checked},setValue:function(n,t){var e=n.element().dom();e.checked=t}}}),o=function(n){return n.element().dom().click(),w.some(!0)},r=q_.parts().field({factory:{sketch:u},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:xf([gA.self(),EC.config({disabled:n.disabled}),ET.config({}),vy.config({}),e,Jb.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),cy("checkbox-events",[li(Or(),(function(t,e){ei(t,I_,{name:n.name})}))])])}),i=q_.parts().label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:t.translate(n.label)},behaviours:xf([cE.config({})])}),a=function(n){var e="checked"===n?"selected":"unselected";return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+n],innerHtml:gw(e,t.icons)}}},c=dw({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return q_.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,c.asSpec(),i],fieldBehaviours:xf([EC.config({disabled:n.disabled,disableClass:"tox-checkbox--disabled",onDisabled:function(n){q_.getField(n).each(EC.disable)},onEnabled:function(n){q_.getField(n).each(EC.enable)}})])})},yR=function(n){return"presentation"===n.presets?M_.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html}}):M_.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html,attributes:{role:"document"}},containerBehaviours:xf([ET.config({}),vy.config({})])})},xR=function(n,t){var e={dom:{tag:"label",innerHtml:t.providers.translate(n.label),classes:["tox-label"]}},o=W(n.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:xf([gA.self(),uy.config({}),BA.domHtml(w.none()),Jb.config({mode:"acyclic"})])}},wR=function(n,t){var e=n.label.map((function(n){return IT(n,t)})),o=function(n){return function(t,e){Qc(e.event().target(),"[data-collection-item-value]").each((function(o){n(t,e,o,su(o,"data-collection-item-value"))}))}},r=function(n){return'"'===n?"&quot;":n},i=function(t,e){var o=W(e,(function(t){var e=FS.translate(t.text),o=1===n.columns?'<div class="tox-collection__item-label">'+e+"</div>":"",i='<div class="tox-collection__item-icon">'+t.icon+"</div>",u={_:" "," - ":" ","-":" "},a=e.replace(/\_| \- |\-/g,(function(n){return u[n]}));return'<div class="tox-collection__item" tabindex="-1" data-collection-item-value="'+r(t.value)+'" title="'+a+'" aria-label="'+a+'">'+i+o+"</div>"})),i=n.columns>1&&"auto"!==n.columns?U(o,n.columns):[o],u=W(i,(function(n){return'<div class="tox-collection__group">'+n.join("")+"</div>"}));Zi(t.element(),u.join(""))},a=o((function(t,e,o,r){e.stop(),ei(t,N_,{name:n.name,value:r})})),c=[li(yr(),o((function(n,t,e){Ff(e)}))),li(_r(),a),li(Vr(),a),li(xr(),o((function(n,t,e){$c(n.element(),"."+GS).each((function(n){Sa(n,GS)})),xa(e,GS)}))),li(wr(),o((function(n){$c(n.element(),"."+GS).each((function(n){Sa(n,GS)}))}))),ki(o((function(t,e,o,r){ei(t,N_,{name:n.name,value:r})})))],s=q_.parts().field({dom:{tag:"div",classes:["tox-collection"].concat(1!==n.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:u},behaviours:xf([uy.config({}),Fg.config({store:{mode:"memory",initialValue:[]},onSetValue:function(t,e){i(t,e),"auto"===n.columns&&vS(t,5,"tox-collection__item").each((function(n){var e=n.numRows,o=n.numColumns;Jb.setGridSize(t,e,o)})),ti(t,j_)}}),ET.config({}),Jb.config(BO(n.columns,"normal")),cy("collection-events",c)])}),f=["tox-form__group--collection"];return BT(e,s,f,[])},SR=function(n,t){var e=function(n){return{dom:{tag:"th",innerHtml:t.translate(n)}}},o=function(n){return{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:W(n,e)}]}},r=function(n){return{dom:{tag:"td",innerHtml:t.translate(n)}}},i=function(n){return{dom:{tag:"tr"},components:W(n,r)}},u=function(n){return{dom:{tag:"tbody"},components:W(n,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[o(n.header),u(n.cells)],behaviours:xf([ET.config({}),vy.config({})])}},CR=function(n,t){return{dom:{tag:"div",classes:n.classes},components:W(n.items,t.shared.interpreter)}},kR=function(n){return function(t,e,o){return xn(e,"name").fold((function(){return n(e,o)}),(function(r){return t.field(r,n(e,o))}))}},OR=function(n){return function(t,e,o){var r=Bn(e,{source:"dynamic"});return kR(n)(t,r,o)}},_R={bar:kR((function(n,t){return W_(n,t.shared)})),collection:kR((function(n,t){return wR(n,t.shared.providers)})),alertbanner:kR((function(n,t){return U_(n,t.shared.providers)})),input:kR((function(n,t){return EI(n,t.shared.providers)})),textarea:kR((function(n,t){return BI(n,t.shared.providers)})),label:kR((function(n,t){return xR(n,t.shared)})),iframe:OR((function(n,t){return WA(n,t.shared.providers)})),button:kR((function(n,t){return BF(n,t.shared.providers)})),checkbox:kR((function(n,t){return bR(n,t.shared.providers)})),colorinput:kR((function(n,t){return mE(n,t.shared,t.colorinput)})),colorpicker:kR(bA),dropzone:kR((function(n,t){return MA(n,t.shared.providers)})),grid:kR((function(n,t){return FA(n,t.shared)})),selectbox:kR((function(n,t){return _I(n,t.shared.providers)})),sizeinput:kR((function(n,t){return jF(n,t.shared.providers)})),urlinput:kR((function(n,t){return vR(n,t,t.urlinput)})),customeditor:kR(wA),htmlpanel:kR(yR),imagetools:kR((function(n,t){return CI(n,t.shared.providers)})),table:kR((function(n,t){return SR(n,t.shared.providers)})),panel:kR((function(n,t){return CR(n,t)}))},TR={field:function(n,t){return t}},ER=function(n,t,e){var o=Bn(e,{shared:{interpreter:function(t){return BR(n,t,o)}}});return BR(n,t,o)},BR=function(n,e,o){return xn(_R,e.type).fold((function(){return t.console.error('Unknown factory type "'+e.type+'", defaulting to container: ',e),e}),(function(t){return t(n,e,o)}))},DR=function(n,t){var e=TR;return BR(e,n,t)},AR={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},MR=function(n,t,e){var o=yl(-12,12,AR),r={maxHeightFunction:ml()},i=function(){return{anchor:"node",root:Ba(Mi(n())),node:w.from(n()),bubble:o,layouts:{onRtl:function(){return[Ax]},onLtr:function(){return[Dx]}},overrides:r}},u=function(){return{anchor:"hotspot",hotspot:t(),bubble:o,layouts:{onRtl:function(){return[Qs]},onLtr:function(){return[Zs]}},overrides:r}};return e?i:u},FR=function(n,t,e){var o=function(){return{anchor:"node",root:Ba(Mi(n())),node:w.from(n()),layouts:{onRtl:function(){return[Mx]},onLtr:function(){return[Mx]}}}},r=function(){return{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[of]},onLtr:function(){return[of]}}}};return e?o:r},IR=function(n,t){return function(){return{anchor:"selection",root:t(),getSelection:function(){var t=n.selection.getRng();return w.some($l.range(We.fromDom(t.startContainer),t.startOffset,We.fromDom(t.endContainer),t.endOffset))}}}},RR=function(n){return function(t){return{anchor:"node",root:n(),node:t}}},VR=function(n,t){var e=iw(n),o=function(){return We.fromDom(n.getBody())},r=function(){return We.fromDom(n.getContentAreaContainer())},i=e||!ew(n);return{inlineDialog:MR(r,t,i),banner:FR(r,t,i),cursor:IR(n,o),node:RR(o)}},NR={getAnchors:VR},HR=function(n){return function(t,e){var o=cO.colorPickerDialog(n);o(t,e)}},PR=function(n){return function(){return Hk.hasCustomColors(n)}},zR=function(n){return function(){return Hk.getColors(n)}},LR=function(n){return function(){return cO.getColorCols(n)}},jR=function(n){return{colorPicker:HR(n),hasCustomColors:PR(n),getColors:zR(n),getColorCols:LR(n)}},UR=function(n){return function(){return sw(n)}},WR=function(n){return{isDraggableModal:UR(n)}},GR=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strike-through",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}]}],XR=function(n){return wn(n,"items")},YR=function(n){return wn(n,"block")},qR=function(n){return wn(n,"inline")},KR=function(n){return wn(n,"selector")},JR=function(n){return J(n,(function(n,t){if(XR(t)){var e=JR(t.items);return{customFormats:n.customFormats.concat(e.customFormats),formats:n.formats.concat([{title:t.title,items:e.formats}])}}if(qR(t)||YR(t)||KR(t)){var o="custom-"+t.title.toLowerCase();return{customFormats:n.customFormats.concat([{name:o,format:t}]),formats:n.formats.concat([{title:t.title,format:o,icon:t.icon}])}}return m(m({},n),{formats:n.formats.concat(t)})}),{customFormats:[],formats:[]})},$R=function(n,t){var e=JR(t),o=function(t){G(t,(function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)}))};return n.formatter?o(e.customFormats):n.on("init",(function(){o(e.customFormats)})),e.formats},QR=function(n){return Xx(n).map((function(t){var e=$R(n,t);return Yx(n)?GR.concat(e):e})).getOr(GR)},ZR=function(n,t,e){var o={type:"formatter",isSelected:t(n.format),getStylePreview:e(n.format)};return Bn(n,o)},nV=function(n,t,e,o){var r=function(n){return ZR(n,e,o)},i=function(n){var t={type:"submenu"};return Bn(n,t)},u=function(t){var r=wu(t.title),i={type:"formatter",format:r,isSelected:e(r),getStylePreview:o(r)},u=Bn(t,i);return n.formatter.register(r,u),u},a=function(n){return W(n,(function(n){var t=dn(n);if(Sn(n,"items")){var e=a(n.items);return Bn(i(n),{getStyleItems:function(){return e}})}return Sn(n,"format")?r(n):1===t.length&&z(t,"title")?Bn(n,{type:"separator"}):u(n)}))};return a(t)},tV=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){var e=n.formatter.get(t);return void 0!==e?w.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):w.none()}},o=function(n){var t=n.items;return void 0!==t&&t.length>0?nn(t,o):[n.format]},r=He([]),i=He([]),u=He([]),a=He([]),c=He(!1);n.on("PreInit",(function(u){var a=QR(n),c=nV(n,a,t,e);r.set(c),i.set(nn(c,o))})),n.on("addStyleModifications",(function(r){var i=nV(n,r.items,t,e);u.set(i),c.set(r.replace),a.set(nn(i,o))}));var s=function(){var n=c.get()?[]:r.get(),t=u.get();return n.concat(t)},f=function(){var n=c.get()?[]:i.get(),t=a.get();return n.concat(t)};return{getData:s,getFlattenedKeys:f}},eV=aI.trim,oV=function(n){return function(t){if(t&&1===t.nodeType){if(t.contentEditable===n)return!0;if(t.getAttribute("data-mce-contenteditable")===n)return!0}return!1}},rV=oV("true"),iV=oV("false"),uV=function(n,t,e,o,r){return{type:n,title:t,url:e,level:o,attach:r}},aV=function(n){while(n=n.parentNode){var t=n.contentEditable;if(t&&"inherit"!==t)return rV(n)}return!1},cV=function(n,t){return W(xd(We.fromDom(t),n),(function(n){return n.dom()}))},sV=function(n){return n.innerText||n.textContent},fV=function(n){return n.id?n.id:wu("h")},lV=function(n){return n&&"A"===n.nodeName&&void 0!==(n.id||n.name)},dV=function(n){return lV(n)&&gV(n)},mV=function(n){return n&&/^(H[1-6])$/.test(n.nodeName)},gV=function(n){return aV(n)&&!iV(n)},pV=function(n){return mV(n)&&gV(n)},hV=function(n){return mV(n)?parseInt(n.nodeName.substr(1),10):0},vV=function(n){var t=fV(n),e=function(){n.id=t};return uV("header",sV(n),"#"+t,hV(n),e)},bV=function(n){var t=n.id||n.name,o=sV(n);return uV("anchor",o||"#"+t,"#"+t,0,e)},yV=function(n){return W(q(n,pV),vV)},xV=function(n){return W(q(n,dV),bV)},wV=function(n){var t=cV("h1,h2,h3,h4,h5,h6,a:not([href])",n);return t},SV=function(n){return eV(n.title).length>0},CV=function(n){var t=wV(n);return q(yV(t).concat(xV(t)),SV)},kV={find:CV},OV="tinymce-url-history",_V=5,TV=function(n){return E(n)&&/^https?/.test(n)},EV=function(n){return D(n)&&n.length<=_V&&tn(n,TV)},BV=function(n){return B(n)&&bn(n,(function(n){return!EV(n)})).isNone()},DV=function(){var n,e=t.localStorage.getItem(OV);if(null===e)return{};try{n=JSON.parse(e)}catch(o){if(o instanceof SyntaxError)return t.console.log("Local storage "+OV+" was not valid JSON",o),{};throw o}return BV(n)?n:(t.console.log("Local storage "+OV+" was not valid format",n),{})},AV=function(n){if(!BV(n))throw new Error("Bad format for history:\n"+JSON.stringify(n));t.localStorage.setItem(OV,JSON.stringify(n))},MV=function(n){var t=DV();return Object.prototype.hasOwnProperty.call(t,n)?t[n]:[]},FV=function(n,t){if(TV(n)){var e=DV(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],r=q(o,(function(t){return t!==n}));e[t]=[n].concat(r).slice(0,_V),AV(e)}},IV=Object.prototype.hasOwnProperty,RV=function(n){return!!n},VV=function(n){return pn(aI.makeMap(n,/[, ]/),RV)},NV=function(n,t){return IV.call(n,t)?w.some(n[t]):w.none()},HV=function(n,t,e){var o=NV(n,t).getOr(e);return E(o)?w.some(o):w.none()},PV=function(n){return w.some(n.file_picker_callback).filter(M)},zV=function(n){var t=w.some(n.file_picker_types).filter(RV),e=w.some(n.file_browser_callback_types).filter(RV),o=t.or(e).map(VV);return PV(n).fold((function(){return!1}),(function(n){return o.fold((function(){return!0}),(function(n){return dn(n).length>0&&n}))}))},LV=function(n,t){var e=zV(n);return A(e)?e?PV(n):w.none():e[t]?PV(n):w.none()},jV=function(n,t){return LV(n.settings,t).map((function(e){return function(o){return dT.nu((function(r){var i=function(n,t){if(!E(n))throw new Error("Expected value to be string");if(void 0!==t&&!B(t))throw new Error("Expected meta to be a object");var e={value:n,meta:t};r(e)},u=m({filetype:t,fieldname:o.fieldname},w.from(o.meta).getOr({}));e.call(n,i,o.value,u)}))}}))},UV=function(n){return!1===n.settings.typeahead_urls?w.none():w.some({targets:kV.find(n.getBody()),anchorTop:HV(n.settings,"anchor_top","#top").getOrUndefined(),anchorBottom:HV(n.settings,"anchor_bottom","#bottom").getOrUndefined()})},WV=function(n){var t=w.from(n.settings.file_picker_validator_handler).filter(M);return t.orThunk((function(){return w.from(n.settings.filepicker_validator_handler).filter(M)}))},GV=function(n){return{getHistory:MV,addToHistory:FV,getLinkInformation:function(){return UV(n)},getValidationHandler:function(){return WV(n)},getUrlPicker:function(t){return jV(n,t)}}},XV=function(n,t,e){var o=He(!1),r={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:FS.translate},interpreter:function(n){return DR(n,r)},anchors:NR.getAnchors(t,e),getSink:function(){return O.value(n)}},urlinput:GV(t),styleselect:tV(t),colorinput:jR(t),dialog:WR(t),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(n){return o.set(n)}};return r},YV=i((function(n,t){yc(n,Math.floor(t))})),qV="contexttoolbar-show",KV="contexttoolbar-hide",JV=i([ce("items"),ys(["itemSelector"]),Ig("tgroupBehaviours",[Jb])]),$V=i([pp({name:"items",unit:"item"})]),QV=function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Vg(n.tgroupBehaviours,[Jb.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}},ZV=Yp({name:"ToolbarGroup",configFields:JV(),partFields:$V(),factory:QV}),nN=i([ce("dom"),Te("shell",!0),Ig("toolbarBehaviours",[uy])]),tN=function(){return{behaviours:xf([uy.config({})])}},eN=i([gp({name:"groups",overrides:tN})]),oN=function(n,e,o,r){var i=function(n,e){u(n).fold((function(){throw t.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){uy.set(n,e)}))},u=function(t){return n.shell?w.some(t):Tp(t,n,"groups")},a=n.shell?{behaviours:[uy.config({})],components:[]}:{behaviours:[],components:e};return{uid:n.uid,dom:n.dom,components:a.components,behaviours:Vg(n.toolbarBehaviours,a.behaviours),apis:{setGroups:i},domModification:{attributes:{role:"group"}}}},rN=Yp({name:"Toolbar",configFields:nN(),partFields:eN(),factory:oN,apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),iN=function(n,t){var e={len:0,list:[]},o=J(n,(function(n,e){var o=t(e,n.len);return o.fold(i(n),(function(t){return{len:t.finish(),list:n.list.concat([t])}}))}),e);return o.list},uN=Oi("within","extra","withinWidth"),aN=function(n,t,e){var o=iN(n,(function(n,t){var o=e(n);return w.some({element:i(n),start:i(t),finish:i(t+o),width:i(o)})})),r=q(o,(function(n){return n.finish()<=t})),u=K(r,(function(n,t){return n+t.width()}),0),a=o.slice(r.length);return{within:i(r),extra:i(a),withinWidth:i(u)}},cN=function(n){return W(n,(function(n){return n.element()}))},sN=function(n,t,e){var o=cN(n.concat(t));return uN(o,[],e)},fN=function(n,t,e,o){var r=cN(n).concat([e]);return uN(r,cN(t),o)},lN=function(n,t,e){return uN(cN(n),[],e)},dN=function(n,t,e){var o=aN(t,n,e);return 0===o.extra().length?w.some(o):w.none()},mN=function(n,t,e,o){var r=dN(n,t,e).getOrThunk((function(){return aN(t,n-e(o),e)})),i=r.within(),u=r.extra(),a=r.withinWidth();return 1===u.length&&u[0].width()<=e(o)?sN(i,u,a):u.length>=1?fN(i,u,o,a):lN(i,u,a)},gN=function(n,t){var e=W(t,(function(n){return oc(n)}));rN.setGroups(n,e)},pN=function(n){return ln(n,(function(n){return Nf(n.element()).bind((function(t){return n.getSystem().getByDom(t).toOption()}))}))},hN=function(n,t,e){var o=Ep(n,t,"primary"),r=zT.getCoupled(n,"overflowGroup");Ma(o.element(),"visibility","hidden");var i=t.builtGroups.get().concat([r]),u=pN(i);e([]),gN(o,i);var a=vc(o.element()),c=mN(a,t.builtGroups.get(),(function(n){return vc(n.element())}),r);0===c.extra().length?(uy.remove(o,r),e([])):(gN(o,c.within()),e(c.extra())),za(o.element(),"visibility"),La(o.element()),u.each(vy.focus)},vN=i([Ig("splitToolbarBehaviours",[zT]),Ne("builtGroups",(function(){return He([])}))]),bN=i([ys(["overflowToggledClass"]),Ce("getOverflowBounds"),ce("lazySink"),Ne("overflowGroups",(function(){return He([])}))].concat(vN())),yN=i([dp({factory:rN,schema:nN(),name:"primary"}),mp({schema:nN(),name:"overflow"}),mp({name:"overflow-button"}),mp({name:"overflow-group"})]),xN=i([ys(["toggledClass"]),ce("lazySink"),ge("fetch"),Ce("getBounds"),Oe("fireDismissalEventInstead",[Te("event",Yr())]),_l()]),wN=i([mp({name:"button",overrides:function(n){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:xf([Vy.config({toggleClass:n.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),mp({factory:rN,schema:nN(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:xf([Jb.config({mode:"cyclic",onEscape:function(t){return Tp(t,n,"button").each(vy.focus),w.none()}})])}}})]),SN=function(n,t){var e=zT.getCoupled(n,"toolbarSandbox");$m.isOpen(e)?$m.close(e):$m.open(e,t.toolbar())},CN=function(n,t,e,o){var r=e.getBounds.map((function(n){return n()})),i=e.lazySink(n).getOrDie();vm.positionWithinBounds(i,{anchor:"hotspot",hotspot:n,layouts:o,overrides:{maxWidthFunction:YV()}},t,r)},kN=function(n,t,e,o,r){rN.setGroups(t,r),CN(n,t,e,o),Vy.on(n)},ON=function(n,t,e){var o=ns(),r=function(r,i){e.fetch().get((function(r){kN(n,i,e,t.layouts,r),o.link(n.element()),Jb.focusIn(i)}))},i=function(){Vy.off(n),vy.focus(n),o.unlink(n.element())};return{dom:{tag:"div",attributes:{id:o.id()}},behaviours:xf([Jb.config({mode:"special",onEscape:function(n){return $m.close(n),w.some(!0)}}),$m.config({onOpen:r,onClose:i,isPartOf:function(t,e,o){return es(e,o)||es(n,o)},getAttachPoint:function(){return e.lazySink(n).getOrDie()}}),Df.config({channels:m(m({},eg(m({isExtraPart:f},e.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),rg({doReposition:function(){$m.getState(zT.getCoupled(n,"toolbarSandbox")).each((function(o){CN(n,o,e,t.layouts)}))}}))})])}},_N=function(n,t,e,o){return m(m({},lw.sketch(m(m({},o.button()),{action:function(n){SN(n,o)},buttonBehaviours:Ng.augment({dump:o.button().buttonBehaviours},[zT.config({others:{toolbarSandbox:function(t){return ON(t,e,n)}}})])}))),{apis:{setGroups:function(t,o){$m.getState(zT.getCoupled(t,"toolbarSandbox")).each((function(r){kN(t,r,n,e.layouts,o)}))},reposition:function(t){$m.getState(zT.getCoupled(t,"toolbarSandbox")).each((function(o){CN(t,o,n,e.layouts)}))},toggle:function(n){SN(n,o)},getToolbar:function(n){return $m.getState(zT.getCoupled(n,"toolbarSandbox"))}}})},TN=Yp({name:"FloatingToolbarButton",factory:_N,configFields:xN(),partFields:wN(),apis:{setGroups:function(n,t,e){n.setGroups(t,e)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},getToolbar:function(n,t){return n.getToolbar(t)}}}),EN=function(n){return W(n,(function(n){return oc(n)}))},BN=function(n,t,e){hN(n,e,(function(o){e.overflowGroups.set(o),t.getOpt(n).each((function(n){TN.setGroups(n,EN(o))}))}))},DN=function(n,t,e,o){var r=dw(TN.sketch({fetch:function(){return dT.nu((function(t){t(EN(n.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Zs]},onRtl:function(){return[Qs]},onBottomLtr:function(){return[tf]},onBottomRtl:function(){return[nf]}},getBounds:e.getOverflowBounds,lazySink:n.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:n.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:n.uid,dom:n.dom,components:t,behaviours:Vg(n.splitToolbarBehaviours,[zT.config({others:{overflowGroup:function(){return ZV.sketch(m(m({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,e){n.builtGroups.set(W(e,t.getSystem().build)),BN(t,r,n)},refresh:function(t){return BN(t,r,n)},toggle:function(n){r.getOpt(n).each((function(n){TN.toggle(n)}))},reposition:function(n){r.getOpt(n).each((function(n){TN.reposition(n)}))},getOverflow:function(n){return r.getOpt(n).bind((function(n){return TN.getToolbar(n)}))}},domModification:{attributes:{role:"group"}}}},AN=Yp({name:"SplitFloatingToolbar",configFields:bN(),partFields:yN(),factory:DN,apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},getOverflow:function(n,t){return n.getOverflow(t)}}}),MN=function(n,t){return t.getAnimationRoot.fold((function(){return n.element()}),(function(t){return t(n)}))},FN=function(n){return n.dimension.property},IN=function(n,t){return n.dimension.getDimension(t)},RN=function(n,t){var e=MN(n,t);Oa(e,[t.shrinkingClass,t.growingClass])},VN=function(n,t){Sa(n.element(),t.openClass),xa(n.element(),t.closedClass),Ma(n.element(),FN(t),"0px"),La(n.element())},NN=function(n,t){Sa(n.element(),t.closedClass),xa(n.element(),t.openClass),za(n.element(),FN(t))},HN=function(n,t,e,o){e.setCollapsed(),Ma(n.element(),FN(t),IN(t,n.element())),La(n.element()),RN(n,t),VN(n,t),t.onStartShrink(n),t.onShrunk(n)},PN=function(n,t,e,o){var r=o.getOrThunk((function(){return IN(t,n.element())}));e.setCollapsed(),Ma(n.element(),FN(t),r),La(n.element());var i=MN(n,t);Sa(i,t.growingClass),xa(i,t.shrinkingClass),VN(n,t),t.onStartShrink(n)},zN=function(n,t,e){var o=IN(t,n.element()),r="0px"===o?HN:PN;r(n,t,e,w.some(o))},LN=function(n,t,e){var o=MN(n,t),r=Ca(o,t.shrinkingClass),i=IN(t,n.element());NN(n,t);var u=IN(t,n.element()),a=function(){Ma(n.element(),FN(t),i),La(n.element())},c=function(){VN(n,t)},s=r?a:c;s(),Sa(o,t.shrinkingClass),xa(o,t.growingClass),NN(n,t),Ma(n.element(),FN(t),u),e.setExpanded(),t.onStartGrow(n)},jN=function(n,t,e){if(e.isExpanded()){za(n.element(),FN(t));var o=IN(t,n.element());Ma(n.element(),FN(t),o)}},UN=function(n,t,e){e.isExpanded()||LN(n,t,e)},WN=function(n,t,e){e.isExpanded()&&zN(n,t,e)},GN=function(n,t,e){e.isExpanded()&&HN(n,t,e,w.none())},XN=function(n,t,e){return e.isExpanded()},YN=function(n,t,e){return e.isCollapsed()},qN=function(n,t,e){var o=MN(n,t);return!0===Ca(o,t.growingClass)},KN=function(n,t,e){var o=MN(n,t);return!0===Ca(o,t.shrinkingClass)},JN=function(n,t,e){return!0===qN(n,t)||!0===KN(n,t)},$N=function(n,t,e){var o=e.isExpanded()?zN:LN;o(n,t,e)},QN=Object.freeze({__proto__:null,refresh:jN,grow:UN,shrink:WN,immediateShrink:GN,hasGrown:XN,hasShrunk:YN,isGrowing:qN,isShrinking:KN,isTransitioning:JN,toggleGrow:$N,disableTransitions:RN}),ZN=function(n,t){var e=t.expanded;return Yu(e?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:tt(t.dimension.property,"0px")})},nH=function(n,t){return ai([xi(Tr(),(function(e,o){var r=o.event().raw();if(r.propertyName===n.dimension.property){RN(e,n),t.isExpanded()&&za(e.element(),n.dimension.property);var i=t.isExpanded()?n.onGrown:n.onShrunk;i(e)}}))])},tH=Object.freeze({__proto__:null,exhibit:ZN,events:nH}),eH=[ce("closedClass"),ce("openClass"),ce("shrinkingClass"),ce("growingClass"),ye("getAnimationRoot"),ws("onShrunk"),ws("onStartShrink"),ws("onGrown"),ws("onStartGrow"),Te("expanded",!1),se("dimension",Qt("property",{width:[Os("property","width"),Os("getDimension",(function(n){return vc(n)+"px"}))],height:[Os("property","height"),Os("getDimension",(function(n){return uc(n)+"px"}))]}))],oH=function(n){var t=He(n.expanded),e=function(){return"expanded: "+t.get()};return ju({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:a(t.set,!1),setExpanded:a(t.set,!0),readState:e})},rH=Object.freeze({__proto__:null,init:oH}),iH=Sf({fields:eH,name:"sliding",active:tH,apis:QN,state:rH}),uH=i([ys(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),ws("onOpened"),ws("onClosed")].concat(vN())),aH=i([dp({factory:rN,schema:nN(),name:"primary"}),dp({factory:rN,schema:nN(),name:"overflow",overrides:function(n){return{toolbarBehaviours:xf([iH.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){Tp(t,n,"overflow-button").each((function(n){Vy.off(n),vy.focus(n)})),n.onClosed(t)},onGrown:function(t){Jb.focusIn(t),n.onOpened(t)},onStartGrow:function(t){Tp(t,n,"overflow-button").each(Vy.on)}}),Jb.config({mode:"acyclic",onEscape:function(t){return Tp(t,n,"overflow-button").each(vy.focus),w.some(!0)}})])}}}),mp({name:"overflow-button",overrides:function(n){return{buttonBehaviours:xf([Vy.config({toggleClass:n.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),mp({name:"overflow-group"})]),cH=function(n,t){Tp(n,t,"overflow").each((function(e){sH(n,t),iH.toggleGrow(e)}))},sH=function(n,t){Tp(n,t,"overflow").each((function(e){hN(n,t,(function(n){var t=W(n,(function(n){return oc(n)}));rN.setGroups(e,t)})),Tp(n,t,"overflow-button").each((function(n){iH.hasGrown(e)&&Vy.on(n)})),iH.refresh(e)}))},fH=function(n,t,e,o){var r="alloy.toolbar.toggle",i=function(t,e){var o=W(e,t.getSystem().build);n.builtGroups.set(o)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Vg(n.splitToolbarBehaviours,[zT.config({others:{overflowGroup:function(n){return ZV.sketch(m(m({},o["overflow-group"]()),{items:[lw.sketch(m(m({},o["overflow-button"]()),{action:function(t){ti(n,r)}}))]}))}}}),cy("toolbar-toggle-events",[li(r,(function(t){Tp(t,n,"overflow").each((function(e){sH(t,n),iH.toggleGrow(e)}))}))])]),apis:{setGroups:function(t,e){i(t,e),sH(t,n)},refresh:function(t){return sH(t,n)},toggle:function(t){return cH(t,n)}},domModification:{attributes:{role:"group"}}}},lH=Yp({name:"SplitSlidingToolbar",configFields:uH(),partFields:aH(),factory:fH,apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},toggle:function(n,t){n.toggle(t)}}}),dH=i(wu("toolbar-height-change")),mH="silver.readonly",gH=Dt([me("readonly")]),pH=function(n,t){Jo("*",n.element()).forEach((function(e){n.getSystem().getByDom(e).each((function(n){n.hasConfigured(EC)&&EC.set(n,t)}))}))},hH=function(n,t){var e=n.outerContainer,o=e.element();t&&(n.mothership.broadcastOn([Qm()],{target:o}),n.uiMothership.broadcastOn([Qm()],{target:o})),n.mothership.broadcastOn([mH],{readonly:t}),n.uiMothership.broadcastOn([mH],{readonly:t})},vH=function(n,t){var e=n.outerContainer;hH(n,t),Jo("*",e.element()).forEach((function(n){e.getSystem().getByDom(n).each((function(n){n.hasConfigured(EC)&&EC.set(n,t)}))}))},bH=function(n,t){n.on("init",(function(){n.mode.isReadOnly()&&vH(t,!0)})),n.on("SwitchMode",(function(){return vH(t,n.mode.isReadOnly())})),Hx(n)&&n.setMode("readonly")},yH=function(n){var t;return Df.config({channels:(t={},t[mH]={schema:gH,onReceive:function(t,e){n(t).each((function(n){pH(n,e.readonly)}))}},t)})},xH=function(n){var t=n.title.fold((function(){return{}}),(function(n){return{attributes:{title:n}}}));return{dom:m({tag:"div",classes:["tox-toolbar__group"]},t),components:[ZV.parts().items({})],items:n.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:xf([ET.config({}),vy.config({})])}},wH=function(n){return ZV.sketch(xH(n))},SH=function(n,t,e){var o=wi((function(t){var e=W(n.initGroups,wH);rN.setGroups(t,e)}));return xf([Jb.config({mode:t,onEscape:n.onEscape,selector:".tox-toolbar__group"}),cy("toolbar-events",[o]),yH(e)])},CH=function(n,t){var e=n.cyclicKeying?"cyclic":"acyclic";return{uid:n.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":xH({title:w.none(),items:[]}),"overflow-button":wF({name:"more",icon:w.some("more-drawer"),disabled:!1,tooltip:w.some("More..."),primary:!1,borderless:!1},w.none(),n.backstage.shared.providers)},splitToolbarBehaviours:SH(n,e,t)}},kH=function(n){var t=CH(n,AN.getOverflow),e=4,o=AN.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return AN.sketch(m(m({},t),{lazySink:n.getSink,getOverflowBounds:function(){var t=n.moreDrawerData.lazyHeader().element(),o=jc(t),r=Fi(t),i=jc(r),u=Math.min(i.y(),o.x());return zc(o.x()+e,u,o.width()-2*e,Math.max(i.height(),o.bottom()-u))},parts:m(m({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n.attributes}}}),components:[o],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},OH=function(n){var t=lH.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=lH.parts().overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=CH(n,w.none);return lH.sketch(m(m({},o),{components:[t,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(n){n.getSystem().broadcastOn([dH()],{type:"opened"})},onClosed:function(n){n.getSystem().broadcastOn([dH()],{type:"closed"})}}))},_H=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return rN.sketch({uid:n.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(n.type===Xh.scrolling?["tox-toolbar--scrolling"]:[])},components:[rN.parts().groups({})],toolbarBehaviours:SH(n,t,i(w.none()))})},TH=[Me("disabled",!1),Se("tooltip"),Se("icon"),Se("text"),Fe("onSetup",(function(){return e}))],EH=Dt([le("type"),ge("onAction")].concat(TH)),BH=function(n){return Yt("toolbarbutton",EH,n)},DH=[Se("text"),Se("tooltip"),Se("icon"),ge("fetch"),Fe("onSetup",(function(){return e}))],AH=Dt(p([le("type")],DH)),MH=function(n){return Yt("menubutton",AH,n)},FH=Dt([le("type"),Se("tooltip"),Se("icon"),Se("text"),Ce("select"),ge("fetch"),Fe("onSetup",(function(){return e})),Ae("presets","normal",["normal","color","listpreview"]),Te("columns",1),ge("onAction"),ge("onItemAction")]),IH=function(n){return Yt("SplitButton",FH,n)},RH=[Me("active",!1)].concat(TH),VH=Dt(RH.concat([le("type"),ge("onAction")])),NH=function(n){return Yt("ToggleButton",VH,n)},HH=Dt([le("type"),se("items",Mt([Lt([le("name"),be("items",ee)]),ee]))].concat(TH)),PH=function(n){return Yt("GroupToolbarButton",HH,n)},zH=[Fe("predicate",(function(){return!1})),Ae("scope","node",["node","editor"]),Ae("position","selection",["node","selection","line"])],LH=TH.concat([Te("type","contextformbutton"),Te("primary",!1),ge("onAction"),Ne("original",u)]),jH=RH.concat([Te("type","contextformbutton"),Te("primary",!1),ge("onAction"),Ne("original",u)]),UH=TH.concat([Te("type","contextformbutton")]),WH=RH.concat([Te("type","contextformtogglebutton")]),GH=Qt("type",{contextformbutton:LH,contextformtogglebutton:jH}),XH=Dt([Te("type","contextform"),Fe("initValue",(function(){return""})),Se("label"),be("commands",GH),xe("launch",Qt("type",{contextformbutton:UH,contextformtogglebutton:WH}))].concat(zH)),YH=Dt([Te("type","contexttoolbar"),le("items")].concat(zH)),qH=function(n){return Yt("ContextToolbar",YH,n)},KH=function(n){return Yt("ContextForm",XH,n)},JH=function(n,t,e){return e},$H=Object.freeze({__proto__:null,getState:JH}),QH=function(n,t){var e=function(e,o){n.updateState.each((function(n){var r=n(e,o);t.set(r)})),n.renderComponents.each((function(n){var r=n(o,t.get()),i=W(r,e.getSystem().build);Sm(e,i)}))};return ai([li(Fr(),(function(t,o){var r=o,i=n.channel;z(r.channels(),i)&&e(t,r.data())})),wi((function(t,o){n.initialData.each((function(n){e(t,n)}))}))])},ZH=Object.freeze({__proto__:null,events:QH}),nP=function(){var n=He(w.none()),t=function(t){return n.set(t)},e=function(){return n.set(w.none())},o=function(){return n.get()},r=function(){return n.get().fold((function(){return"none"}),(function(n){return n}))};return{readState:r,get:o,set:t,clear:e}},tP=Object.freeze({__proto__:null,init:nP}),eP=[ce("channel"),ye("renderComponents"),ye("updateState"),ye("initialData")],oP=Sf({fields:eP,name:"reflecting",active:ZH,apis:$H,state:tP}),rP=i([ce("toggleClass"),ce("fetch"),Cs("onExecute"),Te("getHotspot",w.some),Te("getAnchorOverrides",i({})),_l(),Cs("onItemExecute"),ye("lazySink"),ce("dom"),ws("onOpen"),Ig("splitDropdownBehaviours",[zT,Jb,vy]),Te("matchWidth",!1),Te("useMinWidth",!1),Te("eventOrder",{}),ye("role")].concat(nE())),iP=dp({factory:lw,schema:[ce("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:xf([vy.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(oi)},buttonBehaviours:xf([Vy.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),uP=dp({factory:lw,schema:[ce("dom")],name:"button",defaults:function(){return{buttonBehaviours:xf([vy.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each((function(e){n.onExecute(e,t)}))}}}}),aP=i([iP,uP,gp({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[ce("text")],name:"aria-descriptor"}),mp({schema:[bs()],name:"menu",defaults:function(n){return{onExecute:function(t,e){t.getSystem().getByUid(n.uid).each((function(o){n.onItemExecute(o,t,e)}))}}}}),jT()]),cP=function(n,t,o,r){var i=function(n){eh.getCurrent(n).each((function(n){Sh.highlightFirst(n),Jb.focusIn(n)}))},u=function(t){var o=i;qT(n,(function(n){return n}),t,r,o,oT.HighlightFirst).get(e)},a=function(n){return u(n),w.some(!0)},c=function(t){var e=Ep(t,n,"button");return oi(e),w.some(!0)},s=m(m({},ai([wi((function(t,e){var o=Tp(t,n,"aria-descriptor");o.each((function(n){var e=wu("aria");au(n.element(),"id",e),au(t.element(),"aria-describedby",e)}))}))])),Hy(w.some(u))),f={repositionMenus:function(n){Vy.isOn(n)&&ZT(n)}};return{uid:n.uid,dom:n.dom,components:t,apis:f,eventOrder:m(m({},n.eventOrder),{"alloy.execute":["disabling","toggling","alloy.base.behaviour"]}),events:s,behaviours:Vg(n.splitDropdownBehaviours,[zT.config({others:{sandbox:function(t){var e=Ep(t,n,"arrow"),o={onOpen:function(){Vy.on(e),Vy.on(t)},onClose:function(){Vy.off(e),Vy.off(t)}};return QT(n,t,o)}}}),Jb.config({mode:"special",onSpace:c,onEnter:c,onDown:a}),vy.config({}),Vy.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},sP=Yp({name:"SplitDropdown",configFields:rP(),partFields:aP(),factory:cP,apis:{repositionMenus:function(n,t){return n.repositionMenus(t)}}}),fP=function(n){return{isDisabled:function(){return EC.isDisabled(n)},setDisabled:function(t){return EC.set(n,t)}}},lP=function(n){return{setActive:function(t){Vy.set(n,t)},isActive:function(){return Vy.isOn(n)},isDisabled:function(){return EC.isDisabled(n)},setDisabled:function(t){return EC.set(n,t)}}},dP=function(n,t){return n.map((function(n){return{"aria-label":t.translate(n),title:t.translate(n)}})).getOr({})},mP=wu("focus-button"),gP=["checklist","ordered-list"],pP=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],hP=function(n,t,e,o,r,i){var u,a=function(n){return FS.isRtl()&&z(gP,n)?n+"-rtl":n},c=FS.isRtl()&&n.exists((function(n){return z(pP,n)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:dP(e,i)},components:zC([n.map((function(n){return QM(a(n),i.icons)})),t.map((function(n){return nF(n,"tox-tbtn",i)}))]),eventOrder:(u={},u[pr()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:xf([cy("common-button-display-events",[li(pr(),(function(n,t){t.event().prevent(),ti(n,mP)}))])].concat(o.map((function(e){return oP.config({channel:e,initialData:{icon:n,text:t},renderComponents:function(n,t){return zC([n.icon.map((function(n){return QM(a(n),i.icons)})),n.text.map((function(n){return nF(n,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},vP=function(n,t,e,o){var r=t.shared;return TN.sketch({lazySink:r.getSink,fetch:function(){return dT.nu((function(t){t(W(e(n.items),wH))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:hP(n.icon,n.text,n.tooltip,w.none(),w.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})},bP=function(n,t,o){var r=He(e),i=hP(n.icon,n.text,n.tooltip,w.none(),w.none(),o);return lw.sketch({dom:i.dom,components:i.components,eventOrder:oF,buttonBehaviours:xf([cy("toolbar-button-events",[eF({onAction:n.onAction,getApi:t.getApi}),RC(t,r),VC(t,r)]),FC.toolbarButton(n.disabled)].concat(t.toolbarButtonBehaviours))})},yP=function(n,t){return xP(n,t,[])},xP=function(n,t,e){return bP(n,{toolbarButtonBehaviours:[].concat(e.length>0?[cy("toolbarButtonWith",e)]:[]),getApi:fP,onSetup:n.onSetup},t)},wP=function(n,t){return SP(n,t,[])},SP=function(n,t,e){return Bn(bP(n,{toolbarButtonBehaviours:[uy.config({}),Vy.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[cy("toolbarToggleButtonWith",e)]:[]),getApi:lP,onSetup:n.onSetup},t))},CP=function(n,t,e){return function(o){return dT.nu((function(n){return t.fetch(n)})).map((function(r){return w.from(JO(Bn(_O(wu("menu-value"),r,(function(e){t.onItemAction(n(o),e)}),t.columns,t.presets,NC.CLOSE_ON_EXECUTE,t.select.getOr((function(){return!1})),e),{movement:EO(t.columns,t.presets),menuBehaviours:xS.unnamedEvents("auto"!==t.columns?[]:[wi((function(n,e){vS(n,4,YS(t.presets)).each((function(t){var e=t.numRows,o=t.numColumns;Jb.setGridSize(n,e,o)}))}))])})))}))}},kP=function(n,t){var o,r=wu("channel-update-split-dropdown-display"),i=function(n){return{isDisabled:function(){return EC.isDisabled(n)},setDisabled:function(t){return EC.set(n,t)},setIconFill:function(t,e){$c(n.element(),'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){au(n,"fill",e)}))},setIconStroke:function(t,e){$c(n.element(),'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){au(n,"stroke",e)}))},setActive:function(t){au(n.element(),"aria-pressed",t),$c(n.element(),"span").each((function(e){n.getSystem().getByDom(e).each((function(n){return Vy.set(n,t)}))}))},isActive:function(){return $c(n.element(),"span").exists((function(t){return n.getSystem().getByDom(t).exists(Vy.isOn)}))}}},u=He(e),a={getApi:i,onSetup:n.onSetup};return sP.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:m({"aria-pressed":!1},dP(n.tooltip,t.providers))},onExecute:function(t){n.onAction(i(t))},onItemExecute:function(n,t,e){},splitDropdownBehaviours:xf([FC.splitButton(!1),cy("split-dropdown-events",[li(mP,vy.focus),RC(a,u),VC(a,u)]),cE.config({})]),eventOrder:(o={},o[Gr()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:t.getSink,fetch:CP(i,n,t.providers),parts:{menu:gO(!1,n.columns,n.presets)},components:[sP.parts().button(hP(n.icon,n.text,w.none(),w.some(r),w.some([Vy.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),t.providers)),sP.parts().arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:gw("chevron-down",t.providers.icons)}}),sP.parts()["aria-descriptor"]({text:t.providers.translate("To open the popup, press Shift+Enter")})]})},OP=function(n){return{hide:function(){return ti(n,Hr())},getValue:function(){return Fg.getValue(n)}}},_P=function(n,t){return li(tF,(function(e,o){var r=n.get(e),i=OP(r);t.onAction(i,o.event().buttonApi())}))},TP=function(n,t,e){var o=t.original,r=(o.primary,g(o,["primary"])),i=qt(BH(m(m({},r),{type:"button",onAction:function(){}})));return xP(i,e.backstage.shared.providers,[_P(n,t)])},EP=function(n,t,e){var o=t.original,r=(o.primary,g(o,["primary"])),i=qt(NH(m(m({},r),{type:"togglebutton",onAction:function(){}})));return SP(i,e.backstage.shared.providers,[_P(n,t)])},BP=function(n,t,e){var o={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===t.type?EP(n,t,o):TP(n,t,o)},DP=function(n,t,e){var o=W(t,(function(t){return dw(BP(n,t,e))})),r=function(){return W(o,(function(n){return n.asSpec()}))},i=function(n){return ln(t,(function(t,e){return t.primary?w.from(o[e]).bind((function(t){return t.getOpt(n)})).filter(c(EC.isDisabled)):w.none()}))};return{asSpecs:r,findPrimary:i}},AP=function(n,t,e){var o=t.label.fold((function(){return{}}),(function(n){return{"aria-label":n}})),r=dw(nT.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:o,selectOnFocus:!0,inputBehaviours:xf([Jb.config({mode:"special",onEnter:function(n){return i.findPrimary(n).map((function(n){return oi(n),!0}))},onLeft:function(n,t){return t.cut(),w.none()},onRight:function(n,t){return t.cut(),w.none()}})])})),i=DP(r,t.commands,e.shared.providers);return _H({type:n,uid:wu("context-toolbar"),initGroups:[{title:w.none(),items:[r.asSpec()]},{title:w.none(),items:i.asSpecs()}],onEscape:w.none,cyclicKeying:!0})},MP={renderContextForm:AP},FP=function(n,t){var e=Math.max(t.x(),n.x()),o=n.right()-e,r=t.width()-(e-t.x()),i=Math.min(o,r);return{x:e,width:i}},IP=function(n,t,e){var o=We.fromDom(n.getContainer()),r=$c(o,".tox-editor-header").getOr(o),i=Lc(r),u=i.y()>=t.bottom(),a=ew(n),c=a&&!u;if(n.inline&&c)return{y:Math.max(i.bottom(),e.y()),bottom:e.bottom()};if(n.inline&&!c)return{y:e.y(),bottom:Math.min(i.y(),e.bottom())};var s=Lc(o);return c?{y:Math.max(i.bottom(),e.y()),bottom:Math.min(s.bottom(),e.bottom())}:{y:Math.max(s.y(),e.y()),bottom:Math.min(i.y(),e.bottom())}},RP=function(n){var e=Ac(t.window),o=Lc(We.fromDom(n.getContentAreaContainer())),r=Kx(n)||Jx(n)||Qx(n),i=FP(o,e),u=i.x,a=i.width;if(n.inline&&!r)return zc(u,e.y(),a,e.height());var c=IP(n,o,e),s=c.y,f=c.bottom;return zc(u,s,a,f-s)},VP=function(n,t){return ln(t,(function(t){return t.predicate(n.dom())?w.some({toolbarApi:t,elem:n}):w.none()}))},NP=function(n,t){var e=We.fromDom(t.getBody()),o=function(n){return Qo(n,e)},r=function(n){return!o(n)&&!er(e,n)},i=We.fromDom(t.selection.getNode());return r(i)?w.none():VP(i,n.inNodeScope).orThunk((function(){return VP(i,n.inEditorScope).orThunk((function(){return o(i)?w.none():or(i,(function(t){return VP(t,n.inNodeScope)}),o)}))}))},HP={lookup:NP},PP=function(n,t){var e={},o=[],r=[],i={},u={},a=function(n,a){var c=qt(KH(a));e[n]=c,c.launch.map((function(e){i["form:"+n]=m(m({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){t(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[n]=c},c=function(n,t){qH(t).each((function(e){"editor"===t.scope?r.push(e):o.push(e),u[n]=e}))},s=dn(n);return G(s,(function(t){var e=n[t];"contextform"===e.type?a(t,e):"contexttoolbar"===e.type&&c(t,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},zP={categorise:PP},LP=wu("forward-slide"),jP=wu("backward-slide"),UP=wu("change-slide-event"),WP="tox-pop--resizing",GP=function(n){var t=He([]);return Sx.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(n){t.set([]),Sx.getContent(n).each((function(n){za(n.element(),"visibility")})),Sa(n.element(),WP),za(n.element(),"width")},inlineBehaviours:xf([cy("context-toolbar-events",[xi(Tr(),(function(n,t){Sx.getContent(n).each((function(n){})),Sa(n.element(),WP),za(n.element(),"width")})),li(UP,(function(n,t){za(n.element(),"width");var e=vc(n.element());Sx.setContent(n,t.event().contents()),xa(n.element(),WP);var o=vc(n.element());Ma(n.element(),"width",e+"px"),Sx.getContent(n).each((function(e){t.event().focus().bind((function(t){return Ff(t),Nf(n.element())})).orThunk((function(){return Jb.focusIn(e),Vf()}))})),Ix.setTimeout((function(){Ma(n.element(),"width",o+"px")}),0)})),li(LP,(function(n,e){Sx.getContent(n).each((function(n){t.set(t.get().concat([{bar:n,focus:Vf()}]))})),ei(n,UP,{contents:e.event().forwardContents(),focus:w.none()})})),li(jP,(function(n,e){sn(t.get()).each((function(e){t.set(t.get().slice(0,t.get().length-1)),ei(n,UP,{contents:oc(e.bar),focus:e.focus})}))}))]),Jb.config({mode:"special",onEscape:function(e){return sn(t.get()).fold((function(){return n.onEscape()}),(function(n){return ti(e,jP),w.some(!0)}))}})]),lazySink:function(){return O.value(n.sink)}})},XP=function(n,t){return function(e){var o=He(w.none()),r=function(){e.setActive(n.formatter.match(t));var r=n.formatter.formatChanged(t,e.setActive).unbind;o.set(w.some(r))};return n.initialized?r():n.on("init",r),function(){return o.get().each((function(n){return n()}))}}},YP=function(n){return function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)}))}}},qP=function(n,t,e){var o=function(n,o,i,u){var a=t.shared.providers.translate(n.title);if("separator"===n.type)return w.some({type:"separator",text:a});if("submenu"===n.type){var c=nn(n.getStyleItems(),(function(n){return r(n,o,u)}));return 0===o&&c.length<=0?w.none():w.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return nn(n.getStyleItems(),(function(n){return r(n,o,u)}))}})}return w.some(m({type:"togglemenuitem",text:a,active:n.isSelected(u),disabled:i,onAction:e.onAction(n)},n.getStylePreview().fold((function(){return{}}),(function(n){return{meta:{style:n}}}))))},r=function(n,t,r){var i="formatter"===n.type&&e.isInvalid(n);return 0===t?i?[]:o(n,t,!1,r).toArray():o(n,t,i,r).toArray()},i=function(n){var t=e.getCurrentValue(),o=e.shouldHide?0:1;return nn(n,(function(n){return r(n,o,t)}))},u=function(n,t){return function(e){var o=t(),r=i(o),u=hF(r,NC.CLOSE_ON_EXECUTE,n,!1);e(u)}};return{validateItems:i,getFetch:u}},KP=function(n,t,e){var o=e.dataset,r="basic"===o.type?function(){return W(o.data,(function(n){return ZR(n,e.isSelectedFor,e.getPreviewFor)}))}:o.getData;return{items:qP(n,t,e),getStyleItems:r}},JP=function(n,t,o){var r=KP(n,t,o),i=r.items,u=r.getStyleItems,a=function(n){return{getComponent:function(){return n}}},c=function(t){return o.setInitialValue.each((function(n){return n(t.getComponent())})),o.nodeChangeHandler.map((function(e){var o=e(t.getComponent());return n.on("NodeChange",o),function(){n.off("NodeChange",o)}})).getOr(e)};return uF({text:o.icon.isSome()?w.none():w.some(""),icon:o.icon,tooltip:w.from(o.tooltip),role:w.none(),fetch:i.getFetch(t,u),onSetup:c,getApi:a,columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",t.shared)},$P=function(n){return W(n,(function(n){var t=n,e=n,o=n.split("=");return o.length>1&&(t=o[0],e=o[1]),{title:t,format:e}}))},QP=function(n){return{type:"basic",data:n}};(function(n){n[n["SemiColon"]=0]="SemiColon",n[n["Space"]=1]="Space"})(wI||(wI={}));var ZP,nz=function(n,t){return t===wI.SemiColon?n.replace(/;$/,"").split(";"):n.split(" ")},tz=function(n,t,e,o){var r=xn(n.settings,t).getOr(e),i=$P(nz(r,o));return{type:"basic",data:i}},ez=[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}],oz=function(n){var t=function(){return $(ez,(function(t){return n.formatter.match(t.format)}))},e=function(t){return function(){return n.formatter.match(t)}},o=function(n){return function(){return w.none()}},r=function(n){var e=t(),o=e.fold((function(){return"left"}),(function(n){return n.title.toLowerCase()}));ei(n,iF,{icon:"align-"+o})},u=w.some((function(n){return function(){return r(n)}})),a=w.some((function(n){return r(n)})),c=QP(ez);return{tooltip:"Align",icon:w.some("align-left"),isSelectedFor:e,getCurrentValue:i(w.none()),getPreviewFor:o,onAction:YP(n),setInitialValue:a,nodeChangeHandler:u,dataset:c,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},rz=function(n,t){return JP(n,t,oz(n))},iz=function(n,t){var e=KP(n,t,oz(n));n.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},uz="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",az=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],cz=function(n){var t=n.split(/\s*,\s*/);return W(t,(function(n){return n.replace(/^['"]+|['"]+$/g,"")}))},sz=function(n){var t=function(){var t=cz(n.toLowerCase());return tn(az,(function(n){return t.indexOf(n.toLowerCase())>-1}))};return 0===n.indexOf("-apple-system")&&t()},fz=function(n){var t=function(){var t=function(n){return n?cz(n)[0]:""},e=n.queryCommandValue("FontName"),o=s.data,r=e?e.toLowerCase():"",i=$(o,(function(n){var e=n.format;return e.toLowerCase()===r||t(e).toLowerCase()===t(r).toLowerCase()})).orThunk((function(){return sz(r)?w.from({title:"System Font",format:r}):w.none()}));return{matchOpt:i,font:e}},e=function(n){return function(t){return t.exists((function(t){return t.format===n}))}},o=function(){var n=t().matchOpt;return n},r=function(n){return function(){return w.some({tag:"div",styles:-1===n.indexOf("dings")?{"font-family":n}:{}})}},i=function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontName",!1,t.format)}))}},u=function(n){var e=t(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(n){return n.title}));ei(n,rF,{text:i})},a=w.some((function(n){return function(){return u(n)}})),c=w.some((function(n){return u(n)})),s=tz(n,"font_formats",uz,wI.SemiColon);return{tooltip:"Fonts",icon:w.none(),isSelectedFor:e,getCurrentValue:o,getPreviewFor:r,onAction:i,setInitialValue:c,nodeChangeHandler:a,dataset:s,shouldHide:!1,isInvalid:function(){return!1}}},lz=function(n,t){return JP(n,t,fz(n))},dz=function(n,t){var e=KP(n,t,fz(n));n.ui.registry.addNestedMenuItem("fontformats",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},mz="8pt 10pt 12pt 14pt 18pt 24pt 36pt",gz={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},pz=function(n,t){var e=Math.pow(10,t);return Math.round(n*e)/e},hz=function(n,t){return/[0-9.]+px$/.test(n)?pz(72*parseInt(n,10)/96,t||0)+"pt":n},vz=function(n){return xn(gz,n).getOr("")},bz=function(n){var t=function(){var t=w.none(),e=f.data,o=n.queryCommandValue("FontSize");if(o)for(var r=function(n){var r=hz(o,n),i=vz(r);t=$(e,(function(n){return n.format===o||n.format===r||n.format===i}))},i=3;t.isNone()&&i>=0;i--)r(i);return{matchOpt:t,size:o}},e=function(n){return function(t){return t.exists((function(t){return t.format===n}))}},o=function(){var n=t().matchOpt;return n},r=i(i(w.none())),u=function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontSize",!1,t.format)}))}},a=function(n){var e=t(),o=e.matchOpt,r=e.size,i=o.fold((function(){return r}),(function(n){return n.title}));ei(n,rF,{text:i})},c=w.some((function(n){return function(){return a(n)}})),s=w.some((function(n){return a(n)})),f=tz(n,"fontsize_formats",mz,wI.Space);return{tooltip:"Font sizes",icon:w.none(),isSelectedFor:e,getPreviewFor:r,getCurrentValue:o,onAction:u,setInitialValue:s,nodeChangeHandler:c,dataset:f,shouldHide:!1,isInvalid:function(){return!1}}},yz=function(n,t){return JP(n,t,bz(n))},xz=function(n,t){var e=KP(n,t,bz(n));n.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},wz=function(n,t,e){var o=t();return ln(e,(function(t){return $(o,(function(e){return n.formatter.matchNode(t,e.format)}))})).orThunk((function(){return n.formatter.match("p")?w.some({title:"Paragraph",format:"p"}):w.none()}))},Sz=function(n){var t=n.selection.getStart(!0)||n.getBody();return n.dom.getParents(t,(function(){return!0}),n.getBody())},Cz="Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",kz=function(n){var t=function(t){return wz(n,(function(){return c.data}),t)},e=function(t){return function(){return n.formatter.match(t)}},o=function(t){return function(){var e=n.formatter.get(t);return w.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))})}},r=function(n,e){var o=t(n),r=o.fold((function(){return"Paragraph"}),(function(n){return n.title}));ei(e,rF,{text:r})},u=w.some((function(n){return function(t){return r(t.parents,n)}})),a=w.some((function(t){var e=Sz(n);r(e,t)})),c=tz(n,"block_formats",Cz,wI.SemiColon);return{tooltip:"Blocks",icon:w.none(),isSelectedFor:e,getCurrentValue:i(w.none()),getPreviewFor:o,onAction:YP(n),setInitialValue:a,nodeChangeHandler:u,dataset:c,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},Oz=function(n,t){return JP(n,t,kz(n))},_z=function(n,t){var e=KP(n,t,kz(n));n.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})},Tz=function(n,t){var e=function(t){return function(){return n.formatter.match(t)}},o=function(t){return function(){var e=n.formatter.get(t);return void 0!==e?w.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):w.none()}},r=function(t,e){var o=function(n){var t=n.items;return void 0!==t&&t.length>0?nn(t,o):[{title:n.title,format:n.format}]},r=nn(QR(n),o),i=wz(n,(function(){return r}),t),u=i.fold((function(){return"Paragraph"}),(function(n){return n.title}));ei(e,rF,{text:u})},u=w.some((function(n){return function(t){return r(t.parents,n)}})),a=w.some((function(t){var e=Sz(n);r(e,t)}));return{tooltip:"Formats",icon:w.none(),isSelectedFor:e,getCurrentValue:i(w.none()),getPreviewFor:o,onAction:YP(n),setInitialValue:a,nodeChangeHandler:u,shouldHide:n.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!n.formatter.canApply(t.format)},dataset:t}},Ez=function(n,t){var e=m({type:"advanced"},t.styleselect);return JP(n,t,Tz(n,e))},Bz=function(n,t){var e=m({type:"advanced"},t.styleselect),o=KP(n,t,Tz(n,e));n.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})},Dz=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],Az=function(n,t){return function(e,o,r){var i=n(e).mapError((function(n){return Jt(n)})).getOrDie();return t(i,o,r)}},Mz={button:Az(BH,(function(n,t){return yP(n,t.backstage.shared.providers)})),togglebutton:Az(NH,(function(n,t){return wP(n,t.backstage.shared.providers)})),menubutton:Az(MH,(function(n,t){return bF(n,"tox-tbtn",t.backstage,w.none())})),splitbutton:Az(IH,(function(n,t){return kP(n,t.backstage.shared)})),grouptoolbarbutton:Az(PH,(function(n,t,e){var o,r=e.ui.registry.getAll().buttons,i=function(n){return zz(e,{buttons:r,toolbar:n,allowToolbarGroups:!1},t,w.none())},u=(o={},o[kl]=ew(e)?rs.TopToBottom:rs.BottomToTop,o);switch(nw(e)){case Xh.floating:return vP(n,t.backstage,i,u);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(n,t){return Ez(n,t.backstage)},fontsizeSelectButton:function(n,t){return yz(n,t.backstage)},fontSelectButton:function(n,t){return lz(n,t.backstage)},formatButton:function(n,t){return Oz(n,t.backstage)},alignMenuButton:function(n,t){return rz(n,t.backstage)}},Fz=function(n,e,o){return xn(Mz,n.type).fold((function(){return t.console.error("skipping button defined by",n),w.none()}),(function(t){return w.some(t(n,e,o))}))},Iz={styleselect:Mz.styleSelectButton,fontsizeselect:Mz.fontsizeSelectButton,fontselect:Mz.fontSelectButton,formatselect:Mz.formatButton,align:Mz.alignMenuButton},Rz=function(n){var t=W(Dz,(function(t){var e=q(t.items,(function(t){return wn(n,t)||wn(Iz,t)}));return{name:t.name,items:e}}));return q(t,(function(n){return n.items.length>0}))},Vz=function(n){var t=n.split("|");return W(t,(function(n){return{items:n.trim().split(" ")}}))},Nz=function(n){return I(n,(function(n){return wn(n,"name")&&wn(n,"items")}))},Hz=function(n){var e=n.toolbar,o=n.buttons;return!1===e?[]:void 0===e||!0===e?Rz(o):E(e)?Vz(e):Nz(e)?e:(t.console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},Pz=function(n,e,o,r,i,u){return xn(e,o.toLowerCase()).orThunk((function(){return u.bind((function(n){return ln(n,(function(n){return xn(e,n+o.toLowerCase())}))}))})).fold((function(){return xn(Iz,o.toLowerCase()).map((function(t){return t(n,i)})).orThunk((function(){return w.none()}))}),(function(e){return"grouptoolbarbutton"!==e.type||r?Fz(e,i,n):(t.console.warn("Ignoring the '"+o+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),w.none())}))},zz=function(n,t,e,o){var r=Hz(t),i=W(r,(function(r){var i=nn(r.items,(function(r){return 0===r.trim().length?[]:Pz(n,t.buttons,r,t.allowToolbarGroups,e,o).toArray()}));return{title:w.from(n.translate(r.name)),items:i}}));return q(i,(function(n){return n.items.length>0}))},Lz=12,jz={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},Uz={maxHeightFunction:ml(),maxWidthFunction:YV()},Wz={onLtr:function(){return[ef,of,nf,Qs,tf,Zs,Mx,Fx,Dx,Ex,Ax,Bx]},onRtl:function(){return[ef,of,tf,Zs,nf,Qs,Mx,Fx,Ax,Bx,Dx,Ex]}},Gz={onLtr:function(){return[of,Qs,Zs,nf,tf,ef,Mx,Fx,Dx,Ex,Ax,Bx]},onRtl:function(){return[of,Zs,Qs,tf,nf,ef,Mx,Fx,Ax,Bx,Dx,Ex]}},Xz=function(n,t){return"line"===n?{bubble:yl(Lz,0,jz),layouts:{onLtr:function(){return[rf]},onRtl:function(){return[uf]}},overrides:Uz}:{bubble:yl(0,Lz,jz),layouts:t?Gz:Wz,overrides:Uz}},Yz=function(n,t,e,o){var r=jo().deviceType.isTouch,i=ec(GP({sink:e,onEscape:function(){return n.focus(),w.some(!0)}})),u=function(){return RP(n)},a=function(n,t,e,o){return Math.max(n,e)<=Math.min(t,o)},c=function(){var t=g.get().map((function(n){return n.getBoundingClientRect()})).getOrThunk((function(){return n.selection.getRng().getBoundingClientRect()})),e=n.inline?Tc().top():jc(We.fromDom(n.getBody())).y();return{y:t.top+e,bottom:t.bottom+e}},s=function(){if(r()&&o.backstage.isContextMenuOpen())return!0;var n=c(),t=u();return!a(n.y,n.bottom,t.y(),t.bottom())},f=function(){Sx.hide(i)},l=function(){d.get().each((function(n){var t=i.element();za(t,"display"),s()?Ma(t,"display","none"):vm.positionWithinBounds(e,n,i,w.some(u()))}))},d=He(w.none()),g=He(w.none()),p=He(null),h=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:xf([Jb.config({mode:"acyclic"}),cy("pop-dialog-wrap-events",[wi((function(t){n.shortcuts.add("ctrl+F9","focus statusbar",(function(){return Jb.focusIn(t)}))})),Si((function(t){n.shortcuts.remove("ctrl+F9")}))])])}},v=An((function(){return zP.categorise(t,(function(n){var t=b(n);ei(i,LP,{forwardContents:h(t)})}))})),b=function(t){var e=n.ui.registry.getAll().buttons,r=nw(n)===Xh.scrolling?Xh.scrolling:Xh.default,i=v();return"contexttoolbar"===t.type?function(){var u=m(m({},e),i.formNavigators),a=zz(n,{buttons:u,toolbar:t.items,allowToolbarGroups:!1},o,w.some(["form:"]));return _H({type:r,uid:wu("context-toolbar"),initGroups:a,onEscape:w.none,cyclicKeying:!0})}():function(){return MP.renderContextForm(r,t,o.backstage)}()};n.on(qV,(function(t){var e=v();xn(e.lookupTable,t.toolbarKey).each((function(e){x(e,t.target===n?w.none():w.some(t)),Sx.getContent(i).each(Jb.focusIn)}))}));var y=function(n,t){var e="node"===n?o.backstage.shared.anchors.node(t):o.backstage.shared.anchors.cursor();return Bn(e,Xz(n,r()))},x=function(n,t){if(C(),!r()||!o.backstage.isContextMenuOpen()){var e=b(n),a=t.map(We.fromDom),c=y(n.position,a);d.set(w.some(c)),g.set(t);var f=i.element();za(f,"display"),Sx.showWithinBounds(i,c,h(e),(function(){return w.some(u())})),s()&&Ma(f,"display","none")}},S=function(){if(n.hasFocus()){var t=v();HP.lookup(t,n).fold((function(){d.set(w.none()),Sx.hide(i)}),(function(n){x(n.toolbarApi,w.some(n.elem.dom()))}))}},C=function(){var n=p.get();null!==n&&(Ix.clearTimeout(n),p.set(null))},k=function(n){C(),p.set(n)};n.on("init",(function(){n.on(KV,f),n.on("ScrollContent ScrollWindow longpress",l),n.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){k(Ix.setEditorTimeout(n,S,0))})),n.on("focusout",(function(t){Ix.setEditorTimeout(n,(function(){Nf(e.element()).isNone()&&Nf(i.element()).isNone()&&(d.set(w.none()),Sx.hide(i))}),0)})),n.on("SwitchMode",(function(){n.mode.isReadOnly()&&(d.set(w.none()),Sx.hide(i))})),n.on("NodeChange",(function(t){Nf(i.element()).fold((function(){k(Ix.setEditorTimeout(n,S,0))}),(function(n){}))}))}))},qz={register:Yz},Kz=function(n,e,o){var r=function(n,t){G([e,o],(function(e){e.broadcastEvent(n,t)}))},i=function(n,t){G([e,o],(function(e){e.broadcastOn([n],t)}))},u=function(n){return i(Qm(),{target:n.target()})},a=t_(We.fromDom(t.document),"touchstart",u),c=t_(We.fromDom(t.document),"touchmove",(function(n){return r(Lr(),n)})),s=t_(We.fromDom(t.document),"touchend",(function(n){return r(jr(),n)})),f=t_(We.fromDom(t.document),"mousedown",u),l=t_(We.fromDom(t.document),"mouseup",(function(n){0===n.raw().button&&i(ng(),{target:n.target()})})),d=function(n){return i(Qm(),{target:We.fromDom(n.target)})},m=function(n){0===n.button&&i(ng(),{target:We.fromDom(n.target)})},g=function(n){return r(Ur(),o_(n))},p=function(n){i(Zm(),{}),r(Wr(),o_(n))},h=function(){return i(Zm(),{})};n.on("PostRender",(function(){n.on("click",d),n.on("tap",d),n.on("mouseup",m),n.on("ScrollWindow",g),n.on("ResizeWindow",p),n.on("ResizeEditor",h)})),n.on("remove",(function(){n.off("click",d),n.off("tap",d),n.off("mouseup",m),n.off("ScrollWindow",g),n.off("ResizeWindow",p),n.off("ResizeEditor",h),f.unbind(),a.unbind(),c.unbind(),s.unbind(),l.unbind()})),n.on("detach",(function(){Am(e),Am(o),e.destroy(),o.destroy()}))},Jz={setup:Kz},$z=Rp,Qz=vp,Zz=i([Te("shell",!1),ce("makeItem"),Te("setupItem",e),Ng.field("listBehaviours",[uy])]),nL=function(){return{behaviours:xf([uy.config({})])}},tL=gp({name:"items",overrides:nL}),eL=i([tL]),oL=i("CustomList"),rL=function(n,e,o,r){var i=function(e,o){a(e).fold((function(){throw t.console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(t){var r=uy.contents(t),i=o.length,u=i-r.length,a=u>0?j(u,(function(){return n.makeItem()})):[],c=r.slice(i);G(c,(function(n){return uy.remove(t,n)})),G(a,(function(n){return uy.append(t,n)}));var s=uy.contents(t);G(s,(function(t,r){n.setupItem(e,t,o[r],r)}))}))},u=n.shell?{behaviours:[uy.config({})],components:[]}:{behaviours:[],components:e},a=function(t){return n.shell?w.some(t):Tp(t,n,"items")};return{uid:n.uid,dom:n.dom,components:u.components,behaviours:Vg(n.listBehaviours,u.behaviours),apis:{setItems:i}}},iL=Yp({name:oL(),configFields:Zz(),partFields:eL(),factory:rL,apis:{setItems:function(n,t,e){n.setItems(t,e)}}}),uL=function(n){var t=Na(n,"position").is("fixed"),e=t?w.none():Vi(n);return e.orThunk((function(){var t=We.fromTag("span");return Ri(n).bind((function(n){Gi(n,t);var e=Vi(t);return Ji(t),e}))}))},aL=function(n){return uL(n).map(mc).getOrThunk((function(){return fc(0,0)}))},cL=kn.generate([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),sL=function(n,t){var e=n.element();xa(e,t.transitionClass),Sa(e,t.fadeOutClass),xa(e,t.fadeInClass),t.onShow(n)},fL=function(n,t){var e=n.element();xa(e,t.transitionClass),Sa(e,t.fadeInClass),xa(e,t.fadeOutClass),t.onHide(n)},lL=function(n,t){return n.y()<t.bottom()&&n.bottom()>t.y()},dL=function(n,t){return n.y()>=t.y()},mL=function(n,t){return n.bottom()<=t.bottom()},gL=function(n,t,e){return tn(n,(function(n){switch(n){case"bottom":return mL(t,e);case"top":return dL(t,e)}}))},pL=function(n,t){return t.getInitialPosition().map((function(t){return zc(t.bounds.x(),t.bounds.y(),vc(n),uc(n))}))},hL=function(n,t,e){e.setInitialPosition(w.some({style:Ha(n),position:Ra(n,"position")||"static",bounds:t}))},vL=function(n,t,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(w.none()),o.position){case"static":return w.some(cL.static());case"absolute":var r=uL(n).map(Lc).getOrThunk((function(){return Lc(Ea())}));return w.some(cL.absolute(Pf("absolute",xn(o.style,"left").map((function(n){return t.x()-r.x()})),xn(o.style,"top").map((function(n){return t.y()-r.y()})),xn(o.style,"right").map((function(n){return r.right()-t.right()})),xn(o.style,"bottom").map((function(n){return r.bottom()-t.bottom()})))));default:return w.none()}}))},bL=function(n,t,e,o){return pL(n,o).filter((function(n){return gL(t.modes,n,e)})).bind((function(t){return vL(n,t,o)}))},yL=function(n,t,e,o){var r=Lc(n);if(gL(t.modes,r,e))return w.none();hL(n,r,o);var i=Uc(),u=r.x()-i.x(),a=e.y()-i.y(),c=i.bottom()-e.bottom(),s=r.y()<=e.y();return w.some(cL.fixed(Pf("fixed",w.some(u),s?w.some(a):w.none(),w.none(),s?w.none():w.some(c))))},xL=function(n,t,e,o){var r=n.element(),i=Na(r,"position").is("fixed");return i?bL(r,t,e,o):yL(r,t,e,o)},wL=function(n,t){var e=n.element();return pL(e,t).bind((function(n){return vL(e,n,t)}))},SL=function(n,t){G(["left","right","top","bottom","position"],(function(t){return za(n.element(),t)})),t.onUndocked(n)},CL=function(n,t,e){zf(n.element(),e);var o="fixed"===e.position()?t.onDocked:t.onUndocked;o(n)},kL=function(n,t,e,o,r){void 0===r&&(r=!1),t.contextual.each((function(t){t.lazyContext(n).each((function(i){var u=lL(i,o);if(u!==e.isVisible())if(e.setVisible(u),r&&!u)ka(n.element(),[t.fadeOutClass]),t.onHide(n);else{var a=u?sL:fL;a(n,t)}}))}))},OL=function(n,t,e){var o=t.lazyViewport(n),r=e.isDocked();r&&kL(n,t,e,o),xL(n,t,o,e).each((function(i){e.setDocked(!r),i.fold((function(){return SL(n,t)}),(function(e){return CL(n,t,e)}),(function(r){kL(n,t,e,o,!0),CL(n,t,r)}))}))},_L=function(n,t,o){var r=n.element();o.setDocked(!1),wL(n,o).each((function(o){o.fold((function(){return SL(n,t)}),(function(e){return CL(n,t,e)}),e)})),o.setVisible(!0),t.contextual.each((function(t){Oa(r,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)})),TL(n,t,o)},TL=function(n,t,e){n.getSystem().isConnected()&&OL(n,t,e)},EL=function(n,t,e){e.isDocked()&&_L(n,t,e)},BL=function(n,t,e){return e.isDocked()},DL=Object.freeze({__proto__:null,refresh:TL,reset:EL,isDocked:BL}),AL=function(n,t){return ai([xi(Tr(),(function(e,o){n.contextual.each((function(n){if(Ca(e.element(),n.transitionClass)){Oa(e.element(),[n.transitionClass,n.fadeInClass]);var r=t.isVisible()?n.onShown:n.onHidden;r(e)}o.stop()}))})),li(Ur(),(function(e,o){TL(e,n,t)})),li(Wr(),(function(e,o){EL(e,n,t)}))])},ML=Object.freeze({__proto__:null,events:AL}),FL=[Oe("contextual",[le("fadeInClass"),le("fadeOutClass"),le("transitionClass"),ge("lazyContext"),ws("onShow"),ws("onShown"),ws("onHide"),ws("onHidden")]),Fe("lazyViewport",Uc),Re("modes",["top","bottom"],ee),ws("onDocked"),ws("onUndocked")],IL=function(){var n=He(!1),t=He(!0),e=He(w.none()),o=function(){return"docked:  "+n.get()+", visible: "+t.get()};return ju({isDocked:function(){return n.get()},setDocked:function(t){return n.set(t)},getInitialPosition:function(){return e.get()},setInitialPosition:function(n){return e.set(n)},isVisible:function(){return t.get()},setVisible:function(n){return t.set(n)},readState:o})},RL=Object.freeze({__proto__:null,init:IL}),VL=Sf({fields:FL,name:"docking",active:ML,apis:DL,state:RL}),NL={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},HL="tox-tinymce--toolbar-sticky-on",PL="tox-tinymce--toolbar-sticky-off",zL=function(n,t){var e=Mi(t),o=e.dom().defaultView.innerHeight,r=Tc(e),i=We.fromDom(n.elm),u=jc(i),a=uc(i),c=u.y(),s=c+a,f=mc(t),l=uc(t),d=f.top(),m=d+l,g=Math.abs(d-r.top())<2,p=Math.abs(m-(r.top()+o))<2;if(g&&c<m)Ec(r.left(),c-l,e);else if(p&&s>d){var h=c-o+a+l;Ec(r.left(),h,e)}},LL=function(n,t){var e=function(n){return ac(n)+(parseInt(Ra(n,"margin-top"),10)||0)+(parseInt(Ra(n,"margin-bottom"),10)||0)},o=n.element();Ri(o).each((function(r){var i="padding-"+(t?"top":"bottom");if(VL.isDocked(n)){var u=vc(r);Ma(o,"width",u+"px"),Ma(r,i,e(o)+"px")}else za(o,"width"),za(r,i)}))},jL=function(n,t){t?(Sa(n,NL.fadeOutClass),ka(n,[NL.transitionClass,NL.fadeInClass])):(Sa(n,NL.fadeInClass),ka(n,[NL.fadeOutClass,NL.transitionClass]))},UL=function(n,t){var e=We.fromDom(n.getContainer());t?(xa(e,HL),Sa(e,PL)):(xa(e,PL),Sa(e,HL))},WL=function(n,t){var e=Mi(t);Vf(e).filter((function(n){return!Qo(t,n)})).filter((function(t){return Qo(t,We.fromDom(e.dom().body))||er(n,t)})).each((function(){return Ff(t)}))},GL=function(n,t){return Nf(n).orThunk((function(){return t().toOption().bind((function(n){return Nf(n.element())}))}))},XL=function(n,t){n.inline||(ew(n)||n.on("ResizeEditor",(function(){t().each(VL.reset)})),n.on("ResizeWindow ResizeEditor",(function(){t().each((function(t){return LL(t,ew(n))}))})),n.on("SkinLoaded",(function(){t().each((function(n){VL.isDocked(n)?VL.reset(n):VL.refresh(n)}))})),n.on("FullscreenStateChanged",(function(){t().each(VL.reset)}))),n.on("AfterScrollIntoView",(function(n){t().each((function(t){VL.refresh(t);var e=t.element();vv(e)&&zL(n,e)}))})),n.on("PostRender",(function(){UL(n,!1)}))},YL=function(n){return n().map(VL.isDocked).getOr(!1)},qL=function(n){var t;return[Df.config({channels:(t={},t[dH()]={onReceive:function(t){LL(t,n)}},t)})]},KL=function(n,t){var e=He(w.none()),o=ew(n),r=function(n){t().each((function(t){return n(t.element())}))},i=function(e){n.inline||LL(e,o),UL(n,VL.isDocked(e)),e.getSystem().broadcastOn([Zm()],{}),t().each((function(n){return n.getSystem().broadcastOn([Zm()],{})}))},u=n.inline?[]:qL(o);return p([vy.config({}),VL.config({contextual:m({lazyContext:function(t){var e=ac(t.element()),r=n.inline?n.getContentAreaContainer():n.getContainer(),i=Lc(We.fromDom(r)),u=i.height()-e,a=i.y()+(o?0:e);return w.some(zc(i.x(),a,i.width(),u))},onShow:function(){r((function(n){return jL(n,!0)}))},onShown:function(n){r((function(n){return Oa(n,[NL.transitionClass,NL.fadeInClass])})),e.get().each((function(t){WL(n.element(),t),e.set(w.none())}))},onHide:function(n){e.set(GL(n.element(),t)),r((function(n){return jL(n,!1)}))},onHidden:function(){r((function(n){return Oa(n,[NL.transitionClass])}))}},NL),modes:[o?"top":"bottom"],onDocked:i,onUndocked:i})],u)},JL=Object.freeze({__proto__:null,setup:XL,isDocked:YL,getBehaviours:KL}),$L=e,QL=f,ZL=i([]),nj=Object.freeze({__proto__:null,setup:$L,isDocked:QL,getBehaviours:ZL}),tj=function(n){var t=n.editor,e=n.sticky?KL:ZL;return{uid:n.uid,dom:n.dom,components:n.components,behaviours:xf(e(t,n.getSink))}},ej=function(n,t){var e=function(n,e){var o=W(e,(function(n){var e={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},o=MH(e).mapError((function(n){return Jt(n)})).getOrDie();return bF(o,"tox-mbtn",t.backstage,w.some("menuitem"))}));uy.set(n,o)},o={focus:Jb.focusIn,setMenus:e};return{uid:n.uid,dom:n.dom,components:[],behaviours:xf([uy.config({}),cy("menubar-events",[wi((function(t){n.onSetup(t)})),li(yr(),(function(n,t){$c(n.element(),".tox-mbtn--active").each((function(e){Qc(t.event().target(),".tox-mbtn").each((function(t){Qo(e,t)||n.getSystem().getByDom(e).each((function(e){n.getSystem().getByDom(t).each((function(n){rE.expand(n),rE.close(e),vy.focus(n)}))}))}))}))})),li(Kr(),(function(n,t){t.event().prevFocus().bind((function(t){return n.getSystem().getByDom(t).toOption()})).each((function(e){t.event().newFocus().bind((function(t){return n.getSystem().getByDom(t).toOption()})).each((function(n){rE.isOpen(e)&&(rE.expand(n),rE.close(e))}))}))}))]),Jb.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),w.some(!0)}}),ET.config({})]),apis:o,domModification:{attributes:{role:"menubar"}}}},oj=Xp({factory:ej,name:"silver.Menubar",configFields:[ce("dom"),ce("uid"),ce("onEscape"),ce("backstage"),Te("onSetup",e)],apis:{focus:function(n,t){n.focus(t)},setMenus:function(n,t,e){n.setMenus(t,e)}}}),rj="container",ij=[Ig("slotBehaviours",[])],uj=function(n){return"<alloy.field."+n+">"},aj=function(n){var t=function(){var n=[],t=function(t,e){return n.push(t),Sp(rj,uj(t),e)};return{slot:t,record:function(){return n}}}(),e=n(t),o=t.record(),r=W(o,(function(n){return dp({name:n,pname:uj(n)})}));return Pp(rj,ij,r,cj,e)},cj=function(n,t){var e=function(t){return Ap(n)},o=function(t,e){return Tp(t,n,e)},r=function(t,e){return function(o,r){return Tp(o,n,r).map((function(n){return t(n,r)})).getOr(e)}},i=function(n){return function(t,e){G(e,(function(e){return n(t,e)}))}},u=function(n,t){return"true"!==su(n.element(),"aria-hidden")},a=function(n,t){if(!u(n)){var e=n.element();za(e,"display"),du(e,"aria-hidden"),ei(n,Jr(),{name:t,visible:!0})}},c=function(n,t){if(u(n)){var e=n.element();Ma(e,"display","none"),au(e,"aria-hidden","true"),ei(n,Jr(),{name:t,visible:!1})}},s=r(u,!1),f=r(c),l=i(f),d=function(n){return l(n,e())},m=r(a),g={getSlotNames:e,getSlot:o,isShowing:s,hideSlot:f,hideAllSlots:d,showSlot:m};return{uid:n.uid,dom:n.dom,components:t,behaviours:Rg(n.slotBehaviours),apis:g}},sj=pn({getSlotNames:function(n,t){return n.getSlotNames(t)},getSlot:function(n,t,e){return n.getSlot(t,e)},isShowing:function(n,t,e){return n.isShowing(t,e)},hideSlot:function(n,t,e){return n.hideSlot(t,e)},hideAllSlots:function(n,t){return n.hideAllSlots(t)},showSlot:function(n,t,e){return n.showSlot(t,e)}},(function(n){return zu(n)})),fj=m(m({},sj),{sketch:aj}),lj=Dt([Se("icon"),Se("tooltip"),Fe("onShow",e),Fe("onHide",e),Fe("onSetup",(function(){return e}))]),dj=function(n){return Yt("sidebar",lj,n)},mj=function(n){var t=n.ui.registry.getAll().sidebars;G(dn(t),(function(e){var o=t[e],r=function(){return w.from(n.queryCommandValue("ToggleSidebar")).is(e)};n.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(t){n.execCommand("ToggleSidebar",!1,e),t.setActive(r())},onSetup:function(t){var e=function(){return t.setActive(r())};return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})}))},gj=function(n){return{element:function(){return n.element().dom()}}},pj=function(n,t){var o=W(dn(t),(function(n){var e=t[n],o=qt(dj(e));return{name:n,getApi:gj,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return W(o,(function(t){var r=He(e);return n.slot(t.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:xS.unnamedEvents([RC(t,r),VC(t,r),li(Jr(),(function(n,t){var e=t.event(),r=$(o,(function(n){return n.name===e.name()}));r.each((function(t){var o=e.visible()?t.onShow:t.onHide;o(t.getApi(n))}))}))])})}))},hj=function(n){return fj.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:pj(t,n),slotBehaviours:xS.unnamedEvents([wi((function(n){return fj.hideAllSlots(n)}))])}}))},vj=function(n,t){var e=eh.getCurrent(n);e.each((function(n){return uy.set(n,[hj(t)])}))},bj=function(n,t){var e=eh.getCurrent(n);e.each((function(n){var e=eh.getCurrent(n);e.each((function(e){iH.hasGrown(n)?fj.isShowing(e,t)?iH.shrink(n):(fj.hideAllSlots(e),fj.showSlot(e,t)):(fj.hideAllSlots(e),fj.showSlot(e,t),iH.grow(n))}))}))},yj=function(n){var t=eh.getCurrent(n);return t.bind((function(n){var t=iH.isGrowing(n)||iH.hasGrown(n);if(t){var e=eh.getCurrent(n);return e.bind((function(n){return $(fj.getSlotNames(n),(function(t){return fj.isShowing(n,t)}))}))}return w.none()}))},xj=wu("FixSizeEvent"),wj=wu("AutoSizeEvent"),Sj=function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:xf([ET.config({}),vy.config({}),iH.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(n){var t=eh.getCurrent(n);t.each(fj.hideAllSlots),ti(n,wj)},onGrown:function(n){ti(n,wj)},onStartGrow:function(n){ei(n,xj,{width:Na(n.element(),"width").getOr("")})},onStartShrink:function(n){ei(n,xj,{width:vc(n.element())+"px"})}}),uy.config({}),eh.config({find:function(n){var t=uy.contents(n);return cn(t)}})])}],behaviours:xf([gA.childAt(0),cy("sidebar-sliding-events",[li(xj,(function(n,t){Ma(n.element(),"width",t.event().width())})),li(wj,(function(n,t){za(n.element(),"width")}))])])}},Cj=function(n){var t=void 0!==n.dom().attributes?n.dom().attributes:[];return J(t,(function(n,t){var e;return"class"===t.name?n:m(m({},n),(e={},e[t.name]=t.value,e))}),{})},kj=function(n){return Array.prototype.slice.call(n.dom().classList,0)},Oj=function(n){var t=We.fromHtml(n),e=Hi(t),o=Cj(t),r=kj(t),i=0===e.length?{}:{innerHtml:Qi(t)};return m({tag:tu(t),classes:r,attributes:o},i)},_j=function(n){return{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:Oj('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:xf([Jb.config({mode:"special",onTab:function(){return w.some(!0)},onShiftTab:function(){return w.some(!0)}}),vy.config({})])}},Tj=function(n,t,e){var o=n.element();!0===t?(uy.set(n,[_j(e)]),za(o,"display"),du(o,"aria-hidden")):(uy.set(n,[]),Ma(o,"display","none"),au(o,"aria-hidden","true"))},Ej=function(n){return{uid:n.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:xf([uy.config({})]),components:[]}},Bj=function(n,t,e){var o=He(!1),r=He(w.none()),i=function(n){n!==o.get()&&(Tj(t(),n,e.providers),o.set(n))};n.on("ProgressState",(function(t){if(r.get().each(Ix.clearTimeout),F(t.time)){var e=Ix.setEditorTimeout(n,(function(){return i(t.state)}),t.time);r.set(w.some(e))}else i(t.state),r.set(w.none())}))},Dj=function(n,t,e){var o={getSocket:function(t){return $z.getPart(t,n,"socket")},setSidebar:function(t,e){$z.getPart(t,n,"sidebar").each((function(n){return vj(n,e)}))},toggleSidebar:function(t,e){$z.getPart(t,n,"sidebar").each((function(n){return bj(n,e)}))},whichSidebar:function(t){return $z.getPart(t,n,"sidebar").bind(yj).getOrNull()},getHeader:function(t){return $z.getPart(t,n,"header")},getToolbar:function(t){return $z.getPart(t,n,"toolbar")},setToolbar:function(t,e){$z.getPart(t,n,"toolbar").each((function(n){n.getApis().setGroups(n,e)}))},setToolbars:function(t,e){$z.getPart(t,n,"multiple-toolbar").each((function(n){iL.setItems(n,e)}))},refreshToolbar:function(t){var e=$z.getPart(t,n,"toolbar");e.each((function(n){return n.getApis().refresh(n)}))},getThrobber:function(t){return $z.getPart(t,n,"throbber")},focusToolbar:function(t){var e=$z.getPart(t,n,"toolbar").orThunk((function(){return $z.getPart(t,n,"multiple-toolbar")}));e.each((function(n){Jb.focusIn(n)}))},setMenubar:function(t,e){$z.getPart(t,n,"menubar").each((function(n){oj.setMenus(n,e)}))},focusMenubar:function(t){$z.getPart(t,n,"menubar").each((function(n){oj.focus(n)}))}};return{uid:n.uid,dom:n.dom,components:t,apis:o,behaviours:n.behaviours}},Aj=Qz.optional({factory:oj,name:"menubar",schema:[ce("backstage")]}),Mj=function(n){return n.type===Xh.sliding?OH:n.type===Xh.floating?kH:_H},Fj=Qz.optional({factory:{sketch:function(n){return iL.sketch({uid:n.uid,dom:n.dom,listBehaviours:xf([Jb.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return _H({type:n.type,uid:wu("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],onEscape:function(){return w.none()}})},setupItem:function(n,t,e,o){rN.setGroups(t,e)},shell:!0})}},name:"multiple-toolbar",schema:[ce("dom"),ce("onEscape")]}),Ij=Qz.optional({factory:{sketch:function(n){var t=Mj(n),e={type:n.type,uid:n.uid,onEscape:function(){return n.onEscape(),w.some(!0)},cyclicKeying:!1,initGroups:[],getSink:n.getSink,backstage:n.backstage,moreDrawerData:{lazyToolbar:n.lazyToolbar,lazyMoreButton:n.lazyMoreButton,lazyHeader:n.lazyHeader},attributes:n.attributes};return t(e)}},name:"toolbar",schema:[ce("dom"),ce("onEscape"),ce("getSink")]}),Rj=Qz.optional({factory:{sketch:tj},name:"header",schema:[ce("dom")]}),Vj=Qz.optional({name:"socket",schema:[ce("dom")]}),Nj=Qz.optional({factory:{sketch:Sj},name:"sidebar",schema:[ce("dom")]}),Hj=Qz.optional({factory:{sketch:Ej},name:"throbber",schema:[ce("dom")]}),Pj=Yp({name:"OuterContainer",factory:Dj,configFields:[ce("dom"),ce("behaviours")],partFields:[Rj,Aj,Ij,Fj,Vj,Nj,Hj],apis:{getSocket:function(n,t){return n.getSocket(t)},setSidebar:function(n,t,e){n.setSidebar(t,e)},toggleSidebar:function(n,t,e){n.toggleSidebar(t,e)},whichSidebar:function(n,t){return n.whichSidebar(t)},getHeader:function(n,t){return n.getHeader(t)},getToolbar:function(n,t){return n.getToolbar(t)},setToolbar:function(n,t,e){var o=W(e,(function(n){return wH(n)}));n.setToolbar(t,o)},setToolbars:function(n,t,e){var o=W(e,(function(n){return W(n,wH)}));n.setToolbars(t,o)},refreshToolbar:function(n,t){return n.refreshToolbar(t)},getThrobber:function(n,t){return n.getThrobber(t)},setMenubar:function(n,t,e){n.setMenubar(t,e)},focusMenubar:function(n,t){n.focusMenubar(t)},focusToolbar:function(n,t){n.focusToolbar(t)}}}),zj="file edit view insert format tools table help",Lj={file:{title:"File",items:"newdocument restoredraft | preview | print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},jj=function(n,t,e){var o=qx(e).split(/[ ,]/);return{text:n.title,getItems:function(){return nn(n.items,(function(n){var e=n.toLowerCase();return 0===e.trim().length?[]:L(o,(function(n){return n===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:t.menuItems[e]?[t.menuItems[e]]:[]}))}}},Uj=function(n){return"string"===typeof n?n.split(" "):n},Wj=function(n,t){var e=m(m({},Lj),t.menus),o=dn(t.menus).length>0,r=void 0===t.menubar||!0===t.menubar?Uj(zj):Uj(!1===t.menubar?"":t.menubar),i=q(r,(function(n){return o&&t.menus.hasOwnProperty(n)&&t.menus[n].hasOwnProperty("items")||Lj.hasOwnProperty(n)})),u=W(i,(function(o){var r=e[o];return jj({title:r.title,items:Uj(r.items)},t,n)}));return q(u,(function(n){var t=function(n){return"separator"!==n.type};return n.getItems().length>0&&L(n.getItems(),t)}))},Gj=function(n){var t=function(){n._skinLoaded=!0,Xk.fireSkinLoaded(n)};return function(){n.initialized?t():n.on("init",t)}},Xj=function(n,t){return function(){return Xk.fireSkinLoadError(n,{message:t})}},Yj={fireSkinLoaded:Gj,fireSkinLoadError:Xj},qj=function(n,t){var e,o=Nx(t);o&&(e=o+"/skin.min.css",t.contentCSS.push(o+(n?"/content.inline":"/content")+".min.css")),!1===Px(t)&&e?Rx.DOM.styleSheetLoader.load(e,Yj.fireSkinLoaded(t),Yj.fireSkinLoadError(t,"Skin could not be loaded")):Yj.fireSkinLoaded(t)()},Kj=a(qj,!1),Jj=a(qj,!0),$j=function(n,t,e,o){var r=t.outerContainer,i=e.toolbar,u=e.buttons;if(I(i,E)){var a=i.map((function(t){var r={toolbar:t,buttons:u,allowToolbarGroups:e.allowToolbarGroups};return zz(n,r,{backstage:o},w.none())}));Pj.setToolbars(r,a)}else Pj.setToolbar(r,zz(n,e,{backstage:o},w.none()))},Qj=Rx.DOM,Zj=jo(),nU=Zj.os.isiOS()&&Zj.os.version.major<=12,tU=function(n){var t=n.getWin(),e=n.getDoc().documentElement,o=He(fc(t.innerWidth,t.innerHeight)),r=He(fc(e.offsetWidth,e.offsetHeight)),i=function(e){var i=n.getDoc().documentElement,u=o.get(),a=r.get();u.left()!==t.innerWidth||u.top()!==t.innerHeight?(o.set(fc(t.innerWidth,t.innerHeight)),Xk.fireResizeContent(n,e)):a.left()===i.offsetWidth&&a.top()===i.offsetHeight||(r.set(fc(i.offsetWidth,i.offsetHeight)),Xk.fireResizeContent(n,e))},u=function(t){return Xk.fireScrollContent(n,t)};Qj.bind(t,"resize",i),Qj.bind(t,"scroll",u);var a=e_(We.fromDom(n.getBody()),"load",i);n.on("remove",(function(){a.unbind(),Qj.unbind(t,"resize",i),Qj.unbind(t,"scroll",u)}))},eU=function(n,t,e,o,r){var i=He(0);Kj(n),Bm(We.fromDom(r.targetNode),t.mothership),Em(Ea(),t.uiMothership),n.on("PostRender",(function(){$j(n,t,e,o),i.set(n.getWin().innerWidth),Pj.setMenubar(t.outerContainer,Wj(n,e)),Pj.setSidebar(t.outerContainer,e.sidebar),tU(n)}));var u=Pj.getSocket(t.outerContainer).getOrDie("Could not find expected socket element");if(!0===nU){Fa(u.element(),{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var a=Sw((function(){n.fire("ScrollContent")}),20);t_(u.element(),"scroll",a.throttle)}bH(n,t),n.addCommand("ToggleSidebar",(function(e,o){Pj.toggleSidebar(t.outerContainer,o),n.fire("ToggleSidebar")})),n.addQueryValueHandler("ToggleSidebar",(function(){return Pj.whichSidebar(t.outerContainer)}));var c=nw(n),s=function(){Pj.refreshToolbar(t.outerContainer)};return c!==Xh.sliding&&c!==Xh.floating||n.on("ResizeWindow ResizeEditor ResizeContent",(function(){var t=n.getWin().innerWidth;t!==i.get()&&(s(),i.set(t))})),{iframeContainer:u.element().dom(),editorContainer:t.outerContainer.element().dom()}},oU={render:eU},rU=function(n){var t=/^[0-9\.]+(|px)$/i;return t.test(""+n)?w.some(parseInt(""+n,10)):w.none()},iU=function(n){return F(n)?n+"px":n},uU=function(n,t,e){var o=t.filter((function(t){return n<t})),r=e.filter((function(t){return n>t}));return o.or(r).getOr(n)},aU={calcCappedSize:uU,parseToInt:rU,numToPx:iU},cU=function(n){var t=zx(n),e=Ux(n),o=Gx(n);return aU.parseToInt(t).map((function(n){return aU.calcCappedSize(n,e,o)}))},sU=function(n){var t=cU(n);return t.getOr(zx(n))},fU=function(n){var t=Lx(n),e=jx(n),o=Wx(n);return aU.parseToInt(t).map((function(n){return aU.calcCappedSize(n,e,o)}))},lU=function(n){var t=fU(n);return t.getOr(Lx(n))},dU=function(n,t){var e=Lc(n);return{pos:t?e.y():e.bottom(),height:e.height()}},mU=function(n,t,e,o,r){var i,u=t.mothership,a=t.uiMothership,c=t.outerContainer,s=Rx.DOM,f=iw(n),l=cw(n),d=We.fromDom(r.targetNode),m=Wx(n).or(fU(n)),g=nw(n),p=g===Xh.sliding||g===Xh.floating,h=ew(n),v=He(dU(d,h)),b=He(!1);Jj(n);var y=function(n){var t=p?n.fold((function(){return 0}),(function(n){return n.components().length>1?uc(n.components()[1].element()):0})):0,e=Lc(d),o=h?e.y()-uc(i.element())+t:e.bottom();Fa(c.element(),{position:"absolute",top:Math.round(o)+"px",left:Math.round(e.x())+"px"});var r=m.getOrThunk((function(){var n=aU.parseToInt(Ra(Ea(),"margin-left")).getOr(0);return vc(Ea())-e.x()+n}));Ma(i.element(),"max-width",r+"px")},x=function(){a.broadcastOn([Zm()],{})},w=function(n){if(void 0===n&&(n=!1),p&&Pj.refreshToolbar(c),!f){var t=Pj.getToolbar(c);y(t)}l&&(n?VL.reset(i):VL.refresh(i)),x()},S=function(){b.set(!0),Ma(c.element(),"display","flex"),s.addClass(n.getBody(),"mce-edit-focus"),za(a.element(),"display"),w()},C=function(){b.set(!1),t.outerContainer&&(Ma(c.element(),"display","none"),s.removeClass(n.getBody(),"mce-edit-focus")),Ma(a.element(),"display","none")},k=function(){if(i)S();else{i=Pj.getHeader(c).getOrDie();var r=uw(n);Em(r,u),Em(r,a),$j(n,t,e,o),Pj.setMenubar(c,Wj(n,e)),S(),n.on("activate",S),n.on("deactivate",C),n.on("SkinLoaded ResizeWindow",(function(){b.get()&&w(!0)})),n.on("NodeChange keydown",(function(){Ix.requestAnimationFrame((function(){var n=dU(d,h),t=v.get();b.get()&&(n.pos!==t.pos?(w(!0),v.set(n)):n.height!==t.height&&(x(),v.set(n)))}))})),n.nodeChanged()}};return n.on("focus",k),n.on("blur hide",C),n.on("init",(function(){n.hasFocus()&&k()})),bH(n,t),{editorContainer:c.element().dom()}},gU={render:mU},pU=function(n){var t=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];aI.each(t,(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:XP(n,t.name)})}));var e={name:"alignnone",text:"No alignment",cmd:"JustifyNone",icon:"align-none"};n.ui.registry.addButton(e.name,{tooltip:e.text,onAction:function(){return n.execCommand(e.cmd)},icon:e.icon})},hU={register:pU},vU=function(n,t){return function(){n.execCommand("mceToggleFormat",!1,t)}},bU=function(n){aI.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(t,e){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:XP(n,t.name),onAction:vU(n,t.name)})}));for(var t=1;t<=6;t++){var e="h"+t;n.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+t,onSetup:XP(n,e),onAction:vU(n,e)})}},yU=function(n){aI.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}))},xU=function(n){aI.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)},onSetup:XP(n,t.name)})}))},wU=function(n){bU(n),yU(n),xU(n)},SU=function(n){aI.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:vU(n,"code")})},CU=function(n){wU(n),SU(n)},kU={register:CU},OU=function(n,t,e){var o=function(){return!!t.undoManager&&t.undoManager[e]()},r=function(){n.setDisabled(t.mode.isReadOnly()||!o())};return n.setDisabled(!o()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},_U=function(n){n.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return OU(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return OU(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})},TU=function(n){n.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return OU(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return OU(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})},EU=function(n){_U(n),TU(n)},BU={register:EU},DU=function(n,t){n.setActive(t.hasVisual);var e=function(t){n.setActive(t.hasVisual)};return t.on("VisualAid",e),function(){return t.off("VisualAid",e)}},AU=function(n){n.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return DU(t,n)},onAction:function(){n.execCommand("mceToggleVisualAid")}})},MU=function(n){n.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return n.execCommand("mceToggleVisualAid")}})},FU=function(n){MU(n),AU(n)},IU={register:FU},RU=function(n,t){n.setDisabled(!t.queryCommandState("outdent"));var e=function(){n.setDisabled(!t.queryCommandState("outdent"))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}},VU=function(n){n.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return RU(t,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}})},NU=function(n){VU(n)},HU={register:NU},PU=function(n,t){iz(n,t),dz(n,t),Bz(n,t),_z(n,t),xz(n,t)},zU={register:PU},LU=function(n,t){hU.register(n),kU.register(n),zU.register(n,t),BU.register(n),cO.register(n),IU.register(n),HU.register(n)},jU={setup:LU},UU=function(n,t){return{anchor:"makeshift",x:n,y:t}},WU=function(n,t,e){return UU(n.x+t,n.y+e)},GU=function(n){return"longpress"===n.type||0===n.type.indexOf("touch")},XU=function(n){if(GU(n)){var t=n.touches[0];return UU(t.pageX,t.pageY)}return UU(n.pageX,n.pageY)},YU=function(n){if(GU(n)){var t=n.touches[0];return UU(t.clientX,t.clientY)}return UU(n.clientX,n.clientY)},qU=function(n,t){var e=Rx.DOM.getPos(n);return WU(t,e.x,e.y)},KU=function(n,t){return"contextmenu"===t.type||"longpress"===t.type?n.inline?XU(t):qU(n.getContentAreaContainer(),YU(t)):JU(n)},JU=function(n){return{anchor:"selection",root:We.fromDom(n.selection.getNode())}},$U=function(n){return{anchor:"node",node:w.some(We.fromDom(n.selection.getNode())),root:We.fromDom(n.getBody())}},QU=function(n,t,e){return e?$U(n):KU(n,t)},ZU=function(n,t,e,o,r,i){var u=e(),a=QU(n,t,i);hF(u,NC.CLOSE_ON_EXECUTE,o,!1).map((function(n){t.preventDefault(),Sx.showMenuAt(r,a,{menu:{markers:lO("normal")},data:n})}))},nW={onLtr:function(){return[of,Qs,Zs,nf,tf,ef,Mx,Fx,Dx,Ex,Ax,Bx]},onRtl:function(){return[of,Zs,Qs,tf,nf,ef,Mx,Fx,Ax,Bx,Dx,Ex]}},tW=12,eW={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},oW=function(n,t){var e=n.selection;if(e.isCollapsed()||t.touches.length<1)return!1;var o=t.touches[0],r=e.getRng(),i=_d(n.getWin(),$l.domRange(r));return i.exists((function(n){return n.left()<=o.clientX&&n.right()>=o.clientX&&n.top()<=o.clientY&&n.bottom()>=o.clientY}))},rW=function(n,t,e){var o=t?$U(n):KU(n,e);return m({bubble:yl(0,tW,eW),layouts:nW,overrides:{maxWidthFunction:YV(),maxHeightFunction:ml()}},o)},iW=function(n){var t=n.selection.getRng(),e=function(){Ix.setEditorTimeout(n,(function(){n.selection.setRng(t)}),10),i()};n.once("touchend",e);var o=function(n){n.preventDefault(),n.stopImmediatePropagation()};n.on("mousedown",o,!0);var r=function(){return i()};n.once("longpresscancel",r);var i=function(){n.off("touchend",e),n.off("longpresscancel",r),n.off("mousedown",o)}},uW=function(n,t,e,o,r,i,u){var a=rW(n,i,t);hF(e,NC.CLOSE_ON_EXECUTE,o,!0).map((function(e){t.preventDefault(),Sx.showMenuWithinBounds(r,a,{menu:{markers:lO("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return w.some(RP(n))})),n.fire(KV)}))},aW=function(n,t,e,o,r,i){var u=jo(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){return!(s||a||c&&f)},d=function(){var u=e();uW(n,t,u,o,r,i,l())};if(!c&&!a||i)s&&!i&&n.selection.setCursorLocation(t.target,0),d();else{var m=function(){iW(n),d()};oW(n,t)?m():(n.once("selectionchange",m),n.once("touchend",(function(){return n.off("selectionchange",m)})))}},cW=function(n){return"string"===typeof n?n.split(/[ ,]/):n},sW=function(n){return n.settings.contextmenu_never_use_native||!1},fW=function(n,t,e){var o=n.ui.registry.getAll().contextMenus;return xn(n.settings,t).map(cW).getOrThunk((function(){return q(cW(e),(function(n){return wn(o,n)}))}))},lW=function(n){return!1===n.getParam("contextmenu")},dW=function(n){return fW(n,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},mW={shouldNeverUseNative:sW,getContextMenu:dW,isContextMenuDisabled:lW},gW=function(n){return E(n)?"|"===n:"separator"===n.type},pW={type:"separator"},hW=function(n){if(E(n))return n;switch(n.type){case"separator":return pW;case"submenu":return{type:"nestedmenuitem",text:n.text,icon:n.icon,getSubmenuItems:function(){var t=n.getSubmenuItems();return E(t)?t:W(t,hW)}};default:return{type:"menuitem",text:n.text,icon:n.icon,onAction:o(n.onAction)}}},vW=function(n,t){if(0===t.length)return n;var e=sn(n).filter((function(n){return!gW(n)})),o=e.fold((function(){return[]}),(function(n){return[pW]}));return n.concat(o).concat(t).concat([pW])},bW=function(n,t,e){var o=J(t,(function(t,o){if(wn(n,o)){var r=n[o].update(e);if(E(r))return vW(t,r.split(" "));if(r.length>0){var i=W(r,hW);return vW(t,i)}return t}return t.concat([o])}),[]);return o.length>0&&gW(o[o.length-1])&&o.pop(),o},yW=function(n,t){return t.ctrlKey&&!mW.shouldNeverUseNative(n)},xW=function(n,t){return"longpress"!==t.type&&(2!==t.button||t.target===n.getBody()&&""===t.pointerType)},wW=function(n,t,e){var o=jo(),r=o.deviceType.isTouch,i=ec(Sx.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return n.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:xf([cy("dismissContextMenu",[li(Yr(),(function(t,e){$m.close(t),n.focus()}))])])})),u=function(n){return Sx.hide(i)},a=function(t){if(mW.shouldNeverUseNative(n)&&t.preventDefault(),!yW(n,t)&&!mW.isContextMenuDisabled(n)){var o=xW(n,t),u=function(){var e=o?n.selection.getStart(!0):t.target,r=n.ui.registry.getAll(),i=mW.getContextMenu(n);return bW(r.contextMenus,i,e)},a=r()?aW:ZU;a(n,t,u,e,i,o)}};n.on("init",(function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(r()?"":" ResizeWindow");n.on(t,u),n.on("longpress contextmenu",a)}))},SW=kn.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),CW=function(n){return function(t){return t.translate(-n.left(),-n.top())}},kW=function(n){return function(t){return t.translate(n.left(),n.top())}},OW=function(n){return function(t,e){return J(n,(function(n,t){return t(n)}),fc(t,e))}},_W=function(n,t,e){return n.fold(OW([kW(e),CW(t)]),OW([CW(t)]),OW([]))},TW=function(n,t,e){return n.fold(OW([kW(e)]),OW([]),OW([kW(t)]))},EW=function(n,t,e){return n.fold(OW([]),OW([CW(e)]),OW([kW(t),CW(e)]))},BW=function(n,t,e,o,r,i){var u=TW(n,r,i),a=TW(t,r,i);return Math.abs(u.left()-a.left())<=e&&Math.abs(u.top()-a.top())<=o},DW=function(n,t,e,o,r,i){var u=TW(n,r,i),a=TW(t,r,i),c=Math.abs(u.left()-a.left()),s=Math.abs(u.top()-a.top());return fc(c,s)},AW=function(n,t,e){var o=n.fold((function(n,t){return{position:w.some("absolute"),left:w.some(n+"px"),top:w.some(t+"px")}}),(function(n,t){return{position:w.some("absolute"),left:w.some(n-e.left()+"px"),top:w.some(t-e.top()+"px")}}),(function(n,t){return{position:w.some("fixed"),left:w.some(n+"px"),top:w.some(t+"px")}}));return m({right:w.none(),bottom:w.none()},o)},MW=function(n,t,e){return n.fold((function(n,o){return IW(n+t,o+e)}),(function(n,o){return RW(n+t,o+e)}),(function(n,o){return VW(n+t,o+e)}))},FW=function(n,t,e,o){var r=function(n,r){return function(i,u){var a=n(t,e,o);return r(i.getOr(a.left()),u.getOr(a.top()))}};return n.fold(r(EW,IW),r(TW,RW),r(_W,VW))},IW=SW.offset,RW=SW.absolute,VW=SW.fixed,NW=function(n,t){var e=n.element(),o=parseInt(su(e,t.leftAttr),10),r=parseInt(su(e,t.topAttr),10);return isNaN(o)||isNaN(r)?w.none():w.some(fc(o,r))},HW=function(n,t,e){var o=n.element();au(o,t.leftAttr,e.left()+"px"),au(o,t.topAttr,e.top()+"px")},PW=function(n,t){var e=n.element();du(e,t.leftAttr),du(e,t.topAttr)},zW=function(n,t,e,o){return NW(n,t).fold((function(){return e}),(function(n){return VW(n.left()+o.left(),n.top()+o.top())}))},LW=function(n,t,e,o,r,i){var u=zW(n,t,e,o),a=t.mustSnap?WW(n,t,u,r,i):GW(n,t,u,r,i),c=_W(u,r,i);return HW(n,t,c),a.fold((function(){return{coord:VW(c.left(),c.top()),extra:w.none()}}),(function(n){return{coord:n.output(),extra:n.extra()}}))},jW=function(n,t){PW(n,t)},UW=function(n,t,e,o){return ln(n,(function(n){var r=n.sensor(),u=BW(t,r,n.range().left(),n.range().top(),e,o);return u?w.some({output:i(FW(n.output(),t,e,o)),extra:n.extra}):w.none()}))},WW=function(n,t,e,o,r){var u=t.getSnapPoints(n),a=UW(u,e,o,r);return a.orThunk((function(){var n=J(u,(function(n,t){var i=t.sensor(),u=DW(e,i,t.range().left(),t.range().top(),o,r);return n.deltas.fold((function(){return{deltas:w.some(u),snap:w.some(t)}}),(function(e){var o=(u.left()+u.top())/2,r=(e.left()+e.top())/2;return o<=r?{deltas:w.some(u),snap:w.some(t)}:n}))}),{deltas:w.none(),snap:w.none()});return n.snap.map((function(n){return{output:i(FW(n.output(),e,o,r)),extra:n.extra}}))}))},GW=function(n,t,e,o,r){var i=t.getSnapPoints(n);return UW(i,e,o,r)},XW=function(n,t,e){return{coord:FW(n.output(),n.output(),t,e),extra:n.extra()}},YW=function(n,t,e,o){var r=t.getTarget(n.element());if(t.repositionTarget){var i=Mi(n.element()),u=Tc(i),a=aL(r),c=XW(o,u,a),s=AW(c.coord,u,a);Ia(r,s)}},qW=Object.freeze({__proto__:null,snapTo:YW}),KW="data-initial-z-index",JW=function(n){Ri(n.element()).filter(ru).each((function(n){var t=su(n,KW);lu(n,KW)?Ma(n,"z-index",t):za(n,"z-index"),du(n,KW)}))},$W=function(n){Ri(n.element()).filter(ru).each((function(t){Na(t,"z-index").each((function(n){au(t,KW,n)})),Ma(t,"z-index",Ra(n.element(),"z-index"))}))},QW=function(n,t){n.getSystem().addToGui(t),$W(t)},ZW=function(n){JW(n),n.getSystem().removeFromGui(n)},nG=function(n,t,e){return n.getSystem().build(M_.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:e}))},tG=Oe("snaps",[ce("getSnapPoints"),ws("onSensor"),ce("leftAttr"),ce("topAttr"),Te("lazyViewport",Uc),Te("mustSnap",!1)]),eG=[Te("useFixed",f),ce("blockerClass"),Te("getTarget",u),Te("onDrag",e),Te("repositionTarget",!0),Te("onDrop",e),Fe("getBounds",Uc),tG],oG=function(n){return $p(Na(n,"left"),Na(n,"top"),Na(n,"position"),(function(n,t,e){var o="fixed"===e?VW:IW;return o(parseInt(n,10),parseInt(t,10))})).getOrThunk((function(){var t=mc(n);return RW(t.left(),t.top())}))},rG=function(n,t,e,o,r){var i=r.bounds,u=TW(t,e,o),a=Zf(u.left(),i.x(),i.x()+i.width()-r.width),c=Zf(u.top(),i.y(),i.y()+i.height()-r.height),s=RW(a,c);return t.fold((function(){var n=EW(s,e,o);return IW(n.left(),n.top())}),(function(){return s}),(function(){var n=_W(s,e,o);return VW(n.left(),n.top())}))},iG=function(n,t,e,o,r,i,u){var a=t.fold((function(){var n=MW(e,i.left(),i.top()),t=_W(n,o,r);return VW(t.left(),t.top())}),(function(t){var u=LW(n,t,e,i,o,r);return u.extra.each((function(e){t.onSensor(n,e)})),u.coord}));return rG(n,a,o,r,u)},uG=function(n,t,e,o){var r=t.getTarget(n.element());if(t.repositionTarget){var i=Mi(n.element()),u=Tc(i),a=aL(r),c=oG(r),s=iG(n,t.snaps,c,u,a,o,e),f=AW(s,u,a);Ia(r,f)}t.onDrag(n,r,o)},aG=function(n,t){return{bounds:n.getBounds(),height:ac(t.element()),width:bc(t.element())}},cG=function(n,t,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return aG(t,n)}));i.each((function(e){uG(n,t,u,e)}))},sG=function(n,t,e,o){t.each(ZW),e.snaps.each((function(t){jW(n,t)}));var r=e.getTarget(n.element());o.reset(),e.onDrop(n,r)},fG=function(n){return function(t,e){var o=function(n){e.setStartData(aG(t,n))};return ai(p([li(Ur(),(function(n){e.getStartData().each((function(){return o(n)}))}))],n(t,e,o)))}},lG=function(n){return ai([li(pr(),n.forceDrop),li(br(),n.drop),li(hr(),(function(t,e){n.move(e.event())})),li(vr(),n.delayDrop)])},dG=function(n){return w.from(fc(n.x(),n.y()))},mG=function(n,t){return fc(t.left()-n.left(),t.top()-n.top())},gG=Object.freeze({__proto__:null,getData:dG,getDelta:mG}),pG=function(n,t,e){return[li(pr(),(function(o,r){var i=r.event().raw();if(0===i.button){r.stop();var u=function(){return sG(o,w.some(s),n,t)},a=i_(u,200),c={drop:u,delayDrop:a.schedule,forceDrop:u,move:function(e){a.cancel(),cG(o,n,t,gG,e)}},s=nG(o,n.blockerClass,lG(c)),f=function(){e(o),QW(o,s)};f()}}))]},hG=p(eG,[Os("dragger",{handlers:fG(pG)})]),vG=function(n){return ai([li(lr(),n.forceDrop),li(mr(),n.drop),li(gr(),n.drop),li(dr(),(function(t,e){n.move(e.event())}))])},bG=function(n){var t=n[0];return w.some(fc(t.clientX,t.clientY))},yG=function(n){var t=n.raw(),e=t.touches;return 1===e.length?bG(e):w.none()},xG=function(n,t){return fc(t.left()-n.left(),t.top()-n.top())},wG=Object.freeze({__proto__:null,getData:yG,getDelta:xG}),SG=function(n,t,e){var o=He(w.none());return[li(lr(),(function(r,i){i.stop();var u=function(){sG(r,o.get(),n,t),o.set(w.none())},a={drop:u,delayDrop:function(){},forceDrop:u,move:function(e){cG(r,n,t,wG,e)}},c=nG(r,n.blockerClass,vG(a));o.set(w.some(c));var s=function(){e(r),QW(r,c)};s()})),li(dr(),(function(e,o){o.stop(),cG(e,n,t,wG,o.event())})),li(mr(),(function(e,r){r.stop(),sG(e,o.get(),n,t),o.set(w.none())})),li(gr(),(function(e){sG(e,o.get(),n,t),o.set(w.none())}))]},CG=p(eG,[Os("dragger",{handlers:fG(SG)})]),kG=function(n,t,e){return p(pG(n,t,e),SG(n,t,e))},OG=p(eG,[Os("dragger",{handlers:fG(kG)})]),_G=hG,TG=CG,EG=OG,BG=Object.freeze({__proto__:null,mouse:_G,touch:TG,mouseOrTouch:EG}),DG=function(){var n=w.none(),t=w.none(),e=function(){n=w.none(),t=w.none()},o=function(t,e){var o=n.map((function(n){return t.getDelta(n,e)}));return n=w.some(e),o},r=function(n,t){return n.getData(t).bind((function(t){return o(n,t)}))},u=function(n){t=w.some(n)},a=function(){return t},c=i({});return ju({readState:c,reset:e,update:r,getStartData:a,setStartData:u})},AG=Object.freeze({__proto__:null,init:DG}),MG=kf({branchKey:"mode",branches:BG,name:"dragging",active:{events:function(n,t){var e=n.dragger;return e.handlers(n,t)}},extra:{snap:Ai(["sensor","range","output"],["extra"])},state:AG,apis:qW}),FG=jo(),IG=40,RG=IG/2,VG=function(n,t,e,o,r,i){return n.fold((function(){return MG.snap({sensor:RW(e-RG,o-RG),range:fc(r,i),output:RW(w.some(e),w.some(o)),extra:{td:t}})}),(function(n){var r=e-RG,i=o-RG,u=IG,a=IG,c=n.element().dom().getBoundingClientRect();return MG.snap({sensor:RW(r,i),range:fc(u,a),output:RW(w.some(e-c.width/2),w.some(o-c.height/2)),extra:{td:t}})}))},NG=function(n,t,e){var o=function(n,t){return n.exists((function(n){return Qo(n,t)}))};return{getSnapPoints:n,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(n,r){var i=r.td;o(t.get(),i)||(t.set(w.some(i)),e(i))},mustSnap:!0}},HG=function(n){return dw(lw.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:xf([MG.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:n}),cE.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},PG=function(n,t){var e=He([]),o=He([]),r=He(!1),i=He(w.none()),u=He(w.none()),a=function(n){var e=jc(n);return VG(m.getOpt(t),n,e.x(),e.y(),e.width(),e.height())},c=function(){return W(e.get(),(function(n){return a(n)}))},s=function(n){var e=jc(n);return VG(g.getOpt(t),n,e.right(),e.bottom(),e.width(),e.height())},f=function(){return W(o.get(),(function(n){return s(n)}))},l=NG(c,i,(function(t){u.get().each((function(e){n.fire("TableSelectorChange",{start:t,finish:e})}))})),d=NG(f,u,(function(t){i.get().each((function(e){n.fire("TableSelectorChange",{start:e,finish:t})}))})),m=HG(l),g=HG(d),p=ec(m.asSpec()),h=ec(g.asSpec()),v=function(t,e,o,r){var i=e.dom().getBoundingClientRect();za(t.element(),"display");var u=Ii(We.fromDom(n.getBody())).dom().innerHeight,a=o(i),c=r(i,u);(a||c)&&Ma(t.element(),"display","none")},b=function(n,t,e,o){var r=e(t);MG.snapTo(n,r);var i=function(n){return n[o]<0},u=function(n,t){return n[o]>t};v(n,t,i,u)},y=function(n){return b(p,n,a,"top")},x=function(){return i.get().each(y)},S=function(n){return b(h,n,s,"bottom")},C=function(){return u.get().each(S)};FG.deviceType.isTouch()&&(n.on("TableSelectionChange",(function(n){r.get()||(Cm(t,p),Cm(t,h),r.set(!0)),i.set(w.some(n.start)),u.set(w.some(n.finish)),n.otherCells.each((function(t){e.set(t.upOrLeftCells),o.set(t.downOrRightCells),y(n.start),S(n.finish)}))})),n.on("ResizeEditor ResizeWindow ScrollContent",(function(){x(),C()})),n.on("TableSelectionClear",(function(){r.get()&&(_m(p),_m(h),r.set(!1)),i.set(w.none()),u.set(w.none())})))},zG={setup:PG};(function(n){n[n["None"]=0]="None",n[n["Both"]=1]="Both",n[n["Vertical"]=2]="Vertical"})(ZP||(ZP={}));var LG=function(n,t,e,o,r){var i={};return i.height=aU.calcCappedSize(o+t.top(),Ux(n),Gx(n)),e===ZP.Both&&(i.width=aU.calcCappedSize(r+t.left(),jx(n),Wx(n))),i},jG=function(n,t,e){var o=We.fromDom(n.getContainer()),r=LG(n,t,e,uc(o),vc(o));gn(r,(function(n,t){return Ma(o,t,aU.numToPx(n))})),Xk.fireResizeEditor(n)},UG=function(n){if(1===n.nodeType){if("BR"===n.nodeName||n.getAttribute("data-mce-bogus"))return!0;if("bookmark"===n.getAttribute("data-mce-type"))return!0}return!1},WG=function(n,t){t.delimiter||(t.delimiter="");var e=function(e){var o=e||[],r=W(o,(function(t,e){return lw.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":e,"tab-index":-1,"aria-level":e+1},innerHtml:t.name},action:function(e){n.focus(),n.selection.select(t.element),n.nodeChanged()}})})),i={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}};return J(r.slice(1),(function(n,t){var e=n;return e.push(i),e.push(t),e}),[r[0]])},o=function(t){var e=[],o=t.length;while(o-- >0){var r=t[o];if(1===r.nodeType&&!UG(r)){var i=n.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:xf([Jb.config({mode:"flow",selector:"div[role=button]"}),ET.config({}),uy.config({}),cy("elementPathEvents",[wi((function(t,r){n.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return Jb.focusIn(t)})),n.on("NodeChange",(function(n){var r=o(n.parents);r.length>0?uy.set(t,e(r)):uy.set(t,[])}))}))])]),components:[]}},GG={renderElementPath:WG},XG=function(n,t){var e=function(n,e,o){return uy.set(n,[Za(t.translate(["{0} "+o,e[o]]))])};return lw.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:xf([ET.config({}),uy.config({}),Fg.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),cy("wordcount-events",[ki((function(n){var t=Fg.getValue(n),o="words"===t.mode?"characters":"words";Fg.setValue(n,{mode:o,count:t.count}),e(n,t.count,o)})),wi((function(t){n.on("wordCountUpdate",(function(n){var o=Fg.getValue(t).mode;Fg.setValue(t,{mode:o,count:n.wordCount}),e(t,n.wordCount,o)}))}))])])})},YG=function(n,t){var e=function(e){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize"),"aria-hidden":"true"},innerHtml:gw("resize-handle",t.icons)},behaviours:xf([MG.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,o,r){jG(n,r,e)},blockerClass:"tox-blocker"})])}},o=function(){var n=FS.translate(["Powered by {0}","Tiny"]),t='<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+n+'">'+n+"</a>";return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:t}}},r=function(n){var t=!Do(n.settings.plugins,"autoresize"),e=n.getParam("resize",t);return!1===e?ZP.None:"both"===e?ZP.Both:ZP.Vertical},i=function(){var e=[];return n.getParam("elementpath",!0,"boolean")&&e.push(GG.renderElementPath(n,{})),Do(n.settings.plugins,"wordcount")&&e.push(XG(n,t)),n.getParam("branding",!0,"boolean")&&e.push(o()),e.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:e}]:[]},u=function(){var t=i(),o=r(n);return o!==ZP.None&&t.push(e(o)),t};return{dom:{tag:"div",classes:["tox-statusbar"]},components:u()}},qG=function(n){var t,e=n.inline,o=e?gU:oU,r=cw(n)?JL:nj,i=w.none(),u=jo(),a=u.browser.isIE(),c=a?["tox-platform-ie"]:[],s=u.deviceType.isTouch(),f="tox-platform-touch",l=s?[f]:[],d=ew(n),g=FS.isRtl()?{attributes:{dir:"rtl"}}:{},p={attributes:(t={},t[kl]=d?rs.TopToBottom:rs.BottomToTop,t)},h=function(){return i.bind(Pj.getHeader)},v=function(){return r.isDocked(h)},b=ec({dom:m({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(c).concat(l)},g),behaviours:xf([vm.config({useFixed:function(){return v()}})])}),y=function(){return O.value(b)},x=dw({dom:{tag:"div",classes:["tox-anchorbar"]}}),S=function(){return i.bind((function(n){return x.getOpt(n)})).getOrDie("Could not find a anchor bar element")},C=function(){return i.bind((function(n){return Pj.getToolbar(n)})).getOrDie("Could not find more toolbar element")},k=function(){return i.bind((function(n){return Pj.getThrobber(n)})).getOrDie("Could not find throbber element")},_=XV(b,n,S),T=Pj.parts().menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:_,onEscape:function(){n.focus()}}),E=nw(n),B=Pj.parts().toolbar(m({dom:{tag:"div",classes:["tox-toolbar"]},getSink:y,backstage:_,onEscape:function(){n.focus()},type:E,lazyToolbar:C,lazyHeader:function(){return h().getOrDie("Could not find header element")}},p)),D=Pj.parts()["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},onEscape:function(){},type:E}),A=Pj.parts().socket({dom:{tag:"div",classes:["tox-edit-area"]}}),M=Pj.parts().sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),F=Pj.parts().throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:_}),I=n.getParam("statusbar",!0,"boolean"),R=I&&!e?w.some(YG(n,_.shared.providers)):w.none(),V={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[A,M]},N=Qx(n),H=Jx(n),P=Kx(n),z=function(){return N?[D]:H?[B]:[]},L=Pj.parts().header({dom:m({tag:"div",classes:["tox-editor-header"]},p),components:Z([P?[T]:[],z(),iw(n)?[]:[x.asSpec()]]),sticky:cw(n),editor:n,getSink:y}),j=Z([d?[L]:[],e?[]:[V],d?[]:[L]]),U={dom:{tag:"div",classes:["tox-editor-container"]},components:j},W=Z([[U],e?[]:R.toArray(),[F]]),G=aw(n),X=m(m({role:"application"},FS.isRtl()?{dir:"rtl"}:{}),G?{"aria-hidden":"true"}:{}),Y=ec(Pj.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(d?[]:["tox-tinymce--toolbar-bottom"]).concat(l).concat(c),styles:m({visibility:"hidden"},G?{opacity:"0",border:"0"}:{}),attributes:X},components:W,behaviours:xf([Jb.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));i=w.some(Y),n.shortcuts.add("alt+F9","focus menubar",(function(){Pj.focusMenubar(Y)})),n.shortcuts.add("alt+F10","focus toolbar",(function(){Pj.focusToolbar(Y)}));var q=F_(Y),K=F_(b);Jz.setup(n,q,K);var J=function(){var n={broadcastAll:K.broadcast,broadcastOn:K.broadcastOn,register:function(){}};return{channels:n}},$=function(){var t=aU.numToPx(sU(n)),e=aU.numToPx(lU(n));return n.inline||(Pa("div","width",e)&&Ma(Y.element(),"width",e),Pa("div","height",t)?Ma(Y.element(),"height",t):Ma(Y.element(),"height","200px")),t},Q=function(){r.setup(n,h),jU.setup(n,_),wW(n,y,_),mj(n),Bj(n,k,_.shared),pn(tw(n),(function(t,e){n.ui.registry.addGroupToolbarButton(e,t)}));var t=n.ui.registry.getAll(),e=t.buttons,i=t.menuItems,u=t.contextToolbars,a=t.sidebars,c=$x(n),s={menuItems:i,menus:n.settings.menu?pn(n.settings.menu,(function(n){return m(m({},n),{items:n.items})})):{},menubar:n.settings.menubar,toolbar:c.getOrThunk((function(){return n.getParam("toolbar",!0)})),allowToolbarGroups:E===Xh.floating,buttons:e,sidebar:a};qz.register(n,u,b,{backstage:_}),zG.setup(n,b);var f=n.getElement(),l=$(),d={mothership:q,uiMothership:K,outerContainer:Y},g={targetNode:f,height:l};return o.render(n,d,s,_,g)};return{mothership:q,uiMothership:K,backstage:_,renderUI:Q,getUi:J}},KG={setup:qG},JG=function(n,t){var e=w.from(su(n,"id")).fold((function(){var n=wu("dialog-describe");return au(t,"id",n),n}),u);au(n,"aria-describedby",e)},$G={labelledBy:function(n,t){var e=w.from(su(n,"id")).fold((function(){var n=wu("dialog-label");return au(t,"id",n),n}),u);au(n,"aria-labelledby",e)}},QG=i([ce("lazySink"),ye("dragBlockClass"),Fe("getBounds",Uc),Te("useTabstopAt",i(!0)),Te("eventOrder",{}),Ig("modalBehaviours",[Jb]),Ss("onExecute"),ks("onEscape")]),ZG={sketch:u},nX=i([gp({name:"draghandle",overrides:function(n,t){return{behaviours:xf([MG.config({mode:"mouse",getTarget:function(n){return Jc(n,'[role="dialog"]').getOr(n)},blockerClass:n.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:n.getDragBounds})])}}}),dp({schema:[ce("dom")],name:"title"}),dp({factory:ZG,schema:[ce("dom")],name:"close"}),dp({factory:ZG,schema:[ce("dom")],name:"body"}),gp({factory:ZG,schema:[ce("dom")],name:"footer"}),mp({factory:{sketch:function(n,t){return m(m({},n),{dom:t.dom,components:t.components})}},schema:[Te("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Te("components",[])],name:"blocker"})]),tX=function(n,t,e,o){var r=wu("alloy.dialog.busy"),i=wu("alloy.dialog.idle"),u=xf([Jb.config({mode:"special",onTab:function(){return w.some(!0)},onShiftTab:function(){return w.some(!0)}}),vy.config({})]),a=function(t){var e=n.lazySink(t).getOrDie(),a=He(w.none()),c=o.blocker(),s=e.getSystem().build(m(m({},c),{components:c.components.concat([oc(t)]),behaviours:xf([vy.config({}),cy("dialog-blocker-events",[xi(xr(),(function(){Jb.focusIn(t)})),li(i,(function(n,e){lu(t.element(),"aria-busy")&&(du(t.element(),"aria-busy"),a.get().each((function(n){return uy.remove(t,n)})))})),li(r,(function(n,e){au(t.element(),"aria-busy","true");var o=e.event().getBusySpec();a.get().each((function(n){uy.remove(t,n)}));var r=o(t,u),i=n.getSystem().build(r);a.set(w.some(i)),uy.append(t,oc(i)),i.hasConfigured(Jb)&&Jb.focusIn(i)}))])])}));Cm(e,s),Jb.focusIn(t)},c=function(n){Ri(n.element()).each((function(t){n.getSystem().getByDom(t).each((function(n){_m(n)}))}))},s=function(t){return Ep(t,n,"body")},f=function(t){return Ep(t,n,"footer")},l=function(n,t){ei(n,r,{getBusySpec:t})},d=function(n){ti(n,i)},g=wu("modal-events"),p=m(m({},n.eventOrder),{"alloy.system.attached":[g].concat(n.eventOrder["alloy.system.attached"]||[])});return{uid:n.uid,dom:n.dom,components:t,apis:{show:a,hide:c,getBody:s,getFooter:f,setIdle:d,setBusy:l},eventOrder:p,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Vg(n.modalBehaviours,[uy.config({}),Jb.config({mode:"cyclic",onEnter:n.onExecute,onEscape:n.onEscape,useTabstopAt:n.useTabstopAt}),cy(g,[wi((function(t){$G.labelledBy(t.element(),Ep(t,n,"title").element()),JG(t.element(),Ep(t,n,"body").element())}))])])}},eX=Yp({name:"ModalDialog",configFields:QG(),partFields:nX(),factory:tX,apis:{show:function(n,t){n.show(t)},hide:function(n,t){n.hide(t)},getBody:function(n,t){return n.getBody(t)},getFooter:function(n,t){return n.getFooter(t)},setBusy:function(n,t,e){n.setBusy(t,e)},setIdle:function(n,t){n.setIdle(t)}}}),oX=[le("type"),le("text"),de("level",["info","warn","error","success"]),le("icon"),Te("url","")],rX=Dt(oX),iX=function(n){return[le("type"),n]},uX=[le("type"),le("text"),Me("disabled",!1),Me("primary",!1),Nt("name","name",qn((function(){return wu("button-name")})),ee),Se("icon"),Me("borderless",!1)],aX=Dt(uX),cX=[le("type"),le("name"),le("label"),Me("disabled",!1)],sX=Dt(cX),fX=oe,lX=[le("type"),le("name")],dX=lX.concat([Se("label")]),mX=dX,gX=Dt(mX),pX=ee,hX=dX,vX=Dt(hX),bX=ee,yX=dX,xX=Dt(yX),wX=jt(),SX=function(n){return[le("type"),fe("columns"),n]},CX=dX.concat([Me("sandboxed",!0)]),kX=Dt(CX),OX=ee,_X=dX.concat([Se("inputMode"),Se("placeholder"),Me("maximized",!1),Me("disabled",!1)]),TX=Dt(_X),EX=ee,BX=dX.concat([ve("items",[le("text"),le("value")]),Be("size",1),Me("disabled",!1)]),DX=Dt(BX),AX=ee,MX=dX.concat([Me("constrain",!0),Me("disabled",!1)]),FX=Dt(MX),IX=Dt([le("width"),le("height")]),RX=dX.concat([Se("placeholder"),Me("maximized",!1),Me("disabled",!1)]),VX=Dt(RX),NX=ee,HX=dX.concat([Ae("filetype","file",["image","media","file"]),Te("disabled",!1)]),PX=Dt(HX),zX=Dt([le("value"),Te("meta",{})]),LX=lX.concat([De("tag","textarea"),le("scriptId"),le("scriptUrl"),Ie("settings",void 0)]),jX=lX.concat([De("tag","textarea"),ge("init")]),UX=Wt((function(n){return Yt("customeditor.old",Bt(jX),n).orThunk((function(){return Yt("customeditor.new",Bt(LX),n)}))})),WX=ee,GX=[le("type"),le("html"),Ae("presets","presentation",["presentation","document"])],XX=Dt(GX),YX=dX.concat([se("currentState",Dt([ce("blob"),le("url")]))]),qX=Dt(YX),KX=dX.concat([Te("columns","auto")]),JX=Dt(KX),$X=Lt([le("value"),le("text"),le("icon")]),QX=function(n){return[le("type"),le("label"),n]},ZX=[le("type"),be("header",ee),be("cells",At(ee))],nY=Dt(ZX),tY=function(n){return Nt("items","items",Xn(),At(Wt((function(t){return Yt("Checking item of "+n,eY,t).fold((function(n){return O.error(Jt(n))}),(function(n){return O.value(n)}))}))))},eY=Ut((function(){return $t("type",{alertbanner:rX,bar:Dt(iX(tY("bar"))),button:aX,checkbox:sX,colorinput:gX,colorpicker:vX,dropzone:xX,grid:Dt(SX(tY("grid"))),iframe:kX,input:TX,selectbox:DX,sizeinput:FX,textarea:VX,urlinput:PX,customeditor:UX,htmlpanel:XX,imagetools:qX,collection:JX,label:Dt(QX(tY("label"))),table:nY,panel:rY})})),oY=[le("type"),Te("classes",[]),be("items",eY)],rY=Dt(oY),iY=[Nt("name","name",qn((function(){return wu("tab-name")})),ee),le("title"),be("items",eY)],uY=[le("type"),ve("tabs",iY)],aY=Dt(uY),cY=Dt([le("type"),le("name")].concat(iS)),sY=oe,fY=[Nt("name","name",qn((function(){return wu("button-name")})),ee),Se("icon"),Ae("align","end",["start","end"]),Me("primary",!1),Me("disabled",!1)],lY=p(fY,[le("text")]),dY=p([de("type",["submit","cancel","custom"])],lY),mY=p([de("type",["menu"]),Se("text"),Se("tooltip"),Se("icon"),be("items",cY)],fY),gY=Qt("type",{submit:dY,cancel:dY,custom:dY,menu:mY}),pY=lY,hY=gY,vY=Dt([le("title"),se("body",$t("type",{panel:rY,tabpanel:aY})),De("size","normal"),be("buttons",hY),Te("initialData",{}),Fe("onAction",e),Fe("onChange",e),Fe("onSubmit",e),Fe("onClose",e),Fe("onCancel",e),Te("onTabChange",e)]),bY=function(n){return Yt("dialog",vY,n)},yY=function(n){return B(n)?[n].concat(nn(yn(n),yY)):D(n)?nn(n,yY):[]},xY=function(n){return E(n.type)&&E(n.name)},wY={checkbox:fX,colorinput:pX,colorpicker:bX,dropzone:wX,input:EX,iframe:OX,sizeinput:IX,selectbox:AX,size:IX,textarea:NX,urlinput:zX,customeditor:WX,collection:$X,togglemenuitem:sY},SY=function(n){return w.from(wY[n.type])},CY=function(n){return q(yY(n),xY)},kY=function(n){var t=CY(n),e=nn(t,(function(n){return SY(n).fold((function(){return[]}),(function(t){return[se(n.name,t)]}))}));return Dt(e)},OY=Dt(p([de("type",["cancel","custom"])],pY)),_Y=Dt([le("title"),le("url"),we("height"),we("width"),ke("buttons",OY),Fe("onAction",e),Fe("onCancel",e),Fe("onClose",e),Fe("onMessage",e)]),TY=function(n){return Yt("dialog",_Y,n)},EY=function(n){var t=qt(bY(n)),e=kY(n),o=n.initialData;return{internalDialog:t,dataValidator:e,initialData:o}},BY={open:function(n,t){var e=EY(t);return n(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(n,t){var e=qt(TY(t));return n(e)},redial:function(n){return EY(n)}},DY=function(){var n=He(w.none()),t=function(){n.set(w.none())},e=function(t){n.set(w.some(t))},o=function(t){n.get().each(t)},r=function(){return n.get().isSome()};return{clear:t,set:e,isSet:r,on:o}},AY=function(n){var t=[],e={};return gn(n,(function(n,o){n.fold((function(){t.push(o)}),(function(n){e[o]=n}))})),t.length>0?O.error(t):O.value(e)},MY=function(n,e){var o=dw(oA.sketch((function(t){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:W(n.items,(function(n){return ER(t,n,e)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[o.asSpec()]}],behaviours:xf([Jb.config({mode:"acyclic",useTabstopAt:c(LA.isPseudoStop)}),gA.memento(o),BA.memento(o,{postprocess:function(n){return AY(n).fold((function(n){return t.console.error(n),{}}),(function(n){return n}))}})])}},FY=function(n,t){return{uid:n.uid,dom:n.dom,components:n.components,events:Hy(n.action),behaviours:Vg(n.tabButtonBehaviours,[vy.config({}),Jb.config({mode:"execution",useSpace:!0,useEnter:!0}),Fg.config({store:{mode:"memory",initialValue:n.value}})]),domModification:n.domModification}},IY=Xp({name:"TabButton",configFields:[Te("uid",void 0),ce("value"),Nt("dom","dom",Kn((function(){return{attributes:{role:"tab",id:wu("aria"),"aria-selected":"false"}}})),Zt()),ye("action"),Te("domModification",{}),Ig("tabButtonBehaviours",[vy,Jb,Fg]),ce("view")],factory:FY}),RY=i([ce("tabs"),ce("dom"),Te("clickToDismiss",!1),Ig("tabbarBehaviours",[Sh,Jb]),ys(["tabClass","selectedClass"])]),VY=pp({factory:IY,name:"tabs",unit:"tab",overrides:function(n){var t=function(n,t){Sh.dehighlight(n,t),ei(n,Qr(),{tabbar:n,button:t})},o=function(n,t){Sh.highlight(n,t),ei(n,$r(),{tabbar:n,button:t})};return{action:function(r){var i=r.getSystem().getByUid(n.uid).getOrDie(),u=Sh.isHighlighted(i,r),a=function(){return u&&n.clickToDismiss?t:u?e:o}();a(i,r)},domModification:{classes:[n.markers.tabClass]}}}}),NY=i([VY]),HY=function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Vg(n.tabbarBehaviours,[Sh.config({highlightClass:n.markers.selectedClass,itemClass:n.markers.tabClass,onHighlight:function(n,t){au(t.element(),"aria-selected","true")},onDehighlight:function(n,t){au(t.element(),"aria-selected","false")}}),Jb.config({mode:"flow",getInitial:function(n){return Sh.getHighlighted(n).map((function(n){return n.element()}))},selector:"."+n.markers.tabClass,executeOnMove:!0})])}},PY=Yp({name:"Tabbar",configFields:RY(),partFields:NY(),factory:HY}),zY=function(n,t){return{uid:n.uid,dom:n.dom,behaviours:Vg(n.tabviewBehaviours,[uy.config({})]),domModification:{attributes:{role:"tabpanel"}}}},LY=Xp({name:"Tabview",configFields:[Ig("tabviewBehaviours",[uy])],factory:zY}),jY=i([Te("selectFirst",!0),ws("onChangeTab"),ws("onDismissTab"),Te("tabs",[]),Ig("tabSectionBehaviours",[])]),UY=dp({factory:PY,schema:[ce("dom"),he("markers",[ce("tabClass"),ce("selectedClass")])],name:"tabbar",defaults:function(n){return{tabs:n.tabs}}}),WY=dp({factory:LY,name:"tabview"}),GY=i([UY,WY]),XY=function(n,t,e,o){var r=function(t){var e=Fg.getValue(t);Tp(t,n,"tabview").each((function(o){var r=$(n.tabs,(function(n){return n.value===e}));r.each((function(e){var r=e.view();fu(t.element(),"id").each((function(n){au(o.element(),"aria-labelledby",n)})),uy.set(o,r),n.onChangeTab(o,t,r)}))}))},i=function(t,e){Tp(t,n,"tabbar").each((function(n){e(n).each(oi)}))};return{uid:n.uid,dom:n.dom,components:t,behaviours:Rg(n.tabSectionBehaviours),events:ai(Z([n.selectFirst?[wi((function(n,t){i(n,Sh.getFirst)}))]:[],[li($r(),(function(n,t){var e=t.event().button();r(e)})),li(Qr(),(function(t,e){var o=e.event().button();n.onDismissTab(t,o)}))]])),apis:{getViewItems:function(t){return Tp(t,n,"tabview").map((function(n){return uy.contents(n)})).getOr([])},showTab:function(n,t){var e=function(n){var e=Sh.getCandidates(n),o=$(e,(function(n){return Fg.getValue(n)===t}));return o.filter((function(t){return!Sh.isHighlighted(n,t)}))};i(n,e)}}}},YY=Yp({name:"TabSection",configFields:jY(),partFields:GY(),factory:XY,apis:{getViewItems:function(n,t){return n.getViewItems(t)},showTab:function(n,t,e){n.showTab(t,e)}}}),qY=function(n,t,e){return W(n,(function(o,r){uy.set(e,n[r].view());var i=t.dom().getBoundingClientRect();return uy.set(e,[]),i.height}))},KY=function(n){return cn(an(n,(function(n,t){return n>t?-1:n<t?1:0})))},JY=function(n,e,o){var r,i=Fi(n).dom(),u=Jc(n,".tox-dialog-wrap").getOr(n),a="fixed"===Ra(u,"position");r=a?Math.max(i.clientHeight,t.window.innerHeight):Math.max(i.offsetHeight,i.scrollHeight);var c=uc(e),s=e.dom().offsetLeft>=o.dom().offsetLeft+vc(o),f=s?Math.max(uc(o),c):c,l=parseInt(Ra(n,"margin-top"),10)||0,d=parseInt(Ra(n,"margin-bottom"),10)||0,m=uc(n)+l+d,g=m-f;return r-g},$Y=function(n,t){cn(n).each((function(n){return YY.showTab(t,n.value)}))},QY=function(n,t){Ma(n,"height",t+"px"),jo().browser.isIE()?za(n,"flex-basis"):Ma(n,"flex-basis",t+"px")},ZY=function(n,t,e){Jc(n,'[role="dialog"]').each((function(n){$c(n,'[role="tablist"]').each((function(o){e.get().map((function(e){return Ma(t,"height","0"),Ma(t,"flex-basis","0"),Math.min(e,JY(n,t,o))})).each((function(n){QY(t,n)}))}))}))},nq=function(n){return $c(n,'[role="tabpanel"]')},tq=function(n){var t=function(){var t=He(w.none()),e=[wi((function(e){var o=e.element();nq(o).each((function(r){Ma(r,"visibility","hidden"),e.getSystem().getByDom(r).toOption().each((function(e){var o=qY(n,r,e),i=KY(o);t.set(i)})),ZY(o,r,t),za(r,"visibility"),$Y(n,e),Ix.requestAnimationFrame((function(){ZY(o,r,t)}))}))})),li(Wr(),(function(n){var e=n.element();nq(e).each((function(n){ZY(e,n,t)}))})),li(j_,(function(n,e){var o=n.element();nq(o).each((function(n){var e=Vf();Ma(n,"visibility","hidden");var r=Na(n,"height").map((function(n){return parseInt(n,10)}));za(n,"height"),za(n,"flex-basis");var i=n.dom().getBoundingClientRect().height,u=r.forall((function(n){return i>n}));u?(t.set(w.from(i)),ZY(o,n,t)):r.each((function(t){QY(n,t)})),za(n,"visibility"),e.each(Ff)}))}))],o=!1;return{extraEvents:e,selectFirst:o}}(),e=function(){var n=[],t=!0;return{extraEvents:n,selectFirst:t}}();return{smartTabHeight:t,naiveTabHeight:e}},eq="send-data-to-section",oq="send-data-to-view",rq=function(n,t){var e=He({}),o=function(n){var t=Fg.getValue(n),o=AY(t).getOr({}),r=e.get(),i=Bn(r,o);e.set(i)},r=function(n){var t=e.get();Fg.setValue(n,t)},i=He(null),u=W(n.tabs,(function(n){return{value:n.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:t.shared.providers.translate(n.title)},view:function(){return[oA.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:W(n.items,(function(n){return ER(e,n,t)})),formBehaviours:xf([Jb.config({mode:"acyclic",useTabstopAt:c(LA.isPseudoStop)}),cy("TabView.form.events",[wi(r),Si(o)]),Df.config({channels:et([{key:eq,value:{onReceive:o}},{key:oq,value:{onReceive:r}}])})])}}))]}}})),a=tq(u).smartTabHeight;return YY.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(n,t,e){var o=Fg.getValue(t);ei(n,L_,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[YY.parts().tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[PY.parts().tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:xf([ET.config({})])}),YY.parts().tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:xf([cy("tabpanel",a.extraEvents),Jb.config({mode:"acyclic"}),eh.config({find:function(n){return cn(YY.getViewItems(n))}}),Fg.config({store:{mode:"manual",getValue:function(n){return n.getSystem().broadcastOn([eq],{}),e.get()},setValue:function(n,t){e.set(t),n.getSystem().broadcastOn([oq],{})}}})])})},iq=wu("update-dialog"),uq=wu("update-title"),aq=wu("update-body"),cq=wu("update-footer"),sq=wu("body-send-message"),fq=function(n,t,e,o){var r=function(n){switch(n.body.type){case"tabpanel":return[rq(n.body,e)];default:return[MY(n.body,e)]}},i=function(n,t){return w.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},u={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:m(m({},t.map((function(n){return{id:n}})).getOr({})),o?u:{})},components:[],behaviours:xf([gA.childAt(0),oP.config({channel:aq,updateState:i,renderComponents:r,initialData:n})])}},lq=function(n,t,e,o){return fq(n,w.some(t),e,o)},dq=function(n,t){var e=fq(n,w.none(),t,!1);return eX.parts().body(e)},mq=function(n){var t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[LA.craft({dom:{tag:"iframe",attributes:{src:n.url}},behaviours:xf([ET.config({}),vy.config({})])})]}],behaviours:xf([Jb.config({mode:"acyclic",useTabstopAt:c(LA.isPseudoStop)})])};return eX.parts().body(t)},gq=qS.deviceType.isTouch(),pq=function(n,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[n,t]}},hq=function(n,t){return eX.parts().close(lw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:n,buttonBehaviours:xf([ET.config({})])}))},vq=function(){return eX.parts().title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},bq=function(n,t){return eX.parts().body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:Oj("<p>"+t.translate(n)+"</p>")}]}]})},yq=function(n){return eX.parts().footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:n})},xq=function(n,t){return[M_.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:n}),M_.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},wq=function(n){var t,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return eX.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),w.some(!0)},useTabstopAt:function(n){return!LA.isPseudoStop(n)},dom:{tag:"div",classes:[e].concat(n.extraClasses),styles:m({position:"relative"},n.extraStyles)},components:p([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:Oj('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:gq?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:xf(p([vy.config({}),cy("dialog-events",n.dialogEvents.concat([xi(xr(),(function(n,t){Jb.focusIn(n)}))])),cy("scroll-lock",[wi((function(){xa(Ea(),i)})),Si((function(){Sa(Ea(),i)}))])],n.extraBehaviours)),eventOrder:m((t={},t[Ir()]=["dialog-events"],t[Gr()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[Xr()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),n.eventOrder)})},Sq=function(n){return lw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close"),title:n.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:'<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.953 7.453L13.422 12l4.531 4.547-1.406 1.406L12 13.422l-4.547 4.531-1.406-1.406L10.578 12 6.047 7.453l1.406-1.406L12 10.578l4.547-4.531z" fill-rule="evenodd"></path></svg>'}}],action:function(n){ti(n,V_)}})},Cq=function(n,t,e){var o=function(n){return[Za(e.translate(n.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:m({},t.map((function(n){return{id:n}})).getOr({}))},components:o(n),behaviours:xf([oP.config({channel:uq,renderComponents:o})])}},kq=function(){return{dom:Oj('<div class="tox-dialog__draghandle"></div>')}},Oq=function(n,t,e){return M_.sketch({dom:Oj('<div class="tox-dialog__header"></div>'),components:[Cq(n,w.some(t),e),kq(),Sq(e)],containerBehaviours:xf([MG.config({mode:"mouse",blockerClass:"blocker",getTarget:function(n){return Qc(n,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})},_q=function(n,t){var e=eX.parts().title(Cq(n,w.none(),t)),o=eX.parts().draghandle(kq()),r=eX.parts().close(Sq(t)),i=[e].concat(n.draggable?[o]:[]).concat([r]);return M_.sketch({dom:Oj('<div class="tox-dialog__header"></div>'),components:i})},Tq=function(n,t){return _q({title:t.shared.providers.translate(n),draggable:t.dialog.isDraggableModal()},t.shared.providers)},Eq=function(n,t){return{onClose:function(){return t.closeWindow()},onBlock:function(t){eX.setBusy(n(),(function(n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":t.message()},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:e,components:[{dom:Oj('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}))},onUnblock:function(){eX.setIdle(n())}}},Bq=function(n,t,e,o){var r,i=function(n,t){return w.some(t)};return ec(wq(m(m({},n),{lazySink:o.shared.getSink,extraBehaviours:p([oP.config({channel:iq,updateState:i,initialData:t}),BA.memory({})],n.extraBehaviours),onEscape:function(n){ti(n,V_)},dialogEvents:e,eventOrder:(r={},r[Fr()]=["reflecting","receiving"],r[Gr()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],r[Xr()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],r)})))},Dq=function(n){var t=function(n){var t=W(n.items,(function(n){var t=He(!1);return m(m({},n),{storage:t})}));return m(m({},n),{items:t})};return W(n,(function(n){return"menu"===n.type?t(n):n}))},Aq=function(n){return J(n,(function(n,t){if("menu"===t.type){var e=t;return J(e.items,(function(n,t){return n[t.name]=t.storage,n}),n)}return n}),{})},Mq=function(n,t){return[vi(xr(),LA.onFocus),n(R_,(function(n,e){t.onClose(),e.onClose()})),n(V_,(function(n,t,e,o){t.onCancel(n),ti(o,R_)})),li(z_,(function(n,e){return t.onUnblock()})),li(P_,(function(n,e){return t.onBlock(e.event())}))]},Fq=function(n,t){var e=function(t,e){return li(t,(function(t,r){o(t,(function(o,i){e(n(),o,r.event(),t)}))}))},o=function(n,t){oP.getState(n).get().each((function(e){t(e,n)}))};return p(Mq(e,t),[e(N_,(function(n,t,e){t.onAction(n,{name:e.name()})}))])},Iq=function(n,t,e){var o=function(t,e){return li(t,(function(t,o){r(t,(function(r,i){e(n(),r,o.event(),t)}))}))},r=function(n,t){oP.getState(n).get().each((function(e){t(e.internalDialog,n)}))};return p(Mq(o,t),[o(H_,(function(n,t){return t.onSubmit(n)})),o(I_,(function(n,t,e){t.onChange(n,{name:e.name()})})),o(N_,(function(n,t,o,r){var i=function(){return Jb.focusIn(r)},u=function(n){return lu(n,"disabled")||fu(n,"aria-disabled").exists((function(n){return"true"===n}))},a=Vf();t.onAction(n,{name:o.name(),value:o.value()}),Vf().fold(i,(function(n){u(n)?i():a.exists((function(t){return er(n,t)&&u(t)}))?i():e().toOption().filter((function(t){return!er(t.element(),n)})).each(i)}))})),o(L_,(function(n,t,e){t.onTabChange(n,{newTabName:e.name(),oldTabName:e.oldName()})})),Si((function(t){var e=n();Fg.setValue(t,e.getData())}))])},Rq={initUrlDialog:Fq,initDialog:Iq},Vq=function(n,t){return EF(n,n.type,t)},Nq=function(n,t,e){return $(t,(function(n){return n.name===e})).bind((function(t){return t.memento.getOpt(n)}))},Hq=function(n,t){var e=t.map((function(n){return n.footerButtons})).getOr([]),o=Y(e,(function(n){return"start"===n.align})),r=function(n,t){return M_.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+n]},components:W(t,(function(n){return n.memento.asSpec()}))})},i=r("start",o.pass),u=r("end",o.fail);return[i,u]},Pq=function(n,t){var e=function(n,e){var o=W(e.buttons,(function(n){var e=dw(Vq(n,t));return{name:n.name,align:n.align,memento:e}})),r=function(n,t){return Nq(n,o,t)};return w.some({lookupByName:r,footerButtons:o})};return{dom:Oj('<div class="tox-dialog__footer"></div>'),components:[],behaviours:xf([oP.config({channel:cq,initialData:n,updateState:e,renderComponents:Hq})])}},zq=function(n,t){return Pq(n,t)},Lq=function(n,t){return eX.parts().footer(Pq(n,t))},jq=function(n,t){var e=n.getRoot();if(e.getSystem().isConnected()){var o=eh.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return oA.getField(o,t).fold((function(){var e=n.getFooter(),r=oP.getState(e);return r.get().bind((function(n){return n.lookupByName(o,t)}))}),(function(n){return w.some(n)}))}return w.none()},Uq=function(n,t){var e=n.getRoot();return oP.getState(e).get().map((function(n){return qt(Yt("data",n.dataValidator,t))})).getOr(t)},Wq=function(n,t,e){var o=function(t){var e=n.getRoot();e.getSystem().isConnected()&&t(e)},r=function(){var t=n.getRoot(),o=t.getSystem().isConnected()?n.getFormWrapper():t,r=Fg.getValue(o),i=pn(e,(function(n){return n.get()}));return m(m({},r),i)},i=function(t){o((function(o){var r=p.getData(),i=m(m({},r),t),u=Uq(n,i),a=n.getFormWrapper();Fg.setValue(a,u),gn(e,(function(n,t){wn(i,t)&&n.set(i[t])}))}))},u=function(t){jq(n,t).each(EC.disable)},a=function(t){jq(n,t).each(EC.enable)},c=function(t){jq(n,t).each(vy.focus)},s=function(n){if(!E(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(t){ei(t,P_,{message:n})}))},f=function(){o((function(n){ti(n,z_)}))},l=function(t){o((function(e){var o=n.getBody(),r=oP.getState(o);r.get().exists((function(n){return n.isTabPanel()}))&&eh.getCurrent(o).each((function(n){YY.showTab(n,t)}))}))},d=function(n){o((function(e){var o=t(n);e.getSystem().broadcastOn([iq],o),e.getSystem().broadcastOn([uq],o.internalDialog),e.getSystem().broadcastOn([aq],o.internalDialog),e.getSystem().broadcastOn([cq],o.internalDialog),p.setData(o.initialData)}))},g=function(){o((function(n){ti(n,R_)}))},p={getData:r,setData:i,disable:u,enable:a,focus:c,block:s,unblock:f,showTab:l,redial:d,close:g};return p},Gq=function(n,t,e){var o=Tq(n.internalDialog.title,e),r=dq({body:n.internalDialog.body},e),i=Dq(n.internalDialog.buttons),u=Aq(i),a=Lq({buttons:i},e),c=Rq.initDialog((function(){return m}),Eq((function(){return l}),t),e.shared.getSink),s="normal"!==n.internalDialog.size?"large"===n.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],f={header:o,body:r,footer:w.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=Bq(f,n,c,e),d=function(){var n=function(){var n=eX.getBody(l);return eh.getCurrent(n).getOr(n)};return{getRoot:function(){return l},getBody:function(){return eX.getBody(l)},getFooter:function(){return eX.getFooter(l)},getFormWrapper:n}}(),m=Wq(d,t.redial,u);return{dialog:l,instanceApi:m}},Xq=function(n,t,e,o){var r,i,u=wu("dialog-label"),a=wu("dialog-content"),c=function(n,t){return w.some(t)},s=dw(Oq({title:n.internalDialog.title,draggable:!0},u,e.shared.providers)),f=dw(lq({body:n.internalDialog.body},a,e,o)),l=Dq(n.internalDialog.buttons),d=Aq(l),m=dw(zq({buttons:l},e)),g=Rq.initDialog((function(){return h}),{onBlock:function(){},onUnblock:function(){},onClose:function(){return t.closeWindow()}},e.shared.getSink),p=ec({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=u,r["aria-describedby"]=""+a,r)},eventOrder:(i={},i[Fr()]=[oP.name(),Df.name()],i[Ir()]=["execute-on-form"],i[Gr()]=["reflecting","execute-on-form"],i),behaviours:xf([Jb.config({mode:"cyclic",onEscape:function(n){return ti(n,R_),w.some(!0)},useTabstopAt:function(n){return!LA.isPseudoStop(n)&&("button"!==tu(n)||"disabled"!==su(n,"disabled"))}}),oP.config({channel:iq,updateState:c,initialData:n}),vy.config({}),cy("execute-on-form",g.concat([xi(xr(),(function(n,t){Jb.focusIn(n)}))])),BA.memory({})]),components:[s.asSpec(),f.asSpec(),m.asSpec()]}),h=Wq({getRoot:function(){return p},getFooter:function(){return m.get(p)},getBody:function(){return f.get(p)},getFormWrapper:function(){var n=f.get(p);return eh.getCurrent(n).getOr(n)}},t.redial,d);return{dialog:p,instanceApi:h}},Yq=tinymce.util.Tools.resolve("tinymce.util.URI"),qq=function(n){var t=function(t){n.getSystem().isConnected()&&t(n)},e=function(n){if(!E(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");t((function(t){ei(t,P_,{message:n})}))},o=function(){t((function(n){ti(n,z_)}))},r=function(){t((function(n){ti(n,R_)}))},i=function(n){t((function(t){t.getSystem().broadcastOn([sq],n)}))};return{block:e,unblock:o,close:r,sendMessage:i}},Kq=["insertContent","setContent","execCommand","close","block","unblock"],Jq=function(n){return B(n)&&-1!==Kq.indexOf(n.mceAction)},$q=function(n){return!Jq(n)&&B(n)&&wn(n,"mceAction")},Qq=function(n,t,e){switch(e.mceAction){case"insertContent":n.insertContent(e.content);break;case"setContent":n.setContent(e.content);break;case"execCommand":var o=!!A(e.ui)&&e.ui;n.execCommand(e.cmd,o,e.value);break;case"close":t.close();break;case"block":t.block(e.message);break;case"unblock":t.unblock();break}},Zq=function(n,e,o,r){var i,u=Tq(n.title,r),a=mq(n),c=n.buttons.bind((function(n){return 0===n.length?w.none():w.some(Lq({buttons:n},r))})),s=Rq.initUrlDialog((function(){return y}),Eq((function(){return b}),e)),f=m(m({},n.height.fold((function(){return{}}),(function(n){return{height:n+"px","max-height":n+"px"}}))),n.width.fold((function(){return{}}),(function(n){return{width:n+"px","max-width":n+"px"}}))),l=n.width.isNone()&&n.height.isNone()?["tox-dialog--width-lg"]:[],d=new Yq(n.url,{base_uri:new Yq(t.window.location.href)}),g=d.protocol+"://"+d.host+(d.port?":"+d.port:""),p=He(w.none()),h=[cy("messages",[wi((function(){var e=t_(We.fromDom(t.window),"message",(function(t){if(d.isSameOrigin(new Yq(t.raw().origin))){var e=t.raw().data;Jq(e)?Qq(o,y,e):$q(e)&&n.onMessage(y,e)}}));p.set(w.some(e))})),Si((function(){p.get().each((function(n){return n.unbind()}))}))]),Df.config({channels:(i={},i[sq]={onReceive:function(n,t){$c(n.element(),"iframe").each((function(n){var e=n.dom().contentWindow;e.postMessage(t,g)}))}},i)})],v={header:u,body:a,footer:c,extraClasses:l,extraBehaviours:h,extraStyles:f},b=Bq(v,n,s,r),y=qq(b);return{dialog:b,instanceApi:y}},nK=function(n){var t=n.backstage.shared,e=function(e,o){var r=function(){eX.hide(c),o()},i=dw(EF({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:w.none()},"cancel",n.backstage)),u=vq(),a=hq(r,t.providers),c=ec(wq({lazySink:function(){return t.getSink()},header:pq(u,a),body:bq(e,t.providers),footer:w.some(yq(xq([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[li(V_,r)],eventOrder:{}}));eX.show(c);var s=i.get(c);vy.focus(s)};return{open:e}},tK=function(n){var t=n.backstage.shared,e=function(e,o){var r=function(n){eX.hide(s),o(n)},i=dw(EF({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:w.none()},"submit",n.backstage)),u=EF({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:w.none()},"cancel",n.backstage),a=vq(),c=hq((function(){return r(!1)}),t.providers),s=ec(wq({lazySink:function(){return t.getSink()},header:pq(a,c),body:bq(e,t.providers),footer:w.some(yq(xq([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[li(V_,(function(){return r(!1)})),li(H_,(function(){return r(!0)}))],eventOrder:{}}));eX.show(s);var f=i.get(s);vy.focus(f)};return{open:e}},eK=function(n,t){return qt(Yt("data",t,n))},oK=function(n){return r_(n,".tox-alert-dialog")||r_(n,".tox-confirm-dialog")},rK=function(n,t,e){return t&&e?[]:[VL.config({contextual:{lazyContext:function(){return w.some(Lc(We.fromDom(n.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},iK=function(n){var t=n.backstage,e=n.editor,o=cw(e),r=ew(e),i=nK(n),u=tK(n),a=function(n,e,o){return void 0!==e&&"toolbar"===e.inline?l(n,t.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?l(n,t.shared.anchors.cursor(),o,e.ariaAttrs):f(n,o)},c=function(n,t){return s(n,t)},s=function(n,o){var r=function(n){var r=Zq(n,{closeWindow:function(){eX.hide(r.dialog),o(r.instanceApi)}},e,t);return eX.show(r.dialog),r.instanceApi};return BY.openUrl(r,n)},f=function(n,e){var o=function(n,o,r){var i=o,u={dataValidator:r,initialData:i,internalDialog:n},a=Gq(u,{redial:BY.redial,closeWindow:function(){eX.hide(a.dialog),e(a.instanceApi)}},t);return eX.show(a.dialog),a.instanceApi.setData(i),a.instanceApi};return BY.open(o,n)},l=function(n,i,u,a){var c=function(n,c,s){var f=eK(c,s),l=DY(),d={dataValidator:s,initialData:f,internalDialog:n},g=function(){return l.on((function(n){Sx.reposition(n),VL.refresh(n)}))},h=Xq(d,{redial:BY.redial,closeWindow:function(){l.on(Sx.hide),e.off("ResizeEditor",g),l.clear(),u(h.instanceApi)}},t,a),v=ec(Sx.sketch(m(m({lazySink:t.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},r?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:xf(p([cy("window-manager-inline-events",[li(Yr(),(function(n,t){ti(h.dialog,V_)}))])],rK(e,o,r))),isExtraPart:function(n,t){return oK(t)}})));return l.set(v),Sx.showWithin(v,i,oc(h.dialog),w.some(Ea())),o&&r||(VL.refresh(v),e.on("ResizeEditor",g)),h.instanceApi.setData(f),Jb.focusIn(h.dialog),h.instanceApi};return BY.open(c,n)},d=function(n,t){u.open(n,(function(n){t(n)}))},g=function(n,t){i.open(n,(function(){t()}))},h=function(n){n.close()};return{open:a,openUrl:c,alert:g,close:h,confirm:d}},uK={setup:iK};function aK(){d.add("silver",(function(n){var t=KG.setup(n),e=t.uiMothership,o=t.backstage,r=t.renderUI,u=t.getUi;ZO.register(n,o.shared);var a=uK.setup({editor:n,backstage:o});return{renderUI:r,getWindowManagerImpl:i(a),getNotificationManagerImpl:function(){return xw(n,{backstage:o},e)},ui:u()}}))}aK()})(window)}).call(this,e("c8ba"))}}]);