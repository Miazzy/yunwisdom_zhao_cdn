(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ff0db68","chunk-49c8759a","chunk-461ffdf2","chunk-684e7f7a","chunk-6ff0db68"],{"0036":function(e,t,a){},1037:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("result",{attrs:{isSuccess:!0,content:!1,title:e.email}},[a("template",{slot:"action"},[a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{size:"large"},on:{click:e.goHomeHandle}},[e._v("返回首页")])],1)],2)},r=[],o=a("9a3d"),i={name:"RegisterResult",components:{Result:o["default"]},data:function(){return{form:{}}},computed:{email:function(){var e=this.form?this.form.username||this.form.mobile:" XXX ",t="你的账户：".concat(e," 注册成功");return this.username=e,t}},created:function(){this.form=this.$route.params},methods:{goHomeHandle:function(){var e={};e.username=this.form.username,e.password=this.form.password,console.log(e),this.$router.push({name:"login",params:e})}}},n=i,l=a("2877"),c=Object(l["a"])(n,s,r,!1,null,"3a0e8d1e",null);t["default"]=c.exports},1348:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"main user-layout-register"},[t._m(0),s("a-form",{ref:"formRegister",attrs:{autoFormCreate:function(t){e.form=t},id:"formRegister"}},[s("a-form-item",{attrs:{fieldDecoratorId:"username",fieldDecoratorOptions:{rules:[{required:!0,message:"用户名不能为空"},{validator:this.checkUsername}],validateTrigger:["change","blur"]}}},[s("a-input",{attrs:{size:"large",type:"text",autocomplete:"false",placeholder:"请输入用户名"}})],1),s("a-popover",{attrs:{placement:"rightTop",trigger:"click",visible:t.state.passwordLevelChecked}},[s("template",{slot:"content"},[s("div",{style:{width:"240px"}},[s("div",{class:["user-register",t.passwordLevelClass]},[t._v("强度："),s("span",[t._v(t._s(t.passwordLevelName))])]),s("a-progress",{attrs:{percent:t.state.percent,showInfo:!1,strokeColor:t.passwordLevelColor}}),s("div",{staticStyle:{"margin-top":"10px"}},[s("span",[t._v("请至少输入 8 个字符。请不要使用容易被猜到的密码。")])])],1)]),s("a-form-item",{attrs:{fieldDecoratorId:"password",fieldDecoratorOptions:{rules:[{required:!1},{validator:this.handlePasswordLevel}],validateTrigger:["change","blur"]}}},[s("a-input",{attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"至少8位密码，区分大小写"},on:{click:t.handlePasswordInputClick}})],1)],2),s("a-form-item",{attrs:{fieldDecoratorId:"password2",fieldDecoratorOptions:{rules:[{required:!0,message:"至少8位密码，区分大小写"},{validator:this.handlePasswordCheck}],validateTrigger:["change","blur"]}}},[s("a-input",{attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"确认密码"}})],1),s("a-form-item",{attrs:{fieldDecoratorId:"email",fieldDecoratorOptions:{rules:[{required:!0,type:"email",message:"请输入正确的邮箱地址"},{validator:this.handleEmailCheck}],validateTrigger:["change","blur"]}}},[s("a-input",{attrs:{size:"large",type:"text",placeholder:"邮箱"}})],1),s("a-form-item",{attrs:{fieldDecoratorId:"mobile",fieldDecoratorOptions:{rules:[{required:!0,pattern:/^1[3456789]\d{9}$/,message:"请输入正确的手机号"},{validator:this.handlePhoneCheck}],validateTrigger:["change","blur"]}}},[s("a-input",{attrs:{size:"large",placeholder:"11 位手机号"}},[s("a-select",{attrs:{slot:"addonBefore",size:"large",defaultValue:"+86"},slot:"addonBefore"},[s("a-select-option",{attrs:{value:"+86"}},[t._v("+86")]),s("a-select-option",{attrs:{value:"+87"}},[t._v("+87")])],1)],1)],1),s("a-row",{attrs:{gutter:16}},[s("a-col",{staticClass:"gutter-row",attrs:{span:16}},[s("a-form-item",{attrs:{fieldDecoratorId:"captcha",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入验证码"}],validateTrigger:"blur"}}},[s("a-input",{attrs:{size:"large",type:"text",placeholder:"验证码"}},[s("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1)],1),s("a-col",{staticClass:"gutter-row",attrs:{span:8}},[s("a-button",{staticClass:"getCaptcha",attrs:{size:"large",disabled:t.state.smsSendBtn},domProps:{textContent:t._s(t.state.smsSendBtn?t.state.time+" s":"获取验证码")},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.getCaptcha(e)}}})],1)],1),s("a-form-item",[s("a-button",{staticClass:"register-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:t.registerBtn,disabled:t.registerBtn},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit(e)}}},[t._v("注册\n      ")]),s("router-link",{staticClass:"login",attrs:{to:{name:"login"}}},[t._v("使用已有账户登录")])],1)],1)],1)},r=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("h3",[a("span",[e._v("注册")])])}],o=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),i=a("ac0d"),n=(a("7ded"),a("0fea")),l=a("4ec3");function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={0:"低",1:"低",2:"中",3:"强"},p={0:"error",1:"error",2:"warning",3:"success"},m={0:"#ff0000",1:"#ff0000",2:"#ff7e05",3:"#52c41a"},f={name:"Register",components:{},mixins:[i["b"]],data:function(){return{form:null,state:{time:60,smsSendBtn:!1,passwordLevel:0,passwordLevelChecked:!1,percent:10,progressColor:"#FF0000"},registerBtn:!1}},computed:{passwordLevelClass:function(){return p[this.state.passwordLevel]},passwordLevelName:function(){return d[this.state.passwordLevel]},passwordLevelColor:function(){return m[this.state.passwordLevel]}},methods:{checkUsername:function(e,t,a){var s={username:t};Object(l["h"])(s).then((function(e){e.success?a():a("用户名已存在!")}))},handleEmailCheck:function(e,t,a){var s={email:t};Object(l["h"])(s).then((function(e){e.success?a():a("邮箱已存在!")}))},handlePasswordLevel:function(e,t,a){var s=0,r=/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[~!@#$%^&*()_+`\-={}:";'<>?,./]).{8,}$/;r.test(t)||a(new Error("密码由8位数字、大小写字母和特殊符号组成!")),/[0-9]/.test(t)&&s++,/[a-zA-Z]/.test(t)&&s++,/[^0-9a-zA-Z_]/.test(t)&&s++,this.state.passwordLevel=s,this.state.percent=30*s,s>=2?(s>=3&&(this.state.percent=100),a()):(0===s&&(this.state.percent=10),a(new Error("密码强度不够")))},handlePasswordCheck:function(e,t,a){var s=this.form.getFieldValue("password");void 0===t&&a(new Error("请输入密码")),t&&s&&t.trim()!==s.trim()&&a(new Error("两次密码不一致")),a()},handlePhoneCheck:function(e,t,a){var s={phone:t};Object(l["h"])(s).then((function(e){e.success?a():a("手机号已存在!")}))},handlePasswordInputClick:function(){this.isMobile()?this.state.passwordLevelChecked=!1:this.state.passwordLevelChecked=!0},handleSubmit:function(){var e=this;this.form.validateFields((function(t,a){if(!t){var s={username:a.username,password:a.password,email:a.email,phone:a.mobile,smscode:a.captcha};Object(n["postAction"])("/sys/user/register",s).then((function(t){t.success?e.$router.push({name:"registerResult",params:u({},a)}):e.registerFailed(t.message)}))}}))},getCaptcha:function(e){var t=this;e.preventDefault();var a=this;this.form.validateFields(["mobile"],{force:!0},(function(e,s){if(!e){t.state.smsSendBtn=!0;var r=window.setInterval((function(){a.state.time--<=0&&(a.state.time=60,a.state.smsSendBtn=!1,window.clearInterval(r))}),1e3),o=t.$message.loading("验证码发送中..",0),i={mobile:s.mobile,smsmode:"1"};Object(n["postAction"])("/sys/sms",i).then((function(e){e.success||(t.registerFailed(e.message),setTimeout(o,0)),setTimeout(o,500)})).catch((function(e){setTimeout(o,1),clearInterval(r),a.state.time=60,a.state.smsSendBtn=!1,t.requestFailed(e)}))}}))},registerFailed:function(e){this.$notification["error"]({message:"注册失败",description:e,duration:2})},requestFailed:function(e){this.$notification["error"]({message:"错误",description:((e.response||{}).data||{}).message||"请求出现错误，请稍后再试",duration:4}),this.registerBtn=!1}},watch:{"state.passwordLevel":function(e){console.log(e)}}},h=f,v=(a("5d18"),a("797b"),a("2877")),g=Object(v["a"])(h,s,r,!1,null,"45defe74",null);t["default"]=g.exports},"3e3e":function(e,t,a){},5110:function(e,t,a){"use strict";var s=a("fb74"),r=a.n(s);r.a},"5d18":function(e,t,a){"use strict";var s=a("e236"),r=a.n(s);r.a},"71c6":function(e,t,a){"use strict";var s=a("0036"),r=a.n(s);r.a},"73d4":function(e,t,a){},"797b":function(e,t,a){"use strict";var s=a("a3ca"),r=a.n(s);r.a},"8e46":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-form",{staticStyle:{margin:"40px auto 0"}},[a("result",{attrs:{title:"更改密码成功","is-success":!0}},[a("div",{staticClass:"toLogin"},[a("h3",[e._v("将在"),a("span",[e._v(e._s(e.time))]),e._v("秒后返回登录页面.")])])])],1)],1)},r=[],o=a("9a3d"),i={name:"Step4",props:["userList"],components:{Result:o["default"]},data:function(){return{loading:!1,time:0}},methods:{countDown:function(){var e=this;e.time--}},mounted:function(){var e=this;e.time=5,setInterval(e.countDown,1e3)},watch:{time:function(e,t){if(0==e){var a={username:this.userList.username};this.$router.push({name:"login",params:a})}}}},n=i,l=(a("e11d"),a("2877")),c=Object(l["a"])(n,s,r,!1,null,"02373d6c",null);t["default"]=c.exports},a001:function(e,t,a){"use strict";var s=a("a472"),r=a.n(s);r.a},a317:function(e,t,a){},a3ca:function(e,t,a){},a472:function(e,t,a){},aa95:function(e,t,a){"use strict";var s=a("a317"),r=a.n(s);r.a},ac2a:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("a-form",{ref:"formLogin",staticClass:"user-layout-login",attrs:{form:e.form,id:"formLogin"}},[a("a-tabs",{attrs:{activeKey:e.customActiveKey,tabBarStyle:{textAlign:"center",borderBottom:"unset"}},on:{change:e.handleTabClick}},[a("a-tab-pane",{key:"tab1",attrs:{tab:"账号密码登陆"}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",e.validatorRules.username,{validator:this.handleUsernameOrEmail}],expression:"[\n              'username',\n              validatorRules.username,\n              {validator: this.handleUsernameOrEmail},\n            ]"}],attrs:{size:"large",type:"text",placeholder:"请输入帐户名"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",e.validatorRules.password],expression:"['password', validatorRules.password]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"密码"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),a("a-row",{attrs:{gutter:0}},[a("a-col",{attrs:{span:14}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["inputCode",e.validatorRules.inputCode],expression:"['inputCode', validatorRules.inputCode]"}],attrs:{size:"large",type:"text",placeholder:"请输入验证码"},on:{change:e.inputCodeChange}},[e.inputCodeContent==e.verifiedCode?a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"smile"},slot:"prefix"}):a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"frown"},slot:"prefix"})],1)],1)],1),a("a-col",{attrs:{span:10}},[a("j-graphic-code",{staticStyle:{float:"right"},on:{success:e.generateCode}})],1)],1)],1),a("a-tab-pane",{key:"tab2",attrs:{tab:"手机号登陆"}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["mobile",e.validatorRules.mobile],expression:"['mobile', validatorRules.mobile]"}],attrs:{size:"large",type:"text",placeholder:"手机号"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mobile"},slot:"prefix"})],1)],1),a("a-row",{attrs:{gutter:16}},[a("a-col",{staticClass:"gutter-row",attrs:{span:16}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["captcha",e.validatorRules.captcha],expression:"['captcha', validatorRules.captcha]"}],attrs:{size:"large",type:"text",placeholder:"请输入验证码"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1)],1),a("a-col",{staticClass:"gutter-row",attrs:{span:8}},[a("a-button",{staticClass:"getCaptcha",attrs:{tabindex:"-1",disabled:e.state.smsSendBtn},domProps:{textContent:e._s(e.state.smsSendBtn?e.state.time+" s":"获取验证码")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.getCaptcha(t)}}})],1)],1)],1)],1),a("a-form-item",[a("a-checkbox",{staticStyle:{color:"black"},model:{value:e.formLogin.rememberMe,callback:function(t){e.$set(e.formLogin,"rememberMe",t)},expression:"formLogin.rememberMe"}},[e._v("记住密码")]),a("a-checkbox",{staticStyle:{color:"black"},model:{value:e.formLogin.autoLogin,callback:function(t){e.$set(e.formLogin,"autoLogin",t)},expression:"formLogin.autoLogin"}},[e._v("自动登陆")]),a("router-link",{staticClass:"forge-password",staticStyle:{float:"right"},attrs:{to:{name:"alteration"}}},[e._v("忘记密码")])],1),a("a-form-item",{staticStyle:{"margin-top":"24px"}},[a("a-button",{staticClass:"login-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:e.loginBtn,disabled:e.loginBtn},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(t)}}},[e._v("确定")])],1),a("div",{staticClass:"user-login-other"},[a("span",[e._v("其他登陆方式")]),a("a",[a("a-icon",{staticClass:"item-icon",attrs:{type:"alipay-circle"}})],1),a("a",[a("a-icon",{staticClass:"item-icon",attrs:{type:"taobao-circle"}})],1),a("a",[a("a-icon",{staticClass:"item-icon",attrs:{type:"weibo-circle"}})],1),a("a",[a("a-icon",{staticClass:"item-icon",attrs:{type:"wechat"}})],1),a("router-link",{staticClass:"register",attrs:{to:{name:"register"}}},[e._v("注册账户")])],1)],1),e.requiredTwoStepCaptcha?a("two-step-captcha",{attrs:{visible:e.stepCaptchaVisible},on:{success:e.stepCaptchaSuccess,cancel:e.stepCaptchaCancel}}):e._e(),a("a-modal",{attrs:{title:"登录部门选择",width:450,visible:e.departVisible,closable:!1,maskClosable:!1}},[a("template",{slot:"footer"},[a("a-button",{attrs:{type:"primary"},on:{click:e.departOk}},[e._v("确认")])],1),a("a-form",[a("a-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{labelCol:{span:4},wrapperCol:{span:20},"validate-status":e.validate_status}},[a("a-tooltip",{attrs:{placement:"topLeft"}},[a("template",{slot:"title"},[a("span",[e._v("您隶属于多部门，请选择登录部门")])]),a("a-avatar",{staticStyle:{backgroundColor:"#87d068"},attrs:{icon:"gold"}})],2),a("a-select",{class:{"valid-error":"error"==e.validate_status},staticStyle:{"margin-left":"10px",width:"80%"},attrs:{placeholder:"请选择登录部门"},on:{change:e.departChange}},[a("a-icon",{attrs:{slot:"suffixIcon",type:"gold"},slot:"suffixIcon"}),e._l(e.departList,(function(t){return a("a-select-option",{key:t.id,attrs:{value:t.orgCode}},[e._v(e._s(t.departName))])}))],2)],1)],1)],2)],1)},r=[],o=(a("8e6e"),a("ac6a"),a("456d"),a("3b2b"),a("6762"),a("2fdb"),a("bd86")),i=(a("365c"),a("2ca2")),n=a("5880"),l=a("ca00"),c=a("9fb0"),u=a("4201"),d=a("0fea"),p=a("9da4"),m=a("4360"),f=a("5d2d"),h=a("49b0");function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function g(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}Vue.use(h["a"]);var b={components:{TwoStepCaptcha:i["default"],JGraphicCode:u["default"]},data:function(){return{customActiveKey:"tab1",loginBtn:!1,loginType:0,requiredTwoStepCaptcha:!1,stepCaptchaVisible:!1,form:this.$form.createForm(this),encryptedString:{key:"",iv:""},state:{time:60,smsSendBtn:!1},formLogin:{username:"",password:"",captcha:"",mobile:"",rememberMe:!1,autoLogin:!1},validatorRules:{username:{rules:[{required:!0,message:"请输入用户名!",validator:"click"}]},password:{rules:[{required:!0,message:"请输入密码!",validator:"click"}]},mobile:{rules:[{validator:this.validateMobile}]},captcha:{rule:[{required:!0,message:"请输入验证码!"}]},inputCode:{rules:[{required:!0,message:"请输入验证码!"},{validator:this.validateInputCode}]}},verifiedCode:"",inputCodeContent:"",inputCodeNull:!0,departList:[],departVisible:!1,departSelected:"",currentUsername:"",validate_status:""}},created:function(){var e=this;Vue.ls.remove(c["a"]),this.getRouterData(),setTimeout((function(){try{var t=Object(f["e"])("__LOGIN_ACCOUNT__");"undefined"==typeof t||null==t||""==t?(e.formLogin.autoLogin=!1,e.formLogin.rememberMe=!1):(t=e.decodeAES(e.decodeAES(t)),t=e.decodeDES(e.decodeDES(t)),t=window.atob(window.atob(window.atob(t))),t=JSON.parse(t),e.formLogin.autoLogin=t.auto_login,e.formLogin.rememberMe=t.remember_me,1==t.remember_me&&(e.form.setFieldsValue({username:t.username}),e.form.setFieldsValue({password:t.password}),e.form.setFieldsValue({inputCode:e.verifiedCode})),1==t.auto_login&&setTimeout((function(){1==e.formLogin.autoLogin&&e.handleSubmit()}),1500))}catch(a){console.log("获取用户信息异常："+a)}}),1e3)},methods:g({},Object(n["mapActions"])(["Login","Logout","PhoneLogin"]),{handleUsernameOrEmail:function(e,t,a){var s=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;s.test(t)?this.loginType=0:this.loginType=1,a()},handleTabClick:function(e){this.customActiveKey=e},handleSubmit:function(){var e=this,t=this,a={remember_me:t.formLogin.rememberMe,auto_login:t.formLogin.autoLogin};t.loginBtn=!0,"tab1"===t.customActiveKey?t.form.validateFields(["username","password","inputCode"],{force:!0},(function(s,r){if(s)t.loginBtn=!1;else{if(a.username=r.username,a.password=r.password,1==a.remember_me){var o=JSON.stringify(a);o=window.btoa(window.btoa(window.btoa(o))),o=e.encodeDES(e.encodeDES(o)),o=e.encodeAES(e.encodeAES(o)),Object(f["g"])("__LOGIN_ACCOUNT__",o,31536e6)}else Object(f["c"])("__LOGIN_ACCOUNT__");t.Login(a).then((function(t){try{Object(f["g"])("cur_user",t["result"]["userInfo"],31536e6),e.departConfirm(t)}catch(s){console.log(s)}})).catch((function(e){t.requestFailed(e)}))}})):t.form.validateFields(["mobile","captcha"],{force:!0},(function(s,r){s||(a.mobile=r.mobile,a.captcha=r.captcha,t.PhoneLogin(a).then((function(t){console.log(t.result),e.departConfirm(t)})).catch((function(e){t.requestFailed(e)})))}))},getCaptcha:function(e){var t=this;e.preventDefault();var a=this;this.form.validateFields(["mobile"],{force:!0},(function(e,s){if(s.mobile){if(!e){t.state.smsSendBtn=!0;var r=window.setInterval((function(){a.state.time--<=0&&(a.state.time=60,a.state.smsSendBtn=!1,window.clearInterval(r))}),1e3),o=t.$message.loading("验证码发送中..",0),i={};i.mobile=s.mobile,i.smsmode="0",Object(d["postAction"])("".concat(window._CONFIG["domain"],"/sys/sms"),i).then((function(e){e.success||(setTimeout(o,0),t.cmsFailed(e.message)),console.log(e),setTimeout(o,500)})).catch((function(e){setTimeout(o,1),clearInterval(r),a.state.time=60,a.state.smsSendBtn=!1,t.requestFailed(e)}))}}else a.cmsFailed("请输入手机号")}))},stepCaptchaSuccess:function(){this.loginSuccess()},stepCaptchaCancel:function(){var e=this;this.Logout().then((function(){e.loginBtn=!1,e.stepCaptchaVisible=!1}))},loginSuccess:function(){var e=this;this.$router.push({name:"dashboard"}),this.$notification.success({message:"欢迎",description:"".concat(Object(l["r"])(),"，欢迎回来")}),setTimeout((function(){var e=window.location.href,t=window.location.host;try{e=e.substring(e.indexOf(t)+t.length),(e.includes("/user/login")||"/user/login"==e)&&location.reload()}catch(a){console.log("query url :"+a)}}),3e3),setTimeout((function(){try{e.$router.push("/dashboard/analysis")}catch(t){console.log("$router go to error :"+t)}}),1e3),setTimeout((function(){try{e.$router.push("/account/center")}catch(t){console.log("$router go to error :"+t)}}),1e3),setTimeout((function(){try{e.$router.push("/dashboard/workplace")}catch(t){console.log("$router go to error :"+t)}}),1e3)},cmsFailed:function(e){this.$notification["error"]({message:"登录失败",description:e,duration:4})},requestFailed:function(e){this.$notification["error"]({message:"登录失败",description:((e.response||{}).data||{}).message||e.message||"请求出现错误，请稍后再试",duration:4}),this.loginBtn=!1},validateMobile:function(e,t,a){!t||new RegExp(/^1([38][0-9]|4[579]|5[0-3,5-9]|6[6]|7[0135678]|9[89])\d{8}$/).test(t)?a():a("您的手机号码格式不正确!")},validateInputCode:function(e,t,a){t&&this.verifiedCode!=this.inputCodeContent&&this.verifiedCode!=t?a("您输入的验证码不正确!"):a()},generateCode:function(e){this.verifiedCode=e.toLowerCase()},inputCodeChange:function(e){this.inputCodeContent=e.target.value,e.target.value&&0!=e.target.value?(this.inputCodeContent=this.inputCodeContent.toLowerCase(),this.inputCodeNull=!1):this.inputCodeNull=!0},departConfirm:function(e){if(e.success){var t=e.result.multi_depart;0==t?(this.loginSuccess(),this.$notification.warn({message:"提示",description:"您尚未归属部门,请确认账号信息",duration:3})):2==t?(this.departVisible=!0,this.currentUsername=this.form.getFieldValue("username"),this.departList=e.result.departs):this.loginSuccess()}else this.requestFailed(e),this.Logout()},departOk:function(){var e=this;if(!this.departSelected)return this.validate_status="error",!1;var t={orgCode:this.departSelected,username:this.form.getFieldValue("username")};Object(d["putAction"])("".concat(window._CONFIG["domain"],"/sys/selectDepart"),t).then((function(t){if(t.success){var a=t.result.userInfo;Vue.ls.set(c["o"],a,6048e5),m["a"].commit("SET_INFO",a),e.departClear(),e.loginSuccess()}else e.requestFailed(t),e.Logout().then((function(){e.departClear()}))}))},departClear:function(){this.departList=[],this.departSelected="",this.currentUsername="",this.departVisible=!1,this.validate_status=""},departChange:function(e){this.validate_status="success",this.departSelected=e},getRouterData:function(){var e=this;this.$nextTick((function(){e.form.setFieldsValue({username:e.$route.params.username})}))},getEncrypte:function(){var e=this,t=Vue.ls.get(c["k"]);null==t?Object(p["a"])().then((function(t){e.encryptedString=t})):this.encryptedString=t}})},C=b,w=(a("5110"),a("aa95"),a("2877")),y=Object(w["a"])(C,s,r,!1,null,"2862de4c",null);t["default"]=y.exports},ba6d:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-form",{staticStyle:{"max-width":"500px",margin:"40px auto 0"},attrs:{form:e.form},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.nextStep(t)}}},[a("a-form-item",{attrs:{label:"账号名",labelCol:{span:5},wrapperCol:{span:19}}},[a("a-input",{style:{width:"310px"},attrs:{type:"text",autocomplete:"false",value:e.accountName,disabled:""}})],1),a("a-form-item",{attrs:{label:"手机",labelCol:{span:5},wrapperCol:{span:19}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["phone",{initialValue:e.defaultPhone,rules:e.validatorRules.phone.rule}],expression:"['phone',{initialValue: defaultPhone, rules: validatorRules.phone.rule}]"}],style:{width:"310px"},attrs:{type:"text",autocomplete:"false",placeholder:"请输入手机号"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"phone"},slot:"prefix"})],1)],1),e.show?a("a-form-item",{attrs:{label:"验证码",labelCol:{span:5},wrapperCol:{span:19}}},[a("a-row",{staticStyle:{"margin-left":"2px"},attrs:{gutter:16}},[a("a-col",{staticClass:"gutter-row",attrs:{span:12}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["captcha",e.validatorRules.captcha],expression:"['captcha',validatorRules.captcha]"}],attrs:{type:"text",placeholder:"手机短信验证码"}})],1),a("a-col",{staticClass:"gutter-row",attrs:{span:8}},[a("a-button",{attrs:{tabindex:"-1",size:"default",disabled:e.state.smsSendBtn},domProps:{textContent:e._s(e.state.smsSendBtn?e.state.time+" s":"获取验证码")},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.getCaptcha(t)}}})],1)],1)],1):e._e(),a("a-form-item",{attrs:{wrapperCol:{span:19,offset:5}}},[a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.prevStep}},[e._v("上一步")]),a("a-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")])],1)],1)],1)},r=[],o=a("0fea"),i={name:"Step2",props:["userList"],data:function(){return{form:this.$form.createForm(this),loading:!1,accountName:this.userList.username,dropList:"0",captcha:"",show:!0,state:{time:60,smsSendBtn:!1},formLogin:{captcha:"",mobile:""},validatorRules:{captcha:{rule:[{required:!0,message:"请输入短信验证码!"},{validator:this.validateCaptcha}]},phone:{rule:[{required:!0,message:"请输入手机号码!"}]}}}},computed:{defaultPhone:function(){return this.userList.isPhone?this.userList.phone:null}},methods:{nextStep:function(){var e=this,t=this;t.loading=!0,this.form.validateFields((function(a,s){if(console.log(s),!a&&"0"==t.dropList)if(void 0==s.captcha)e.cmsFailed("请输入短信验证码!");else{var r={};r.phone=e.userList.phone,r.smscode=s.captcha,Object(o["postAction"])("/sys/user/phoneVerification",r).then((function(a){if(a.success){console.log(a);var s={username:e.userList.username,phone:e.userList.phone,smscode:a.result};setTimeout((function(){t.$emit("nextStep",s)}),0)}else e.cmsFailed(a.message)}))}}))},prevStep:function(){this.$emit("prevStep",this.userList)},getCaptcha:function(e){var t=this;e.preventDefault();var a=this;this.state.smsSendBtn=!0;var s=window.setInterval((function(){a.state.time--<=0&&(a.state.time=60,a.state.smsSendBtn=!1,window.clearInterval(s))}),1e3),r=this.$message.loading("验证码发送中..",0),i={mobile:this.userList.phone,smsmode:"2"};Object(o["postAction"])("/sys/sms",i).then((function(e){e.success||(setTimeout(r,1),t.cmsFailed(e.message)),setTimeout(r,500)}))},cmsFailed:function(e){this.$notification["error"]({message:"验证错误",description:e,duration:4})},handleChangeSelect:function(e){var t=this;console.log(e),0==e?(t.dropList="0",t.show=!0):(t.dropList="1",t.show=!1)}}},n=i,l=(a("f28b"),a("2877")),c=Object(l["a"])(n,s,r,!1,null,"0d38e0f0",null);t["default"]=c.exports},e11d:function(e,t,a){"use strict";var s=a("3e3e"),r=a.n(s);r.a},e236:function(e,t,a){},f14a:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("a-form",{staticStyle:{"max-width":"500px",margin:"40px auto 0"},attrs:{form:e.form},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.nextStep(t)}}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",e.validatorRules.username],expression:"['username',validatorRules.username]"}],attrs:{size:"large",type:"text",autocomplete:"false",placeholder:"请输入用户账号或手机号"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),a("a-row",{attrs:{gutter:0}},[a("a-col",{attrs:{span:14}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["inputCode",e.validatorRules.inputCode],expression:"['inputCode',validatorRules.inputCode]"}],attrs:{size:"large",type:"text",placeholder:"请输入验证码"},on:{change:e.inputCodeChange}},[e.inputCodeContent==e.verifiedCode?a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"smile"},slot:"prefix"}):a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"frown"},slot:"prefix"})],1)],1)],1),a("a-col",{attrs:{span:10}},[a("j-graphic-code",{staticStyle:{float:"right"},on:{success:e.generateCode}})],1)],1),a("a-form-item",{attrs:{wrapperCol:{span:19,offset:5}}},[a("router-link",{staticStyle:{float:"left","line-height":"40px"},attrs:{to:{name:"login"}}},[e._v("使用已有账户登录")]),a("a-button",{attrs:{type:"primary"},on:{click:e.nextStep}},[e._v("下一步")])],1)],1)],1)},r=[],o=a("4201"),i=a("0fea"),n=a("4ec3"),l={name:"Step1",components:{JGraphicCode:o["default"]},data:function(){return{form:this.$form.createForm(this),inputCodeContent:"",inputCodeNull:!0,verifiedCode:"",validatorRules:{username:{rules:[{required:!1},{validator:this.validateInputUsername}]},inputCode:{rules:[{required:!0,message:"请输入验证码!"},{validator:this.validateInputCode}]}}}},methods:{nextStep:function(){var e=this;this.form.validateFields((function(t,a){if(!t){var s=!1,r={},o=/^[1-9]\d*$|^0$/,n=a.username;1==o.test(n)?(r.phone=n,s=!0):r.username=n,Object(i["getAction"])("/sys/user/querySysUser",r).then((function(t){if(t.success){var a={username:t.result.username,phone:t.result.phone,isPhone:s};setTimeout((function(){e.$emit("nextStep",a)}))}}))}}))},validateInputCode:function(e,t,a){t&&this.verifiedCode!=this.inputCodeContent?a(new Error("您输入的验证码不正确!")):a()},inputCodeChange:function(e){this.inputCodeContent=e.target.value,console.log(this.inputCodeContent),e.target.value&&0!=e.target.value?(this.inputCodeContent=this.inputCodeContent.toLowerCase(),this.inputCodeNull=!1):this.inputCodeNull=!0},generateCode:function(e){this.verifiedCode=e.toLowerCase(),console.log(this.verifiedCode)},validateInputUsername:function(e,t,a){console.log(t);var s=/^[0-9]+.?[0-9]*/;if(t||a("请输入用户名和手机号！"),s.test(t)){var r={phone:t};Object(n["h"])(r).then((function(e){e.success?a("用户名不存在!"):a()}))}else{r={username:t};Object(n["h"])(r).then((function(e){e.success?a("用户名不存在!"):a()}))}}}},c=l,u=a("2877"),d=Object(u["a"])(c,s,r,!1,null,"912d82e8",null);t["default"]=d.exports},f28b:function(e,t,a){"use strict";var s=a("73d4"),r=a.n(s);r.a},f6d9:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-form",{staticStyle:{"max-width":"500px",margin:"40px auto 0"},attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"账号名",labelCol:{span:5},wrapperCol:{span:19}}},[a("a-input",{attrs:{type:"text",autocomplete:"false",value:e.accountName,disabled:""}})],1),a("a-form-item",{staticClass:"stepFormText",attrs:{label:"新密码",labelCol:{span:5},wrapperCol:{span:19}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",e.validatorRules.password],expression:"['password',validatorRules.password]"}],attrs:{type:"password",autocomplete:"false"}})],1),a("a-form-item",{staticClass:"stepFormText",attrs:{label:"确认密码",labelCol:{span:5},wrapperCol:{span:19}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["confirmPassword",e.validatorRules.confirmPassword],expression:"['confirmPassword',validatorRules.confirmPassword]"}],attrs:{type:"password",autocomplete:"false"}})],1),a("a-form-item",{attrs:{wrapperCol:{span:19,offset:5}}},[a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.prevStep}},[e._v("上一步")]),a("a-button",{staticStyle:{"margin-left":"20px"},attrs:{loading:e.loading,type:"primary"},on:{click:e.nextStep}},[e._v("提交")])],1)],1)],1)},r=[],o=a("0fea"),i={name:"Step3",props:["userList"],data:function(){return{loading:!1,form:this.$form.createForm(this),accountName:this.userList.username,validatorRules:{username:{rules:[{required:!0,message:"用户名不能为空!"}]},password:{rules:[{required:!0,pattern:/^(?=.*[a-zA-Z])(?=.*\d)(?=.*[~!@#$%^&*()_+`\-={}:";'<>?,.\/]).{8,}$/,message:"密码由8位数字、大小写字母和特殊符号组成!!"},{validator:this.handlePasswordLevel}]},confirmPassword:{rules:[{required:!0,message:"密码不能为空!"},{validator:this.handlePasswordCheck}]}}}},methods:{nextStep:function(){var e=this,t=this;t.loading=!0,this.form.validateFields((function(a,s){if(a)t.loading=!1;else{var r={};r.username=e.userList.username,r.password=s.password,r.smscode=e.userList.smscode,r.phone=e.userList.phone,Object(o["getAction"])("/sys/user/passwordChange",r).then((function(a){if(a.success){var s={username:e.userList.username};console.log(s),setTimeout((function(){t.$emit("nextStep",s)}),1500)}else e.passwordFailed(a.message),t.loading=!1}))}}))},prevStep:function(){this.$emit("prevStep",this.userList)},handlePasswordCheck:function(e,t,a){var s=this.form.getFieldValue("password");t&&s&&t.trim()!==s.trim()&&a(new Error("两次密码不一致")),a()},passwordFailed:function(e){this.$notification["error"]({message:"更改密码失败",description:e,duration:4})}}},n=i,l=(a("71c6"),a("2877")),c=Object(l["a"])(n,s,r,!1,null,"1bbf13ad",null);t["default"]=c.exports},fb74:function(e,t,a){},ffc3:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticStyle:{width:"130%","text-align":"center","margin-left":"-10%"},attrs:{bordered:!1}},[a("a-steps",{staticClass:"steps",attrs:{current:e.currentTab}},[a("a-step",{attrs:{title:"用户账户"}}),a("a-step",{attrs:{title:"手机验证"}}),a("a-step",{attrs:{title:"密码"}}),a("a-step",{attrs:{title:"完成"}})],1),a("div",{staticClass:"content"},[0===e.currentTab?a("step1",{on:{nextStep:e.nextStep}}):e._e(),1===e.currentTab?a("step2",{attrs:{userList:e.userList},on:{nextStep:e.nextStep,prevStep:e.prevStep}}):e._e(),2===e.currentTab?a("step3",{attrs:{userList:e.userList},on:{nextStep:e.nextStep,prevStep:e.prevStep}}):e._e(),3===e.currentTab?a("step4",{attrs:{userList:e.userList},on:{prevStep:e.prevStep,finish:e.finish}}):e._e()],1)],1)},r=[],o=a("f14a"),i=a("ba6d"),n=a("f6d9"),l=a("8e46"),c={name:"Alteration",components:{Step1:o["default"],Step2:i["default"],Step3:n["default"],Step4:l["default"]},data:function(){return{description:"将一个冗长或用户不熟悉的表单任务分成多个步骤，指导用户完成。",currentTab:0,userList:{},form:null}},methods:{nextStep:function(e){this.userList=e,this.currentTab<4&&(this.currentTab+=1)},prevStep:function(e){this.userList=e,this.currentTab>0&&(this.currentTab-=1)},finish:function(){this.currentTab=0}}},u=c,d=(a("a001"),a("2877")),p=Object(d["a"])(u,s,r,!1,null,"63c12498",null);t["default"]=p.exports}}]);