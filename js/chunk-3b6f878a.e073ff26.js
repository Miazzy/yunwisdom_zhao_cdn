(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b6f878a"],{"1b80":function(t,e,a){"use strict";e["a"]={data:function(){return{pagination:{page:1,pageSize:10,total:0,showTotal:function(t,e){return"共 ".concat(t," 条")}}}},computed:{requestData:function(){return{page:this.pagination.page,pageSize:this.pagination.pageSize}}},methods:{init:function(){},pageChange:function(t){this.pagination.page=t,this.requestData.page=t.current,this.init()}}}},3786:function(t,e,a){"use strict";a.d(e,"d",(function(){return i})),a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return r})),a.d(e,"e",(function(){return c})),a.d(e,"f",(function(){return s})),a.d(e,"a",(function(){return u}));var n=a("22b6");function i(t){return n["a"].post("project/auth",t)}function o(t){var e="project/auth/add";return t.id&&(e="project/auth/edit"),n["a"].post(e,t)}function r(t,e){return n["a"].post("project/auth/forbid",{id:t,status:e})}function c(t,e){return n["a"].post("project/auth/resume",{id:t,status:e})}function s(t,e){return n["a"].post("project/auth/setDefault",{id:t,is_default:e})}function u(t){return n["a"].post("project/auth/del",{id:t})}},"4cb1":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=this,a=e.$createElement,n=e._self._c||a;return n("div",{staticClass:"project-auth"},[n("wrapper-content",[n("div",{staticClass:"action"},[n("Button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.rowClick(null,"new")}}},[e._v("添加")])],1),n("Table",{attrs:{columns:e.columns,dataSource:e.data,rowKey:"id",pagination:e.pagination},on:{change:e.pageChange},scopedSlots:e._u([{key:"is_default",fn:function(t,a,i){return[a.is_default?n("a-icon",{attrs:{type:"check"}}):e._e()]}},{key:"action",fn:function(t,a,i){return[n("a",{on:{click:function(t){return e.rowClick(a,"edit")}}},[e._v("编辑")]),n("Divider",{attrs:{type:"vertical"}}),n("router-link",{attrs:{to:"/system/account/apply/"+a.id}},[e._v("授权")]),a.is_default?e._e():[n("Divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(t){return e.rowClick(a,"is_default")}}},[a.is_default?e._e():n("span",[e._v("设为默认")])])],a.canDelete?[n("Divider",{attrs:{type:"vertical"}}),n("a",{on:{click:function(t){return e.rowClick(a,"del",i)}}},[e._v("删除")])]:e._e()]}}])})],1),n("Modal",{attrs:{title:e.actionInfo.modalTitle,bodyStyle:{paddingBottom:"1px"},footer:null},model:{value:e.actionInfo.modalStatus,callback:function(t){e.$set(e.actionInfo,"modalStatus",t)},expression:"actionInfo.modalStatus"}},[n("Form",{attrs:{autoFormCreate:function(e){t.form=e}},on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[n("FormItem",{attrs:{form:e.form,label:"名称",labelCol:{span:3},wrapperCol:{span:21},fieldDecoratorId:"title",fieldDecoratorOptions:{rules:[{required:!0,message:"请输入名称"}]},help:"必填，请填写权限名称（如：财务），用于标记拥有相应权限的角色"}},[n("Input",{attrs:{placeholder:"权限名称"}})],1),n("FormItem",{attrs:{label:"描述",labelCol:{span:3},wrapperCol:{span:21},fieldDecoratorId:"desc",help:"选填，权限描述。"}},[n("Input",{attrs:{placeholder:"权限描述"}})],1),n("FormItem",{attrs:{wrapperCol:{span:21,offset:3}}},[n("div",{staticClass:"action-btn"},[n("Button",{staticClass:"middle-btn",attrs:{type:"primary",htmlType:"submit",loading:e.actionInfo.confirmLoading}},[e._v("保存")]),n("Button",{staticClass:"middle-btn",on:{click:function(t){e.actionInfo.modalStatus=!1}}},[e._v("取消")])],1)])],1)],1)],1)},i=[],o=(a("c5f6"),a("4e72")),r=a("3786"),c=a("2f14"),s=a("1b80"),u=o["Form"].Item,l=[{title:"名称",dataIndex:"title",width:"15%"},{title:"描述",dataIndex:"desc",width:"30%"},{title:"默认",dataIndex:"is_default",width:"10%",scopedSlots:{customRender:"is_default"}},{title:"添加时间",dataIndex:"create_at"},{title:"操作",dataIndex:"id",scopedSlots:{customRender:"action"}}],d={components:{Table:o["Table"],Button:o["Button"],Divider:o["Divider"],Modal:o["Modal"],Form:o["Form"],FormItem:u,Input:o["Input"]},mixins:[s["a"]],data:function(){return{columns:l,data:[],newData:null,form:{},actionInfo:{modalStatus:!1,confirmLoading:!1,modalTitle:"编辑权限",okText:"确定",cancelText:"放弃"},authApplyShow:!1,nodeList:[],checkedList:[]}},created:function(){this.init()},methods:{init:function(){var t=this;Object(r["d"])(this.requestData).then((function(e){t.data=e.data.list,t.pagination.total=e.data.total}))},rowClick:function(t,e,a){var n=this;if(n.newData=null,"edit"==e||"new"==e)setTimeout((function(){n.form&&n.form.resetFields()}),0),n.actionInfo.modalStatus=!0,n.actionInfo.modalTitle="添加权限","edit"==e?setTimeout((function(){n.actionInfo.modalTitle="编辑权限",n.form.setFieldsValue({title:t.title,desc:t.desc}),n.newData=t}),0):n.newData={status:1,sort:0};else if("status"==e){var i=t.status;t.status=Number(!i),i?Object(r["c"])(t.id,t.status):Object(r["e"])(t.id,t.status)}else"is_default"==e?Object(r["f"])(t.id,1).then((function(t){Object(c["a"])(t)&&n.init()})):"del"==e&&o["Modal"].confirm({title:"确定要删除此权限?",content:"删除后不可恢复",okText:"确定",okType:"danger",cancelText:"放弃",onOk:function(){return Object(r["a"])(t.id).then((function(t){Object(c["a"])(t)&&n.data.splice(a,1)})),Promise.resolve()}})},handleSubmit:function(){var t=this;t.form.validateFields((function(e,a){e||t.handleOk()}))},handleOk:function(){var t=this;t.actionInfo.confirmLoading=!0;var e=t.form.getFieldsValue();t.newData.id?e.id=t.newData.id:Object.assign(e,t.newData),console.log(e),Object(r["b"])(e).then((function(a){t.actionInfo.confirmLoading=!1,Object(c["a"])(a)&&(t.newData.id?(t.newData.title=e.title,t.newData.desc=e.desc):t.data.push(a.data),t.form.resetFields(),t.newData=null,t.actionInfo.modalStatus=!1)}))}}},f=d,p=a("2877"),m=Object(p["a"])(f,n,i,!1,null,null,null);e["default"]=m.exports}}]);