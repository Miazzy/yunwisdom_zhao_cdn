(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ec1d87a","chunk-7ec1d87a"],{"0191":function(e,t,a){"use strict";var n=a("9821"),r=a.n(n);r.a},2e3:function(e,t,a){"use strict";var n=a("2fc8"),r=a.n(n);r.a},"2fc8":function(e,t,a){},"6aca":function(e,t,a){},9821:function(e,t,a){},"9eee":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery(t)}}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{md:6,sm:8}},[a("a-form-item",{attrs:{label:"文件名称"}},[a("a-input",{attrs:{placeholder:"请输入文件名称"},model:{value:e.queryParam.fileName,callback:function(t){e.$set(e.queryParam,"fileName",t)},expression:"queryParam.fileName"}})],1)],1),a("a-col",{attrs:{md:6,sm:8}},[a("a-form-item",{attrs:{label:"文件地址"}},[a("a-input",{attrs:{placeholder:"请输入文件地址"},model:{value:e.queryParam.url,callback:function(t){e.$set(e.queryParam,"url",t)},expression:"queryParam.url"}})],1)],1)],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-upload",{attrs:{name:"file",multiple:!1,action:e.uploadAction,headers:e.tokenHeader,showUploadList:!1,beforeUpload:e.beforeUpload},on:{change:e.handleChange}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v("\n        OSS文件上传\n      ")],1)],1),a("a-upload",{attrs:{name:"file",multiple:!1,action:e.minioUploadAction,headers:e.tokenHeader,showUploadList:!1,beforeUpload:e.beforeUpload},on:{change:e.handleChange}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v("\n        MINIO文件上传\n      ")],1)],1)],1),a("div",[a("div",{staticClass:"ant-alert ant-alert-info",staticStyle:{"margin-bottom":"16px"}},[a("i",{staticClass:"anticon anticon-info-circle ant-alert-icon"}),e._v(" 已选择 "),a("a",{staticStyle:{"font-weight":"600"}},[e._v(e._s(e.selectedRowKeys.length))]),e._v("项\n      "),a("a",{staticStyle:{"margin-left":"24px"},on:{click:e.onClearSelected}},[e._v("清空")])]),a("a-table",{ref:"table",attrs:{size:"middle",bordered:"",rowKey:"id",columns:e.columns,dataSource:e.dataSource,pagination:e.ipagination,loading:e.loading,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"action",fn:function(t,n){return a("span",{},[a("a",{on:{click:function(t){return e.handlePreview(n)}}},[e._v("预览")]),a("a-divider",{attrs:{type:"vertical"}}),a("a",{on:{click:function(t){return e.ossDelete(n.id)}}},[e._v("删除")])],1)}}])})],1)])},r=[],o=(a("7f7f"),a("b65a")),i={name:"OSSFileList",mixins:[o["a"]],data:function(){return{description:"文件列表",columns:[{title:"#",dataIndex:"",key:"rowIndex",width:60,align:"center",customRender:function(e,t,a){return parseInt(a)+1}},{title:"文件名称",align:"center",dataIndex:"fileName"},{title:"文件地址",align:"center",dataIndex:"url"},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],url:{upload:"/oss/file/upload",list:"/oss/file/list",delete:"/oss/file/delete",minioUpload:"/sys/upload/uploadMinio"}}},computed:{uploadAction:function(){return window._CONFIG["domianURL"]+this.url.upload},minioUploadAction:function(){return window._CONFIG["domianURL"]+this.url.minioUpload}},methods:{beforeUpload:function(e){var t=e.type;if("image"===t){if(t.indexOf("image")<0)return this.$message.warning("请上传图片"),!1}else if("file"===t&&t.indexOf("image")>=0)return this.$message.warning("请上传文件"),!1;return!0},handleChange:function(e){"done"===e.file.status?e.file.response.success?(this.loadData(),this.$message.success("".concat(e.file.name," 上传成功!"))):this.$message.error("".concat(e.file.response.message)):"error"===e.file.status&&this.$message.error("".concat(e.file.response.message))},ossDelete:function(e){var t=this;t.$confirm({title:"确认删除",content:"是否删除选中文件?",onOk:function(){t.handleDelete(e)}})},handlePreview:function(e){if(e&&e.url){var t=window._CONFIG["onlinePreviewDomainURL"]+"?url="+encodeURIComponent(e.url);window.open(t,"_blank")}}}},s=i,l=(a("0191"),a("2877")),c=Object(l["a"])(s,n,r,!1,null,"86932bb0",null);t["default"]=c.exports},a60b:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[a("a-form-item",{attrs:{label:"报表编码"}},[a("a-input",{attrs:{placeholder:"请输入报表编码"},model:{value:e.queryParam.code,callback:function(t){e.$set(e.queryParam,"code",t)},expression:"queryParam.code"}})],1)],1),a("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[a("a-form-item",{attrs:{label:"报表名字"}},[a("a-input",{attrs:{placeholder:"请输入报表名字"},model:{value:e.queryParam.name,callback:function(t){e.$set(e.queryParam,"name",t)},expression:"queryParam.name"}})],1)],1),a("a-col",{attrs:{xl:6,lg:7,md:8,sm:24}},[a("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:e.searchQuery}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary",icon:"reload"},on:{click:e.searchReset}},[e._v("重置")])],1)])],1)],1)],1),a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.handleAdd}},[e._v("录入")]),e.selectedRowKeys.length>0?a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{key:"1",on:{click:e.batchDel}},[a("a-icon",{attrs:{type:"delete"}}),e._v("\n          删除\n        ")],1)],1),a("a-button",{staticStyle:{"margin-left":"8px"}},[e._v(" 批量操作\n        "),a("a-icon",{attrs:{type:"down"}})],1)],1):e._e()],1),a("div",[a("div",{staticClass:"ant-alert ant-alert-info",staticStyle:{"margin-bottom":"16px"}},[a("i",{staticClass:"anticon anticon-info-circle ant-alert-icon"}),e._v("\n      已选择\n      "),a("a",{staticStyle:{"font-weight":"600"}},[e._v("\n        "+e._s(e.selectedRowKeys.length)+"\n      ")]),e._v("\n      项\n      "),a("a",{staticStyle:{"margin-left":"24px"},on:{click:e.onClearSelected}},[e._v("清空")])]),a("a-table",{ref:"table",attrs:{size:"middle",bordered:"",rowKey:"id",columns:e.columns,dataSource:e.dataSource,pagination:e.ipagination,loading:e.loading,rowSelection:{selectedRowKeys:e.selectedRowKeys,onChange:e.onSelectChange}},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"action",fn:function(t,n){return a("span",{},[a("a",{on:{click:function(t){return e.handleEdit(n)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link"},[e._v("更多 "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{on:{click:function(t){return e.popReportURL(n.id)}}},[e._v("\n              配置地址\n            ")]),a("a-menu-item",[a("a",{on:{click:function(t){return e.goPageOnline(n.id)}}},[e._v("功能测试")])]),a("a-menu-item",[a("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return e.handleDelete(n.id)}}},[a("a",[e._v("删除")])])],1)],1)],1)],1)}}])})],1),a("onlCgreportHead-modal",{ref:"modalForm",on:{ok:e.modalFormOk}}),a("a-modal",{attrs:{title:"报表访问链接",visible:e.visible},on:{cancel:e.handleCancel}},[a("template",{slot:"footer"},[a("a-button",{on:{click:e.handleCancel}},[e._v("关闭")]),a("a-button",{staticClass:"copy-this-text",attrs:{type:"primary","data-clipboard-text":e.reportUrlText},on:{click:e.onCopyUrl}},[e._v("复制")])],1),a("p",[e._v(e._s(e.reportUrlText))])],2)],1)},r=[],o=(a("ac4d"),a("8a81"),a("ac6a"),a("b65a")),i=a("b311"),s=a.n(i),l=a("0fea"),c={name:"OnlCgreportHeadList",mixins:[o["a"]],components:{Clipboard:s.a},data:function(){return{description:"在线报表配置管理页面",visible:!1,reportUrlText:"",columns:[{title:"报表名称",align:"center",dataIndex:"name"},{title:"编码",align:"center",dataIndex:"code"},{title:"查询SQL",align:"center",dataIndex:"cgrSql"},{title:"数据源",align:"center",dataIndex:"dbSource"},{title:"创建时间",align:"center",dataIndex:"createTime"},{title:"描述",align:"center",dataIndex:"content"},{title:"操作",dataIndex:"action",align:"center",scopedSlots:{customRender:"action"}}],url:{list:"/online/cgreport/head/list",delete:"/online/cgreport/head/delete",deleteBatch:"/online/cgreport/head/deleteBatch",getParamsInfo:"/online/cgreport/api/getParamsInfo/"}}},methods:{initReportUrlText:function(e){var t=this;Object(l["getAction"])(this.url.getParamsInfo+e).then((function(a){var n="";if(a.success){if(a.result&&a.result.length>0){var r=!0,o=!1,i=void 0;try{for(var s,l=a.result[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var c=s.value;n+=c.paramName+"=${"+c.paramName+"}&"}}catch(u){o=!0,i=u}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}}}else t.$message.warning(a.message);n.length>0?(n=n.substring(0,n.length-1),t.reportUrlText="/online/cgreport/".concat(e,"?").concat(n)):t.reportUrlText="/online/cgreport/".concat(e)}))},goPageOnline:function(e){this.$router.push({path:"/online/cgreport/"+e})},popReportURL:function(e){this.visible=!0,this.initReportUrlText(e)},handleCancel:function(){this.visible=!1,this.reportUrlText=""},onCopyUrl:function(){var e=this,t=new s.a(".copy-this-text");t.on("success",(function(){t.destroy(),e.$message.success("复制成功"),e.handleCancel()})),t.on("error",(function(){e.$message.error("该浏览器不支持自动复制"),t.destroy()}))}}},u=c,d=(a("2000"),a("2877")),m=Object(d["a"])(u,n,r,!1,null,"17c138cd",null);t["default"]=m.exports},b39b:function(e,t,a){"use strict";var n=a("6aca"),r=a.n(n);r.a},ca7e:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{staticStyle:{height:"100%"},attrs:{bordered:!1}},[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{attrs:{layout:"inline"}},[e.queryInfo&&e.queryInfo.length>0?a("a-row",{attrs:{gutter:24}},[e._l(e.queryInfo,(function(t,n){return["1"===t.hidden?[t.view.indexOf("Date")>=0?a("a-col",{directives:[{name:"show",rawName:"v-show",value:e.toggleSearchStatus,expression:"toggleSearchStatus"}],key:"query"+n,attrs:{md:12,sm:16}},[a("onl-cgreport-query-form-item",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1):a("a-col",{directives:[{name:"show",rawName:"v-show",value:e.toggleSearchStatus,expression:"toggleSearchStatus"}],key:"query"+n,attrs:{md:6,sm:8}},[a("onl-cgreport-query-form-item",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1)]:[t.view.indexOf("Date")>=0?a("a-col",{key:"query"+n,attrs:{md:12,sm:16}},[a("onl-cgreport-query-form-item",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1):a("a-col",{key:"query"+n,attrs:{md:6,sm:8}},[a("onl-cgreport-query-form-item",{attrs:{queryParam:e.queryParam,item:t,dictOptions:e.dictOptions}})],1)]]})),a("a-col",{attrs:{md:6,sm:8}},[a("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[a("a-button",{attrs:{type:"primary",icon:"search"},on:{click:e.searchByQuery}},[e._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary",icon:"reload"},on:{click:e.searchReset}},[e._v("重置")]),a("a",{staticStyle:{"margin-left":"8px"},on:{click:e.handleToggleSearch}},[e._v("\n              "+e._s(e.toggleSearchStatus?"收起":"展开")+"\n              "),a("a-icon",{attrs:{type:e.toggleSearchStatus?"up":"down"}})],1)],1)])],2):e._e()],1)],1),a("div",{staticClass:"table-operator",staticStyle:{"margin-bottom":"10px"}},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:e.exportExcel}},[e._v("导出")])],1),a("a-table",{ref:"table",staticStyle:{"min-height":"300px"},attrs:{size:"middle",bordered:"",rowKey:"id",columns:e.table.columns,dataSource:e.table.dataSource,pagination:e.table.pagination,loading:e.table.loading,scroll:e.table.scroll,rowSelection:{fixed:!0,selectedRowKeys:e.table.selectedRowKeys,onChange:e.handleChangeInTableSelect}},on:{change:e.handleChangeInTable},scopedSlots:e._u([e._l(e.fieldHrefSlots,(function(t){return{key:t.slotName,fn:function(n,r){return[a("a",{on:{click:function(a){return e.handleClickFieldHref(t,r)}}},[e._v(e._s(n))])]}}}))],null,!0)}),a("a-modal",e._g(e._b({},"a-modal",e.hrefComponent.model,!1),e.hrefComponent.on),[a(e.hrefComponent.is,e._b({tag:"component"},"component",e.hrefComponent.params,!1))],1)],1)},r=[],o=(a("456d"),a("c5f6"),a("75fc")),i=(a("ac4d"),a("8a81"),a("ac6a"),a("b5ef")),s=a("0fea"),l=a("89f2"),c=a("ca00"),u={name:"OnlCgreportAutoList",mixins:[i["a"]],components:{},data:function(){return{queryInfo:[],queryParamsMap:{},selfParam:{},sorter:{column:"",order:"desc"},dictOptions:{},toggleSearchStatus:!1,reportCode:"",description:"在线报表功能测试页面",url:{getColumnsAndData:"".concat(window._CONFIG["domain"],"/jeecg-boot/online/cgreport/api/getColumnsAndData/"),getQueryInfo:"".concat(window._CONFIG["domain"],"/jeecg-boot/online/cgreport/api/getQueryInfo/"),getParamsInfo:"".concat(window._CONFIG["domain"],"/jeecg-boot/online/cgreport/api/getParamsInfo/")},table:{loading:!0,columns:[],dataSource:[],selectedRowKeys:[],selectionRows:[],scroll:{x:!1},pagination:{current:1,pageSize:10,pageSizeOptions:["10","20","30"],showTotal:function(e,t){return t[0]+"-"+t[1]+" 共"+e+"条"},showQuickJumper:!0,showSizeChanger:!0,total:0}},cgreportHeadName:""}},mounted:function(){this.initParamsInfo(),this.initQueryInfo()},watch:{$route:function(){this.initParamsInfo(),this.initQueryInfo()}},computed:{queryParam:{get:function(){return this.queryParamsMap[this.reportCode]},set:function(e){this.$set(this.queryParamsMap,this.reportCode,e)}}},methods:{initParamsInfo:function(){var e=this;if(!this.$route.params.code)return!1;this.reportCode=this.$route.params.code,this.queryParam||(this.queryParam={}),this.selfParam={};var t="".concat(this.url.getParamsInfo).concat(this.reportCode);Object(s["getAction"])(t).then((function(t){if(t.success){if(t.result&&t.result.length>0){var a=!0,n=!1,r=void 0;try{for(var o,i=t.result[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var s=o.value;e.selfParam["self_"+s.paramName]=e.$route.query[s.paramName]?e.$route.query[s.paramName]:""}}catch(l){n=!0,r=l}finally{try{a||null==i.return||i.return()}finally{if(n)throw r}}}}else e.$message.warning(t.message);e.loadData()}))},initQueryInfo:function(){var e=this;if(!this.reportCode)return!1;Object(s["getAction"])("".concat(this.url.getQueryInfo).concat(this.reportCode)).then((function(t){console.log("获取查询条件",t),t.success?e.queryInfo=t.result:e.$message.warning(t.message)}))},loadData:function(e){var t=this;if(!this.reportCode)return!1;1==e&&(this.table.pagination.current=1);var a=this.getQueryParams();console.log(a),console.log(" 动态报表 reportCode ： "+this.reportCode),this.table.loading=!0,Object(s["getAction"])("".concat(this.url.getColumnsAndData).concat(this.reportCode),a).then((function(e){if(e.success){var a=e.result,n=a.data,r=a.columns,i=a.cgreportHeadName,s=a.dictOptions,c=a.fieldHrefSlots,u=230;t.dictOptions=s;for(var d=0;d<r.length;d++)r[d].customRender&&function(){var e=r[d].customRender;r[d].customRender=function(a){return a?Object(l["b"])(t.dictOptions[e],a+""):a}}(),r.width=u;t.table.scroll.x=r.length*u,t.table.columns=Object(o["a"])(r),t.cgreportHeadName=i,t.fieldHrefSlots=c,n?(t.table.pagination.total=Number(n.total),t.table.dataSource=n.records):(t.table.pagination.total=0,t.table.dataSource=[])}else t.$message.warn("查询失败："+e.message)})).catch((function(e){console.error(e),t.$message.error("查询失败")})).finally((function(){t.table.loading=!1}))},getQueryParams:function(){var e=Object.assign({},this.queryParam,this.sorter,this.selfParam);return e.pageNo=this.table.pagination.current,e.pageSize=this.table.pagination.pageSize,Object(c["h"])(e)},searchByQuery:function(){this.loadData(1)},searchReset:function(){this.queryParam={},this.loadData(1)},handleToggleSearch:function(){this.toggleSearchStatus=!this.toggleSearchStatus},exportExcel:function(){var e=this,t=this.cgreportHeadName,a={};for(var n in this.$route.query)if(this.$route.query.hasOwnProperty(n)){var r=this.$route.query[n];a["self_"+n]=r||""}Object(s["downFile"])("/online/cgreport/api/exportXls/".concat(this.reportCode),Object.assign(a,this.queryParam)).then((function(a){if(a)if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(new Blob([a]),t+".xls");else{var n=window.URL.createObjectURL(new Blob([a])),r=document.createElement("a");r.style.display="none",r.href=n,r.setAttribute("download",t+".xls"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}else e.$message.warning("文件下载失败")}))},handleChangeInTableSelect:function(e,t){this.table.selectedRowKeys=e,this.table.selectionRows=t},handleChangeInTable:function(e,t,a){Object.keys(a).length>0?(this.sorter.column=a.field,this.sorter.order="ascend"==a.order?"asc":"desc"):(this.sorter.column=null,this.sorter.order=null),this.table.pagination=e,this.loadData()}}},d=u,m=(a("b39b"),a("2877")),p=Object(m["a"])(d,n,r,!1,null,"bfe1f724",null);t["default"]=p.exports}}]);