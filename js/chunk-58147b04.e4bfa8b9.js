(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58147b04","chunk-58147b04"],{1478:function(t,e,a){},"28ba":function(t,e,a){"use strict";var s=a("d7d2");e["a"]=s["a"]},"51e2":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-tabs",{attrs:{tabPosition:"left",defaultActiveKey:"1",animated:!1},model:{value:t.tabKey,callback:function(e){t.tabKey=e},expression:"tabKey"}},[a("a-tab-pane",{key:"1"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"check-square"}}),t._v("任务\n    ")],1)]),a("a-tab-pane",{key:"2"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"link"}}),t._v("文件\n    ")],1)]),a("div",{staticClass:"config-content"},[a("vue-scroll",[a("div",{staticClass:"content-item"},[a("div",{staticClass:"infos"},[a("a-list",[t.showLoadingMore?a("div",{style:{textAlign:"center",marginTop:"12px",height:"32px",lineHeight:"32px"},attrs:{slot:"loadMore"},slot:"loadMore"},[t.loadingMore?a("a-spin"):a("a-button",{on:{click:t.onLoadMore}},[t._v("加载更多")])],1):t._e(),t._l(t.list,(function(e,s){return a("a-list-item",{key:s},[a("a-list-item-meta",[a("div",{attrs:{slot:"title"},slot:"title"},[a("router-link",{directives:[{name:"show",rawName:"v-show",value:"1"==t.tabKey,expression:"tabKey == '1'"}],staticClass:"text-default",attrs:{to:"/project/space/task/"+t.code+"/detail/"+e.code}},[t._v(t._s(e.name))]),a("a",{directives:[{name:"show",rawName:"v-show",value:"2"==t.tabKey,expression:"tabKey == '2'"}],staticClass:"text-default",attrs:{target:"_blank",href:e.file_url}},[t._v(t._s(e.fullName))])],1),a("div",{attrs:{slot:"description"},slot:"description"},[t._v(t._s(t.showTaskTime(e.deleted_time)))])]),a("a",{staticClass:"muted",attrs:{slot:"actions"},on:{click:function(a){return t.recoveryTask(e,s)}},slot:"actions"},[a("a-tooltip",{attrs:{title:"恢复内容"}},[a("a-icon",{attrs:{type:"undo"}})],1)],1),a("a",{staticClass:"muted",attrs:{slot:"actions"},on:{click:function(a){return t.deleteItem(e,s)}},slot:"actions"},[a("a-tooltip",{attrs:{title:"彻底删除"}},[a("a-icon",{attrs:{type:"delete"}})],1)],1)],1)}))],2)],1)])])],1)],1)},i=[],o=a("2f14"),n=a("ca8d"),l=a("0610"),r=a("1b80"),c=a("81fe"),d={name:"recycleBin",props:{code:{type:[String],default:function(){return""}}},mixins:[r["a"]],data:function(){return{loading:!1,tabKey:"1",project:{},list:[],showLoadingMore:!1,loadingMore:!1}},watch:{code:function(){this.init()},tabKey:function(t){this.init()}},created:function(){this.init()},methods:{init:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this;switch(t&&(this.list=[],this.pagination.page=1,this.pagination.pageSize=10,this.showLoadingMore=!1),this.requestData.deleted=1,this.requestData.projectCode=this.code,e.loading=!0,this.tabKey){case"1":e.getTasks();break;case"2":e.getFiles();break}},getTasks:function(){var t=this;Object(n["j"])(t.requestData).then((function(e){t.list=t.list.concat(e.data.list),t.pagination.total=e.data.total,t.showLoadingMore=t.pagination.total>t.list.length,t.loading=!1,t.loadingMore=!1}))},getFiles:function(){var t=this;Object(l["b"])(t.requestData).then((function(e){t.list=t.list.concat(e.data.list),t.pagination.total=e.data.total,t.showLoadingMore=t.pagination.total>t.list.length,t.loading=!1,t.loadingMore=!1}))},onLoadMore:function(){this.loadingMore=!0,this.pagination.page++,this.init(!1)},showTaskTime:function(t){return Object(c["b"])(t)},recoveryTask:function(t,e){var a=this;switch(this.tabKey){case"1":this.$confirm({title:"确定恢复内容？",content:"恢复后可在任务列表中查看",okText:"恢复内容",okType:"primary",cancelText:"再想想",onOk:function(){return Object(n["k"])(t.code).then((function(s){Object(o["a"])(s)&&(a.list.splice(e,1),a.$emit("update",t))})),Promise.resolve()}});break;case"2":this.$confirm({title:"确定恢复文件？",content:"恢复后可在我的文件中查看",okText:"恢复文件",okType:"primary",cancelText:"再想想",onOk:function(){return Object(l["c"])(t.code).then((function(s){Object(o["a"])(s)&&(a.list.splice(e,1),a.$emit("update",t))})),Promise.resolve()}});break}},deleteItem:function(t,e){var a=this;switch(this.tabKey){case"1":this.$confirm({title:"确定彻底删除任务？",content:"彻底删除任务后，该任务及其子任务将会被永久被删除。",okText:"彻底删除",okType:"danger",cancelText:"再想想",onOk:function(){return Object(n["e"])(t.code).then((function(s){Object(o["a"])(s)&&(a.list.splice(e,1),a.$emit("update",t))})),Promise.resolve()}});break;case"2":this.$confirm({title:"确认彻底删除该文件？",content:"彻底删除文件后，相关的关联资源将会失效。",okText:"彻底删除",okType:"danger",cancelText:"再想想",onOk:function(){return Object(l["a"])(t.code).then((function(s){Object(o["a"])(s)&&(a.list.splice(e,1),a.$emit("update",t))})),Promise.resolve()}});break}}}},m=d,v=(a("c9b7"),a("2877")),u=Object(v["a"])(m,s,i,!1,null,null,null);e["default"]=u.exports},"57e0":function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return i}));var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-detail",attrs:{id:"task-detail"}},[a("a-spin",{staticClass:"task-detail-spin",attrs:{spinning:t.loading}},[a("div",{staticClass:"task-header",class:{disabled:t.task.deleted}},[t.task.deleted?a("span",{staticClass:"head-title muted"},[a("a-icon",{attrs:{type:"delete"}}),t._v(" \n        "),a("span",[t._v("任务已在回收站中，不可修改")])],1):a("span",{staticClass:"head-title"},[t.task.parentTask?a("span",[a("span",{staticClass:"muted"},[t._v("属于任务：")]),a("a-breadcrumb",{staticClass:"breadcrumb text-default",attrs:{separator:">"}},t._l(t.task.parentTasks,(function(e){return a("a-breadcrumb-item",{key:e.code},[a("a",{staticClass:"text-default",on:{click:function(a){return t.init(e.code)}}},[t._v(t._s(e.name))])])})),1)],1):a("span",[t._v(t._s(t.task.projectName)+" · "+t._s(t.task.stageName))])]),a("span",{staticClass:"header-action text-right"},[t.task.deleted?[a("a",{staticClass:"action-item muted",on:{click:t.recoveryTask}},[a("a-icon",{attrs:{type:"undo"}}),a("span",[t._v("恢复内容")])],1),a("a",{staticClass:"action-item muted",on:{click:t.deleteTask}},[a("a-icon",{attrs:{type:"delete"}}),a("span",[t._v("彻底删除")])],1)]:[a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("复制任务链接")])]),a("a",{directives:[{name:"clipboard",rawName:"v-clipboard",value:t.taskLink,expression:"taskLink"}],staticClass:"action-item muted",on:{success:t.copyLink}},[a("a-icon",{attrs:{type:"link"}})],1)],2),a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("点个赞")])]),a("a",{staticClass:"action-item muted",class:{active:t.task.liked},on:{click:function(e){return t.like(!t.task.liked)}}},[a("a-icon",{attrs:{type:"like"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:t.task.like,expression:"task.like"}]},[t._v(t._s(t.task.like))])],1)],2),a("a-dropdown",{attrs:{trigger:["click"],placement:"bottomCenter"},model:{value:t.visibleTaskMenu,callback:function(e){t.visibleTaskMenu=e},expression:"visibleTaskMenu"}},[a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("打开菜单")])]),a("a",{staticClass:"action-item muted"},[a("a-icon",{attrs:{type:"ellipsis"}})],1)],2),a("a-menu",{staticClass:"field-right-menu",attrs:{slot:"overlay"},on:{click:t.doTask},slot:"overlay"},[a("a-menu-item",{key:"copy"},[a("a-icon",{attrs:{type:"copy"}}),a("span",[t._v("复制任务 *")])],1),a("a-menu-item",{key:"move"},[a("a-icon",{attrs:{type:"snippets"}}),a("span",[t._v("移动任务 *")])],1),a("a-menu-item",{key:"star"},[a("a-icon",{attrs:{type:"star"}}),t.task.stared?a("span",[t._v("取消收藏")]):a("span",[t._v("收藏任务")])],1),a("a-menu-item",{key:"recycle"},[a("a-icon",{attrs:{type:"delete"}}),a("span",[t._v("移到回收站")])],1),a("a-menu-item",{key:"open"},[a("a-icon",{attrs:{type:"book"}}),a("span",[t._v("以新标签页打开")])],1),a("a-menu-divider"),a("a-menu-item",{key:"private"},[a("a-icon",{attrs:{type:t.task.private?"lock":"unlock"}}),a("span",[t._v("隐私模式")]),a("a",{staticClass:"menu-action text-primary"},[t.task.private?a("span",[t._v("已开启")]):a("span",[t._v("已关闭")])]),a("div",{staticClass:"menu-desc muted"},[t.task.private?a("span",[t._v("仅参与者可见")]):a("span",[t._v("所有成员可见")])])],1)],1)],1)],a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("关闭面板")])]),a("a",{staticClass:"action-item muted",on:{click:t.detailClose}},[a("a-icon",{attrs:{type:"close"}})],1)],2)],2)]),a("div",{staticClass:"task-wrap"},[a("div",{staticClass:"task-content"},[a("div",{staticClass:"content-left"},[a("vue-scroll",{attrs:{ops:t.scrollOps}},[a("div",{staticClass:"task-title",class:{disabled:t.task.deleted}},[a("a-input",{directives:[{name:"show",rawName:"v-show",value:t.showEditName,expression:"showEditName"}],ref:"inputTitle",attrs:{"auto-focus":"",size:"large"},on:{blur:t.doName},model:{value:t.task.name,callback:function(e){t.$set(t.task,"name",e)},expression:"task.name"}}),t.task.deleted?a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showEditName,expression:"!showEditName"}],staticClass:"title-text"},[t._v(t._s(t.task.name))]):a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("点击即可编辑")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showEditName,expression:"!showEditName"}],staticClass:"title-text",on:{click:t.editTitle}},[t._v(t._s(t.task.name))])],2)],1),a("div",{staticClass:"task-basic-attrs-view muted"},[a("div",{staticClass:"field-list",class:{disabled:t.task.deleted}},[a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"field-left"},[a("a-icon",{attrs:{type:"check-square"}}),a("span",{staticClass:"field-name"},[t._v("状态")])],1),a("div",{staticClass:"field-right"},[a("a-dropdown",{class:{disabled:t.task.hasUnDone},attrs:{trigger:["click"],disabled:!!t.task.deleted||!!t.task.hasUnDone}},[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[t.task.hasUnDone?a("span",{staticStyle:{"font-size":"12px"}},[t._v("子任务尚未全部完成，无法完成父任务")]):t._e()]),a("span",[t.task.done?a("a-tag",{attrs:{color:"green"}},[t._v("已完成")]):t._e(),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.task.done,expression:"!task.done"}]},[t._v("未完成")])],1)],2),a("a-menu",{staticClass:"field-right-menu",attrs:{slot:"overlay",selectable:!1},on:{click:function(e){return t.taskDone(t.task.code,!t.task.done)}},slot:"overlay"},[a("a-menu-item",{key:"done"},[a("div",{staticClass:"menu-item-content"},[a("a-tag",{attrs:{color:"green"}},[t._v("已完成")]),a("a-icon",{directives:[{name:"show",rawName:"v-show",value:t.task.done,expression:"task.done"}],staticClass:"check muted",attrs:{type:"check"}})],1)]),a("a-menu-item",{key:"undone"},[a("div",{staticClass:"menu-item-content"},[a("a-tag",{attrs:{color:"grey"}},[t._v("未完成")]),a("a-icon",{directives:[{name:"show",rawName:"v-show",value:!t.task.done,expression:"!task.done"}],staticClass:"check muted",attrs:{type:"check"}})],1)])],1)],1)],1)])]),a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"field-left"},[a("a-icon",{attrs:{type:"user"}}),a("span",{staticClass:"field-name"},[t._v("执行者")])],1),a("div",{staticClass:"field-right"},[a("a-dropdown",{attrs:{trigger:["click"],disabled:!!t.task.deleted,placement:"bottomCenter"},model:{value:t.visibleTaskMemberMenu,callback:function(e){t.visibleTaskMemberMenu=e},expression:"visibleTaskMemberMenu"}},[t.task.deleted?a("div",{staticClass:"field-flex"},[t.task.executor?[a("a-avatar",{attrs:{src:t.task.executor.avatar,icon:"user",size:"small"}}),a("a",{staticClass:"muted name"},[t._v(t._s(t.task.executor.name))])]:t._e(),t.task.executor?t._e():[a("a-avatar",{attrs:{icon:"user",size:"small"}}),a("a",{staticClass:"muted name"},[t._v("待认领")])]],2):a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("点击设置执行者")])]),a("div",{staticClass:"field-flex"},[t.task.executor?[a("a-avatar",{attrs:{src:t.task.executor.avatar,icon:"user",size:"small"}}),a("a",{staticClass:"muted name"},[t._v(t._s(t.task.executor.name))])]:t._e(),t.task.executor?t._e():[a("a-avatar",{attrs:{icon:"user",size:"small"}}),a("a",{staticClass:"muted name"},[t._v("待认领")])]],2)],2),a("div",{attrs:{slot:"overlay"},slot:"overlay"},[t.visibleTaskMemberMenu?a("task-member-menu",{attrs:{projectCode:t.projectCodeCurrent,taskCode:t.code},on:{close:function(e){return t.init(!1)},inviteProjectMember:function(e){t.showInviteMember=!0,t.visibleTaskMemberMenu=!1}}}):t._e()],1)],1)],1)])]),a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"field-left"},[a("a-icon",{attrs:{type:"calendar"}}),a("span",{staticClass:"field-name"},[t._v("时间")])],1),a("div",{staticClass:"field-right field-date"},[t.task.openBeginTime?[a("a-dropdown",{attrs:{trigger:["click"],disabled:!!t.task.deleted},model:{value:t.showBeginTime,callback:function(e){t.showBeginTime=e},expression:"showBeginTime"}},[t.task.deleted?a("div",{staticClass:"field-flex"},[a("a",{staticClass:"muted name",staticStyle:{margin:"0"}},[t.task.setBeginTime?[t._v(t._s(t.task.begin_time_format))]:[t._v("设置开始时间")]],2)]):a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("点击设置开始时间")])]),a("div",{staticClass:"field-flex"},[a("a",{staticClass:"muted name",staticStyle:{margin:"0"}},[t.task.setBeginTime?[t._v(t._s(t.task.begin_time_format))]:[t._v("设置开始时间")]],2)])],2),a("div",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-date-picker",{attrs:{size:"small",format:"MM月DD日 HH:mm",showTime:"",allowClear:"",showToday:!1,open:t.showBeginTime},on:{ok:function(e){return t.doBeginTime(!0)}},model:{value:t.task.begin_time,callback:function(e){t.$set(t.task,"begin_time",e)},expression:"task.begin_time"}},[a("template",{slot:"renderExtraFooter"},[a("a",{staticStyle:{position:"absolute"},attrs:{size:"small"},on:{click:function(e){return t.doBeginTime(!1)}}},[t._v("清除")])])],2)],1)],1),a("span",{staticClass:"m-l-sm m-r-sm"},[t._v("-")])]:t._e(),a("a-dropdown",{attrs:{trigger:["click"],disabled:!!t.task.deleted},model:{value:t.showEndTime,callback:function(e){t.showEndTime=e},expression:"showEndTime"}},[t.task.deleted?a("div",{staticClass:"field-flex"},[a("a",{staticClass:"muted name",staticStyle:{margin:"0"}},[t.task.setEndTime?[t._v(t._s(t.task.end_time_format))]:[t._v("设置截止时间")]],2)]):a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("点击设置截止时间")])]),a("div",{staticClass:"field-flex"},[a("a",{staticClass:"muted name",staticStyle:{margin:"0"}},[t.task.setEndTime?[t._v(t._s(t.task.end_time_format))]:[t._v("设置截止时间")]],2)])],2),a("div",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-date-picker",{attrs:{size:"small",format:"MM月DD日 HH:mm",showTime:"",allowClear:"",showToday:!1,open:t.showEndTime},on:{ok:function(e){return t.doEndTime(!0)}},model:{value:t.task.end_time,callback:function(e){t.$set(t.task,"end_time",e)},expression:"task.end_time"}},[a("template",{slot:"renderExtraFooter"},[a("a",{staticStyle:{position:"absolute"},attrs:{size:"small"},on:{click:function(e){return t.doEndTime(!1)}}},[t._v("清除")])])],2)],1)],1)],2)])]),a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"field-left"},[a("a-icon",{attrs:{type:"file-text"}}),a("span",{staticClass:"field-name"},[t._v("备注")])],1),a("div",{staticClass:"field-right width-block"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!t.showTaskDescriptionEdit,expression:"!showTaskDescriptionEdit"}],staticClass:"task-description",class:{disabled:t.task.deleted},on:{click:t.showTaskDesc}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.task.description,expression:"task.description"}],staticClass:"description-txt",domProps:{innerHTML:t._s(t.task.description)}}),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.task.description,expression:"!task.description"}]},[t._v("添加备注")])]),t.hasMoreDesc?a("div",{staticClass:"m-t-sm"},[a("a",{directives:[{name:"show",rawName:"v-show",value:!t.showMoreDesc,expression:"!showMoreDesc"}],on:{click:function(e){return t.checkShowMoreDesc(!0)}}},[t._v("显示更多")]),a("a",{directives:[{name:"show",rawName:"v-show",value:t.showMoreDesc,expression:"showMoreDesc"}],on:{click:function(e){return t.checkShowMoreDesc(!1)}}},[t._v("收起备注")])]):t._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showTaskDescriptionEdit,expression:"showTaskDescriptionEdit"}]},[a("editor",{ref:"vueWangeditor",attrs:{id:"editor",uploadImgServer:t.editorConfig.uploadImgServer,uploadImgHeaders:t.editorConfig.uploadImgHeaders,menus:t.editorConfig.menus}}),a("div",{staticClass:"action-btn pull-right"},[a("a",{staticClass:"cancel-text muted",attrs:{type:"text"},on:{click:function(e){t.showTaskDescriptionEdit=!1,t.initContent(!1)}}},[t._v("取消")]),a("a-button",{staticClass:"middle-btn",attrs:{type:"primary",htmlType:"submit"},on:{click:t.doContent}},[t._v("保存")])],1)],1)])])]),a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"field-left"},[a("a-icon",{attrs:{type:"bulb"}}),a("span",{staticClass:"field-name"},[t._v("优先级")])],1),a("div",{staticClass:"field-right"},[a("a-dropdown",{attrs:{trigger:["click"],disabled:!!t.task.deleted}},[a("span",[a("a-tag",{attrs:{color:t.priColor(t.task.pri)}},[t._v(t._s(t.task.priText))])],1),a("a-menu",{staticClass:"field-right-menu",attrs:{slot:"overlay",selectable:!1},on:{click:t.doPri},slot:"overlay"},[a("a-menu-item",{key:0},[a("div",{staticClass:"menu-item-content"},[a("a-tag",{attrs:{color:t.priColor(0)}},[t._v("普通")]),a("a-icon",{directives:[{name:"show",rawName:"v-show",value:0==t.task.pri,expression:"task.pri == 0"}],staticClass:"check muted",attrs:{type:"check"}})],1)]),a("a-menu-item",{key:1},[a("div",{staticClass:"menu-item-content"},[a("a-tag",{attrs:{color:t.priColor(1)}},[t._v("紧急")]),a("a-icon",{directives:[{name:"show",rawName:"v-show",value:1==t.task.pri,expression:"task.pri == 1"}],staticClass:"check muted",attrs:{type:"check"}})],1)]),a("a-menu-item",{key:2},[a("div",{staticClass:"menu-item-content"},[a("a-tag",{attrs:{color:t.priColor(2)}},[t._v("非常紧急")]),a("a-icon",{directives:[{name:"show",rawName:"v-show",value:2==t.task.pri,expression:"task.pri == 2"}],staticClass:"check muted",attrs:{type:"check"}})],1)])],1)],1)],1)])]),a("div",{staticClass:"component-mount task-tag"},[a("div",{staticClass:"field"},[a("div",{staticClass:"field-left"},[a("a-icon",{attrs:{type:"tag"}}),a("span",{staticClass:"field-name"},[t._v("标签")])],1),a("div",{staticClass:"field-right"},[a("div",{staticClass:"inline-block"},t._l(t.task.tags,(function(e,s){return a("a-tag",{key:s,attrs:{color:e.tag.color}},[t._v("\n                          "+t._s(e.tag.name)+"\n                          "),a("a-icon",{attrs:{type:"close"},on:{click:function(a){return t.removeTag(e.tag,s)}}})],1)})),1),a("a-dropdown",{attrs:{trigger:["click"],disabled:!!t.task.deleted,placement:"bottomCenter"},model:{value:t.visibleTaskTagMenu,callback:function(e){t.visibleTaskTagMenu=e},expression:"visibleTaskTagMenu"}},[t.task.deleted?t._e():a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("添加标签")])]),a("div",{staticClass:"inline-block"},[a("a-icon",{staticClass:"member-item invite",attrs:{type:"plus-circle",theme:"twoTone"}})],1)],2),a("div",{staticClass:"inline-block"},[a("a-icon",{staticClass:"member-item invite",attrs:{type:"plus-circle",theme:"twoTone"}})],1),a("div",{attrs:{slot:"overlay"},slot:"overlay"},[t.visibleTaskTagMenu?a("task-tag-menu",{attrs:{projectCode:t.projectCodeCurrent,taskCode:t.code},on:{change:t.taskTagChange,update:t.taskTagUpdate,delete:t.taskTagDelete}}):t._e()],1)],1)],1)])]),a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"field-left"},[a("a-icon",{attrs:{type:"bars"}}),a("span",{staticClass:"field-name"},[t._v("\n                        子任务\n                        "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.childTaskList.length,expression:"childTaskList.length"}]},[t._v("· "+t._s(t.childTaskDoneNum)+"/"+t._s(t.childTaskList.length))])])],1),a("div",{staticClass:"field-right width-block"})])]),a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"block-field width-block"},[a("div",{staticClass:"task-child"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.childTaskList.length,expression:"childTaskList.length"}],staticClass:"task-list"},t._l([0,1],(function(e){return a("div",{key:e},t._l(t.childTaskList,(function(s,i){return a("div",{key:s.code},[s.done==e?a("div",{staticClass:"list-item task"},[a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[s.parentDone?a("span",{staticStyle:{"font-size":"12px"}},[t._v("父任务已完成，无法重做子任务")]):s.hasUnDone?a("span",{staticStyle:{"font-size":"12px"}},[t._v("子任务尚未全部完成，无法完成父任务")]):t._e()]),a("div",{staticClass:"check-box-wrapper task-item",on:{click:function(e){return e.stopPropagation(),function(){if(t.task.deleted||s.parentDone||s.hasUnDone)return!1;t.taskDone(s.code,!s.done,i,"child")}()}}},[a("a-icon",{staticClass:"check-box",class:{disabled:t.task.deleted||s.parentDone||s.hasUnDone},style:{fontSize:"16px"},attrs:{type:s.done?"check-square":"border"}})],1)],2),a("a-dropdown",{attrs:{trigger:["click"],disabled:!!t.task.deleted,placement:"bottomCenter"},model:{value:s.visibleChildTaskMemberMenu,callback:function(e){t.$set(s,"visibleChildTaskMemberMenu",e)},expression:"childTask.visibleChildTaskMemberMenu"}},[a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[s.executor?a("span",[t._v(t._s(s.executor.name))]):a("span",[t._v("待认领")])]),s.executor?a("a-avatar",{staticClass:"task-item",class:{disabled:t.task.deleted},attrs:{size:"small",icon:"user",src:s.executor.avatar}}):a("a-avatar",{staticClass:"task-item",class:{disabled:t.task.deleted},attrs:{size:"small",icon:"user"}})],2),a("div",{attrs:{slot:"overlay"},slot:"overlay"},[s.visibleChildTaskMemberMenu?a("task-member-menu",{attrs:{projectCode:t.projectCodeCurrent,taskCode:s.code,isCommit:!0},on:{close:function(e){s.visibleChildTaskMemberMenu=!1,t.getChildTasks()},inviteProjectMember:function(e){t.showInviteMember=!0,s.visibleChildTaskMemberMenu=!1}}}):t._e()],1)],1),a("div",{staticClass:"task-item task-title",on:{click:function(e){return e.stopPropagation(),t.init(s.code)}}},[a("div",{staticClass:"title-text",class:{done:s.done}},[t._v(t._s(s.name))])]),a("a",{staticClass:"muted",on:{click:function(e){return e.stopPropagation(),t.init(s.code)}}},[a("a-icon",{staticClass:"task-item",attrs:{type:"right"}})],1)],1):t._e()])})),0)})),0),a("div",{directives:[{name:"show",rawName:"v-show",value:t.showChildTask,expression:"showChildTask"}],staticClass:"task-list"},[a("div",{staticClass:"add-task"},[a("div",{staticClass:"list-item task"},[a("span",{staticClass:"task-item check-box"}),a("a-dropdown",{attrs:{trigger:["click"],disabled:!!t.task.deleted,placement:"bottomCenter"},model:{value:t.visibleChildTaskMemberMenu,callback:function(e){t.visibleChildTaskMemberMenu=e},expression:"visibleChildTaskMemberMenu"}},[a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[t.childExecutor?a("span",[t._v(t._s(t.childExecutor.name))]):a("span",[t._v("待认领")])]),a("div",{staticClass:"field-flex"},[t.childExecutor?[a("a-avatar",{staticClass:"task-item",attrs:{src:t.childExecutor.avatar,icon:"user",size:"small"}})]:t._e(),t.childExecutor?t._e():[a("a-avatar",{staticClass:"task-item",attrs:{icon:"user",size:"small"}})]],2)],2),a("div",{attrs:{slot:"overlay"},slot:"overlay"},[t.visibleChildTaskMemberMenu?a("task-member-menu",{attrs:{projectCode:t.projectCodeCurrent,taskCode:t.childExecutor?t.code:"",isCommit:!1},on:{close:t.updateChildExecutor,inviteProjectMember:function(e){t.showInviteChildTaskMember=!0,t.visibleChildTaskMemberMenu=!1}}}):t._e()],1)],1),a("div",{staticClass:"task-item task-input"},[a("a-input",{on:{pressEnter:t.createTask},model:{value:t.childTaskName,callback:function(e){t.childTaskName=e},expression:"childTaskName"}})],1)],1),a("div",{staticClass:"action-btn text-right"},[a("a",{staticClass:"cancel-text muted",attrs:{type:"text"},on:{click:function(e){t.showChildTask=!1}}},[t._v("取消")]),a("a-button",{staticClass:"middle-btn",attrs:{type:"primary",htmlType:"submit"},on:{click:t.createTask}},[t._v("保存")])],1)])]),a("a-tooltip",{attrs:{placement:"top"}},[a("template",{slot:"title"},[t.task.done?a("span",{staticStyle:{"font-size":"12px"}},[t._v("父任务已完成，无法添加新的子任务")]):t._e()]),a("a",{directives:[{name:"show",rawName:"v-show",value:!t.showChildTask,expression:"!showChildTask"}],staticClass:"add-handler",class:{disabled:t.task.done},on:{click:function(){if(t.task.deleted||t.task.done)return!1;t.showChildTask=!0}}},[a("a-icon",{staticStyle:{"margin-right":"6px"},attrs:{type:"plus"}}),t._v("添加子任务\n                          ")],1)],2)],1)])])]),a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"field-left",staticStyle:{width:"100%"}},[a("a-icon",{attrs:{type:"clock-circle"}}),a("span",{staticClass:"field-name"},[t._v("\n                        工时\n                        "),t.workTimeList.length?a("span",[t._v("\n                          · 实际工时 "+t._s(t.workTimeTotal)+" 小时，工时记录 "+t._s(t.workTimeList.length)+" 条，预估工时 "+t._s(t.task.work_time)+" 小时\n                          "),a("a",{staticClass:"muted m-l-sm",on:{click:t.doPlainWorkTime}},[a("a-icon",{staticClass:"task-item",attrs:{type:"edit"}})],1)]):a("span",[t.task.work_time?a("span",[t._v("· 预估工时 "+t._s(t.task.work_time)+" 小时")]):t._e(),a("a-tooltip",[a("template",{slot:"title"},[a("span",[t._v("设置预估工时")])]),a("a",{staticClass:"muted m-l-sm",on:{click:t.doPlainWorkTime}},[a("a-icon",{staticClass:"task-item",attrs:{type:"edit"}})],1)],2)],1)])],1)])]),a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"block-field width-block"},[a("div",{staticClass:"task-child"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.workTimeList.length,expression:"workTimeList.length"}],staticClass:"task-list"},t._l(t.workTimeList,(function(e,s){return a("div",{key:e.code},[a("div",{staticClass:"list-item task m-l-xs"},[a("div",{staticClass:"task-item task-title hover-none"},[a("div",{staticClass:"title-text"},[a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[e.member?a("span",[t._v(t._s(e.member.name))]):a("span",[t._v("待认领")])]),a("a-avatar",{staticClass:"task-item",attrs:{size:"small",icon:"user",src:e.member.avatar}})],2),t._v("\n                                  "+t._s(e.member.name)+"\n                                  "+t._s(t.moment(e.begin_time).format("MM月DD日 HH:mm"))+"开始 工时为\n                                  "+t._s(e.num)+" 小时\n                                  "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.content,expression:"workTime.content"}],staticClass:"muted",staticStyle:{"padding-left":"40px","margin-top":"6px"}},[t._v(t._s(e.content))])],1)]),a("a",{staticClass:"muted",on:{click:function(a){return t.doWorkTime(e)}}},[a("a-icon",{staticClass:"task-item",attrs:{type:"edit"}})],1),a("a",{staticClass:"muted",on:{click:function(a){return t.deleteWorkTime(e,s)}}},[a("a-icon",{staticClass:"task-item",attrs:{type:"delete"}})],1)])])})),0),a("a-tooltip",{attrs:{placement:"top"}},[a("a",{staticClass:"add-handler",on:{click:function(e){return t.doWorkTime(!1)}}},[a("a-icon",{staticStyle:{"margin-right":"6px"},attrs:{type:"plus"}}),t._v("添加工时\n                          ")],1)])],1)])])]),a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"field-left"},[a("a-icon",{attrs:{type:"paper-clip"}}),a("span",{staticClass:"field-name"},[t._v("关联文件")])],1),a("div",{staticClass:"field-right width-block"})])]),a("div",{staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"block-field width-block"},[a("div",{staticClass:"task-child"},[a("a",{staticClass:"add-handler",attrs:{id:"upload-file"}},[a("a-icon",{staticStyle:{"margin-right":"6px"},attrs:{type:"plus"}}),t._v("上传文件\n                        ")],1)])])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.taskSourceList.length>0,expression:"taskSourceList.length > 0"}],staticClass:"component-mount"},[a("div",{staticClass:"field"},[a("div",{staticClass:"block-field width-block"},[a("div",{staticClass:"file-list"},[a("div",{staticClass:"m-xs m-t-none"},[t._v("关联的文件")]),a("a-list",t._l(t.taskSourceList,(function(e,s){return a("a-list-item",{key:s},[a("a-list-item-meta",[a("a-avatar",{attrs:{slot:"avatar",size:"small",shape:"square",icon:"link",src:e.sourceDetail.file_url},slot:"avatar"}),a("div",{attrs:{slot:"title"},slot:"title"},[a("a",{staticClass:"muted",attrs:{target:"_blank",href:e.sourceDetail.file_url}},[t._v("\n                                  "+t._s(e.title)+"\n                                ")])]),a("div",{attrs:{slot:"description"},slot:"description"})],1),a("a",{staticClass:"muted",attrs:{slot:"actions"},slot:"actions"},[a("span",[t._v(t._s(e.sourceDetail.projectName))])]),a("a",{staticClass:"muted",attrs:{slot:"actions"},slot:"actions"},[a("a-dropdown",{attrs:{trigger:["click"],placement:"bottomCenter"}},[a("a",{staticClass:"action-item muted"},[a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{directives:[{name:"clipboard",rawName:"v-clipboard",value:e.sourceDetail.file_url,expression:"item.sourceDetail.file_url"}],staticClass:"field-right-menu",attrs:{slot:"overlay"},on:{click:function(a){return t.doSource(a,e)}},slot:"overlay"},[a("a-menu-item",{key:"copy"},[a("a-icon",{attrs:{type:"link"}}),a("span",[t._v("复制链接")])],1),a("a-menu-item",{key:"unlink"},[a("a-icon",{attrs:{type:"disconnect"}}),a("span",[t._v("取消关联")])],1)],1)],1)],1)],1)})),1)],1)])])])])])])],1),a("div",{staticClass:"content-right"},[a("div",{staticClass:"header"},[a("div",{staticClass:"title"},[t._v("参与者 · "+t._s(t.taskMemberList.length))]),a("div",{staticClass:"member-list"},[t._l(t.taskMemberList,(function(e){return a("a-tooltip",{key:e.code,attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("\n                    "+t._s(e.name)+"\n                    "),e.is_owner?a("span",[t._v("· 创建者")]):t._e()])]),a("a-avatar",{staticClass:"member-item",attrs:{icon:"user",size:"small",src:e.avatar},on:{click:function(a){return t.routerLink("/members/profile/"+e.membar_account_code+"?key=3")}}})],2)})),a("a-dropdown",{attrs:{trigger:["click"],placement:"bottomCenter"},model:{value:t.visibleProjectMemberMenu,callback:function(e){t.visibleProjectMemberMenu=e},expression:"visibleProjectMemberMenu"}},[a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v("点击添加参与者")])]),a("a-icon",{staticClass:"member-item invite",staticStyle:{"font-size":"24px"},attrs:{type:"plus-circle",theme:"twoTone"}})],2),a("div",{attrs:{slot:"overlay"},slot:"overlay"},[t.visibleProjectMemberMenu?a("project-member-menu",{attrs:{taskCode:t.code,projectCode:t.projectCodeCurrent},on:{close:function(e){return t.init(!1)},inviteProjectMember:function(e){t.showInviteMember=!0,t.visibleProjectMemberMenu=!1}}}):t._e()],1)],1)],2)]),a("div",{staticClass:"log-wrap"},[a("div",{staticClass:"header"},[a("a-dropdown",{attrs:{trigger:["click"]}},[a("a",{staticClass:"text-default"},[t._v("\n                  所有动态\n                  "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{staticClass:"field-right-menu",attrs:{slot:"overlay",selectable:""},slot:"overlay",model:{value:t.taskLogType,callback:function(e){t.taskLogType=e},expression:"taskLogType"}},[a("a-menu-item",{key:"all"},[a("div",{staticClass:"menu-item-content"},[a("span",[t._v("所有动态")])])]),a("a-menu-item",{key:"comment"},[a("div",{staticClass:"menu-item-content"},[a("span",[t._v("仅评论")])])]),a("a-menu-item",{key:"log"},[a("div",{staticClass:"menu-item-content"},[a("span",[t._v("仅动态")])])])],1)],1)],1),a("vue-scroll",[a("div",{staticClass:"log-list muted"},[a("a",{directives:[{name:"show",rawName:"v-show",value:t.checkShowMoreLog,expression:"checkShowMoreLog"}],staticClass:"show-more muted",on:{click:t.getMoreTaskLog}},[a("a-icon",{attrs:{type:"ellipsis"}}),t._v("\n                  显示较早的 "+t._s(t.taskLogTotal-t.taskLogList.length)+" 条动态\n                ")],1),t._l(t.taskLogList,(function(e){return a("div",{key:e.code,class:{"log-comment":e.is_comment,"list-item":!e.is_comment}},[e.is_comment?t._e():[a("a-icon",{staticClass:"log-item",attrs:{type:e.icon}}),a("div",{staticClass:"log-item log-txt"},[a("div",[t._v("\n                        "+t._s(e.member.name)+"\n                        "),a("span",{domProps:{innerHTML:t._s(e.remark)}})]),e.content?a("div",{staticClass:"log-content",domProps:{innerHTML:t._s(e.content)}}):t._e()])],e.is_comment?[a("div",{staticClass:"log-txt text-default",staticStyle:{width:"100%",display:"flex","justify-content":"space-between"}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("a-avatar",{staticClass:"m-r-sm",staticStyle:{"margin-left":"-5px"},attrs:{size:24,src:e.member.avatar}}),a("div",[t._v(t._s(e.member.name))])],1),a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v(t._s(e.create_time))])]),a("span",{staticClass:"muted"},[t._v(t._s(t._f("formatLogTime")(e.create_time)))])],2)],1),a("div",{staticClass:"log-txt text-default",staticStyle:{padding:"0 0 0 30px"}},[a("div",{staticClass:"m-t-xs",domProps:{innerHTML:t._s(t.checkLink(e.content))}})])]:t._e(),e.is_comment?t._e():a("a-tooltip",{attrs:{mouseEnterDelay:.5}},[a("template",{slot:"title"},[a("span",[t._v(t._s(e.create_time))])]),a("span",[t._v(t._s(t._f("formatLogTime")(e.create_time)))])],2)],2)}))],2)])],1),a("div",{staticClass:"footer",attrs:{id:"footer"}},[a("a-popover",{attrs:{trigger:"click",placement:"top",visible:t.showMentions,arrowPointAtCenter:"",getPopupContainer:t.getPopup}},[a("template",{slot:"content"},[a("div",{staticClass:"mentions-content",staticStyle:{width:"200px"}},t._l(t.taskMemberList,(function(e){return a("div",{key:e.id,staticClass:"mentions-wrapper",on:{click:function(a){return t.selectMentionMember(e)}}},[a("a-avatar",{attrs:{src:e.avatar,icon:"user",size:28}}),a("span",{staticClass:"muted name m-l-xs"},[t._v(t._s(e.name))])],1)})),0)]),a("a-textarea",{ref:"commentText",staticStyle:{"margin-right":"24px"},attrs:{rows:1,placeholder:"支持@提及任务成员，Ctrl+Enter发表评论"},on:{focus:function(e){t.commenting=!0},blur:function(e){t.commenting=!1}},model:{value:t.comment,callback:function(e){t.comment=e},expression:"comment"}})],2),a("a-button",{staticClass:"middle-btn",attrs:{type:"primary"},on:{click:t.createComment}},[t._v("评论")])],1)])])])]),t.showInviteMember?a("invite-project-member",{attrs:{"project-code":t.projectCodeCurrent},model:{value:t.showInviteMember,callback:function(e){t.showInviteMember=e},expression:"showInviteMember"}}):t._e(),a("a-modal",{staticClass:"work-time-modal",attrs:{title:t.workTimeDo.modalTitle,bodyStyle:{paddingBottom:"1px"},confirmLoading:t.workTimeDo.confirmLoading},on:{ok:t.workTimeHandleSubmit},model:{value:t.workTimeDo.modalStatus,callback:function(e){t.$set(t.workTimeDo,"modalStatus",e)},expression:"workTimeDo.modalStatus"}},[a("a-form",{attrs:{layout:"vertical",form:t.workTimeDo.form},on:{submit:function(e){return e.preventDefault(),t.workTimeHandleSubmit(e)}}},[a("div",[a("div",{staticStyle:{"font-size":"15px"}},[t._v("登记任务")]),a("div",[t._v(t._s(t.task.name))]),a("a-divider",{staticClass:"m-t-xs m-b-md"})],1),a("div",{staticClass:"work-time-stats"},[a("div",{staticClass:"work-time-item"},[a("div",{staticClass:"muted title"},[t._v("预估工时")]),a("span",{staticClass:"work-time-num"},[t._v(t._s(t.task.work_time))]),a("span",[t._v("小时")])]),a("div",{staticClass:"work-time-item"},[a("div",{staticClass:"muted title"},[t._v("剩余工时")]),a("span",{staticClass:"work-time-num"},[t.task.work_time-t.workTimeTotal<0?[t._v("0")]:[t._v(t._s(t.task.work_time-t.workTimeTotal))]],2),a("span",[t._v("小时")])])]),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"开始时间"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["begin_time",{rules:[{required:!0,message:"请选择日期"}],validateTrigger:"change",initialValue:t.moment()}],expression:"[\n                              'begin_time',\n                              {rules: [{ required: true, message: '请选择日期' }], validateTrigger: 'change',initialValue: moment()}\n                          ]"}],attrs:{showTime:"",format:"YYYY年MM月DD日 HH:mm",allowClear:"",placeholder:"请选择日期"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"消耗时间"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["num",{rules:[{required:!0,message:"请输入消耗时间"}],validateTrigger:"change"}],expression:"[\n                              'num',\n                              {rules: [{ required: true, message: '请输入消耗时间' }], validateTrigger: 'change'}\n                          ]"}],attrs:{type:"text",placeholder:"请输入数字",addonAfter:"小时"}})],1)],1),a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"工作内容"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["content"],expression:"[\n                              'content',\n                          ]"}],attrs:{rows:4,type:"text",placeholder:"在这期间做了什么"}})],1)],1)],1)],1)],1),a("a-modal",{attrs:{title:t.plainWorkTime.modalTitle,bodyStyle:{paddingBottom:"1px"},confirmLoading:t.plainWorkTime.confirmLoading},on:{ok:t.workTimePlainHandleSubmit},model:{value:t.plainWorkTime.modalStatus,callback:function(e){t.$set(t.plainWorkTime,"modalStatus",e)},expression:"plainWorkTime.modalStatus"}},[a("a-form",{attrs:{layout:"vertical",form:t.plainWorkTime.form},on:{submit:function(e){return e.preventDefault(),t.workTimePlainHandleSubmit(e)}}},[a("a-form-item",{attrs:{label:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["work_time",{rules:[{required:!0,message:"请输入预估工时"}],validateTrigger:"change"}],expression:"[\n                              'work_time',\n                              {rules: [{ required: true, message: '请输入预估工时' }], validateTrigger: 'change'}\n                          ]"}],attrs:{type:"text",placeholder:"请输入数字",addonAfter:"小时"}})],1)],1)],1)],1)},i=[]},c9b7:function(t,e,a){"use strict";var s=a("1478"),i=a.n(s);i.a},e37d:function(t,e,a){"use strict";var s=a("d077"),i=a.n(s);i.a}}]);