(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-caa73d28"],{"1b80":function(t,n,a){"use strict";n["a"]={data:function(){return{pagination:{page:1,pageSize:10,total:0,showTotal:function(t,n){return"共 ".concat(t," 条")}}}},computed:{requestData:function(){return{page:this.pagination.page,pageSize:this.pagination.pageSize}}},methods:{init:function(){},pageChange:function(t){this.pagination.page=t,this.requestData.page=t.current,this.init()}}}},d368:function(t,n,a){"use strict";a.d(n,"c",(function(){return o})),a.d(n,"b",(function(){return i})),a.d(n,"a",(function(){return r}));var e=a("22b6");a("4360");function o(t){return e["a"].post("project/organization",t)}function i(t){var n="project/organization/save";return t.organizationCode&&(n="project/organization/edit"),e["a"].post(n,t)}function r(t){return e["a"].post("project/organization/_quitOrganization",t)}},dbff:function(t,n,a){"use strict";a.r(n);var e=function(){var t=this,n=this,a=n.$createElement,e=n._self._c||a;return e("div",{staticClass:"house-index"},[e("wrapper-content",[e("a-table",{attrs:{columns:n.columns,dataSource:n.dataSource,loading:n.loading,rowKey:"id",pagination:n.pagination},on:{change:n.pageChange},scopedSlots:n._u([{key:"action",fn:function(t,a,o){return[a.owner_code==n.userInfo.code?e("a",{on:{click:function(t){return n.rowClick(a,"edit")}}},[n._v("编辑")]):n._e(),a.owner_code!=n.userInfo.code?e("a",{on:{click:function(t){return n.rowClick(a,"quit")}}},[n._v("退出")]):n._e()]}}])})],1),e("a-modal",{attrs:{width:800,title:n.actionInfo.modalTitle,bodyStyle:{paddingBottom:"1px"},footer:null},model:{value:n.actionInfo.modalStatus,callback:function(t){n.$set(n.actionInfo,"modalStatus",t)},expression:"actionInfo.modalStatus"}},[e("a-form",{attrs:{autoFormCreate:function(n){t.form=n}},on:{submit:function(t){return t.preventDefault(),n.handleSubmit(t)}}},[e("a-form-item",{attrs:{form:n.form,label:"组织名称",labelCol:{span:3},wrapperCol:{span:21},fieldDecoratorId:"name",fieldDecoratorOptions:{rules:[{required:!0,message:"组织名称"}]},help:"必填，请填写组织名称"}},[e("a-input",{attrs:{placeholder:"组织名称"}})],1),e("a-form-item",{attrs:{label:"详细地址",labelCol:{span:3},wrapperCol:{span:21},fieldDecoratorId:"address",help:"详细地址"}},[e("a-input")],1),e("a-form-item",{attrs:{wrapperCol:{span:21,offset:3}}},[e("div",{staticClass:"action-btn"},[e("a-button",{staticClass:"middle-btn",attrs:{type:"primary",htmlType:"submit",loading:n.actionInfo.confirmLoading}},[n._v("保存")]),e("a-button",{staticClass:"middle-btn",on:{click:function(t){n.actionInfo.modalStatus=!1}}},[n._v("取消")])],1)])],1)],1)],1)},o=[],i=(a("8e6e"),a("ac6a"),a("456d"),a("6b54"),a("7f7f"),a("bd86")),r=a("5880"),c=a("d368"),s=a("2f14"),d=a("1b80");function u(t,n){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),a.push.apply(a,e)}return a}function l(t){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?u(Object(a),!0).forEach((function(n){Object(i["a"])(t,n,a[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(a,n))}))}return t}var f=[{title:"组织名称",dataIndex:"name",width:"30%"},{title:"操作",scopedSlots:{customRender:"action"}}],p={mixins:[d["a"]],data:function(){return{columns:f,dataSource:[],loading:!0,newData:{code:0},form:{},searchForm:{},actionInfo:{modalStatus:!1,confirmLoading:!1,modalTitle:"编辑组织",okText:"保存",cancelText:"放弃"},showMap:!1,options:[]}},computed:l({},Object(r["mapState"])({userInfo:function(t){return t.userInfo}})),created:function(){this.init()},methods:{moment:moment,init:function(t){var n=this;n.loading=!0,Object(c["c"])(n.requestData).then((function(a){n.dataSource=a.data.list,n.pagination.total=a.data.total,n.loading=!1,t&&n.$store.dispatch("setCurrentOrganization",a.data.list[0]),n.$store.dispatch("setOrganizationList",a.data.list)}))},rowClick:function(t,n){var a=this;a.newData={code:""},"add"==n||"edit"==n||"new"==n?(setTimeout((function(){a.form&&a.form.resetFields()}),0),a.actionInfo.modalStatus=!0,a.actionInfo.modalTitle="添加组织","edit"==n&&setTimeout((function(){a.actionInfo.modalTitle="编辑组织",a.form.setFieldsValue({name:t.name,areas:[t.province.toString(),t.city.toString(),t.area.toString()],address:t.address}),a.newData=t}),0)):"quit"==n&&this.$confirm({title:"确定要退出此组织?",okText:"退出",okType:"danger",cancelText:"再想想",onOk:function(){return Object(c["a"])({organizationCode:t.code}).then((function(t){Object(s["a"])(t)&&a.init(!0)})),Promise.resolve()}})},handleSubmit:function(){var t=this;t.form.validateFields((function(n,a){n||t.handleOk()}))},handleOk:function(){var t=this;t.actionInfo.confirmLoading=!0;var n=t.form.getFieldsValue();n.areas=JSON.stringify(n.areas),console.log(t.newData),t.newData.code?(t.newData.organizationCode=t.newData.code,n.organizationCode=t.newData.code):Object.assign(n,t.newData),Object(c["b"])(n).then((function(a){t.actionInfo.confirmLoading=!1,Object(s["a"])(a)&&(t.newData.code?(t.newData.name=n.name,t.newData.address=n.address):t.dataSource.push(a.data),t.form.resetFields(),t.newData={code:0},t.actionInfo.modalStatus=!1,t.init())}))}}},m=p,g=a("2877"),b=Object(g["a"])(m,e,o,!1,null,null,null);n["default"]=b.exports}}]);