(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45ab33f9"],{"1ee8":function(t,e,i){},4540:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"member-menu",class:{creating:t.creating,editing:t.editing}},[i("a-spin",{attrs:{spinning:t.listLoading}},[i("div",{staticClass:"search-content"},[i("a-input",{attrs:{size:"large",placeholder:t.creating||t.editing?"标签名称":"搜索标签"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[t.creating||t.editing?i("a-icon",{attrs:{slot:"prefix",type:"tag"},slot:"prefix"}):i("a-icon",{attrs:{slot:"prefix",type:"search"},slot:"prefix"})],1)],1),i("div",{staticClass:"member-list tag-list"},[t.creating||t.editing?t._e():[i("vue-scroll",[i("div",{staticClass:"list-group"},[i("a-list",{directives:[{name:"show",rawName:"v-show",value:t.list.length,expression:"list.length"}],staticClass:"list-content",attrs:{itemLayout:"horizontal",dataSource:t.list},scopedSlots:t._u([{key:"renderItem",fn:function(e,n){return i("a-list-item",{staticClass:"member-list-item",nativeOn:{click:function(i){return t.setTag(e)}}},[i("span",{attrs:{slot:"actions"},slot:"actions"},[i("a",{staticClass:"tag-edit muted"},[i("a-icon",{attrs:{type:"edit"},on:{click:function(i){return i.stopPropagation(),t.editTag(e,n)}}})],1),i("a-icon",{directives:[{name:"show",rawName:"v-show",value:t.showCheck(e),expression:"showCheck(item)"}],staticClass:"m-l-sm",attrs:{type:"check"}})],1),i("a-list-item-meta",[i("span",{staticClass:"tag-title",attrs:{slot:"title"},slot:"title"},[i("a-badge",{class:"badge-"+e.color,attrs:{status:"success"}}),t._v("\n                    "+t._s(e.name)+"\n                  ")],1)])],1)}}],null,!1,2674320970)})],1)])],t.creating||t.editing?[i("div",{staticClass:"tag-badge"},t._l(t.badgeList,(function(e){return i("span",{key:e,staticClass:"badge-item",on:{click:function(i){t.currentBadge=e}}},[i("a-badge",{class:"badge-"+e,attrs:{status:"success"}}),i("a-icon",{directives:[{name:"show",rawName:"v-show",value:t.currentBadge==e,expression:"currentBadge == badge"}],attrs:{type:"check"}})],1)})),0)]:t._e()],2),i("div",{staticClass:"footer"},[t.creating?[i("a-button",{attrs:{type:"default",size:"large"},on:{click:function(e){t.creating=!1,t.keyword=""}}},[t._v("取消")]),i("a-button",{attrs:{type:"primary",disabled:!t.keyword,size:"large"},on:{click:t.createTag}},[t._v("创建")])]:t.editing?[i("a-popconfirm",{attrs:{overlayStyle:{zIndex:"1080"},title:"确认删除标签？",okText:"确定",cancelText:"取消"},on:{confirm:t.deleteTag}},[i("a-button",{attrs:{type:"danger",size:"large"}},[t._v("删除")])],1),i("a-button",{attrs:{type:"primary",disabled:!t.keyword,size:"large"},on:{click:t.saveTag}},[t._v("完成")])]:[i("a-button",{attrs:{type:"primary",size:"large",block:""},on:{click:function(e){t.creating=!0,t.activeCreating=!0}}},[t._v("新建标签")])]],2)])],1)},s=[],a=(i("7f7f"),i("20d6"),i("386d"),i("c5f6"),i("2ef0"),i("db9e6")),r=i("ca8d"),o=i("2f14"),c={name:"taskTagMenu",props:{projectCode:{type:[String,Number],default:function(){return""}},taskCode:{type:[String,Number],default:function(){return""}},isCommit:{type:[Boolean],default:function(){return!0}}},data:function(){return{keyword:"",editing:!1,creating:!1,activeCreating:!1,searching:!1,listLoading:!1,showInviteMember:!1,tags:[],list:[],listTemp:[],badgeList:["blue","red","orange","green","brown","purple"],currentBadge:"blue",currentTag:{tag:null,index:-1}}},created:function(){this.init()},watch:{keyword:function(){this.search()}},methods:{init:function(){var t=this;this.projectCode&&(this.listLoading=!0,Object(a["c"])({projectCode:this.projectCode}).then((function(e){t.list=e.data,t.listTemp=e.data,t.listLoading=!1}))),this.taskCode&&Object(r["u"])({taskCode:this.taskCode}).then((function(e){t.tags=e.data}))},showCheck:function(t){var e=this.tags.findIndex((function(e){return e.tag_code==t.code}));if(-1!==e)return!0},checkTaskChange:function(t){var e=this.tags.findIndex((function(e){return e.tag_code==t.code}));-1!==e?this.tags.splice(e,1):this.tags.push({tag_code:t.code})},editTag:function(t,e){this.editing=!0,this.keyword=t.name,this.currentBadge=t.color,this.currentTag.tag=t,this.currentTag.index=e},saveTag:function(){var t=this;Object(a["b"])({name:this.keyword,color:this.currentBadge,tagCode:this.currentTag.tag.code}).then((function(e){if(!Object(o["a"])(e))return!1;t.currentTag.tag.name=t.listTemp[t.currentTag.index].name=t.keyword,t.currentTag.tag.color=t.listTemp[t.currentTag.index].color=t.currentBadge,t.$emit("update",t.currentTag.tag),t.clearCreating()}))},deleteTag:function(){var t=this;Object(a["a"])(this.currentTag.tag.code).then((function(e){if(!Object(o["a"])(e))return!1;t.listTemp.splice(t.currentTag.index,1),t.$emit("delete",t.currentTag.tag),t.clearCreating()}))},setTag:function(t){var e=this;this.checkTaskChange(t),this.isCommit?Object(r["q"])({taskCode:this.taskCode,tagCode:t.code}).then((function(){e.$emit("change",t)})):this.$emit("change",t)},createTag:function(){var t=this;Object(a["d"])({projectCode:this.projectCode,name:this.keyword,color:this.currentBadge}).then((function(e){if(!Object(o["a"])(e))return!1;var i=e.data;t.listTemp.push(i),t.list.push(i),t.checkTaskChange(i),Object(r["q"])({taskCode:t.taskCode,tagCode:i.code}).then((function(){t.$emit("change",i),t.clearCreating()}))}))},clearCreating:function(){this.editing=!1,this.creating=!1,this.activeCreating=!1,this.keyword=""},search:function(){var t=this;this.keyword=this.keyword.trim(),this.keyword||(this.list=JSON.parse(JSON.stringify(this.listTemp)),this.activeCreating||(this.creating=!1)),this.searching=!0,this.list=this.list.filter((function(e){return-1!=e.name.indexOf(t.keyword)})),this.list.length||this.editing||(this.creating=!0)}}},u=c,d=(i("ae2c"),i("2877")),l=Object(d["a"])(u,n,s,!1,null,null,null);e["default"]=l.exports},a532:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{style:t.styleObject},[i("div",{ref:"editor",style:t.styleObject,attrs:{id:t.id}})])},s=[],a=(i("28a5"),i("a481"),i("ac6a"),i("1a0b")),r=i.n(a),o=i("2ef0"),c=i.n(o),u={name:"editor",props:["id","value","width","height","uploadImgServer","disabled","menus","mapKey","menuFixed","pasteFilter","codeDefaultLang","hideLinkImg","uploadImgParams","uploadImgHeaders","isRealtime","disabledMenus","uploadFileName","uploadImgShowBase64"],data:function(){return{styleObject:{width:"auto",height:"auto"},editor:null}},methods:{initSize:function(){this.width&&(this.styleObject.width=this.width+"px"),this.height&&(this.styleObject.height=this.height+"px")},createEditor:function(){this.editor=new r.a(document.getElementById(this.id)),this.initConfig(),this.editor.create()},initConfig:function(){this.editor.customConfig.uploadFileName=this.uploadFileName?this.uploadFileName:"image[]",this.editor.customConfig.uploadImgServer=this.uploadImgServer,this.editor.customConfig.uploadImgShowBase64=!!this.uploadImgShowBase64&&this.uploadImgShowBase64,this.editor.customConfig.uploadImgFileName="file",this.editor.customConfig.pasteFilter=!1,void 0!=this.mapKey&&(this.editor.customConfig.mapAk=this.mapKey),void 0!=this.menus&&this.menus instanceof Array&&this.menus.length?this.editor.customConfig.menus=this.filterMenu(this.menus):this.disabledMenus&&(this.editor.customConfig.menus=this.filterDisabledMenu(this.editor.customConfig.menus,this.disabledMenus)),void 0!=this.menuFixed&&(this.editor.customConfig.menuFixed=this.menuFixed),void 0!=this.pasteFilter&&(this.editor.customConfig.pasteFilter=this.pasteFilter),void 0!=this.codeDefaultLang&&(this.editor.customConfig.codeDefaultLang=this.codeDefaultLang),void 0!=this.hideLinkImg&&(this.editor.customConfig.hideLinkImg=this.hideLinkImg),void 0!=this.uploadImgParams&&this.uploadImgParams instanceof Object&&(this.editor.customConfig.uploadImgParams=this.uploadImgParams),void 0!=this.uploadImgHeaders&&this.uploadImgHeaders instanceof Object&&(this.editor.customConfig.uploadImgHeaders=this.uploadImgHeaders),this.value&&this.setHtml(this.value),this.disabled&&this.disable(),this.listenChange()},filterMenu:function(t){return window.__.map(t,(function(t,e){return"source"===t?null:t}))},filterDisabledMenu:function(t,e){var i=t.join(",");return c()(e).forEach((function(t){i=i.replace(t,"").replace(",,",",")})),i.length&&","==i[0]&&i.substr(1,i.length),i.split(",")},insertImg:function(t){this.editor.command(null,"insertHtml","<img src="+t+' style="max-width:100%;"/>')},getHtml:function(){return this.editor.txt.html()},getText:function(){return this.editor.txt.text()},setHtml:function(t){this.editor.txt.html(t)},appendHtml:function(t){this.editor.txt.append(t)},clear:function(){this.editor.clear()},enable:function(){this.editor.enable()},disable:function(){this.editor.disable()},destroy:function(){this.editor.destroy()},undestroy:function(){this.editor.undestroy()},listenChange:function(){var t=this;this.editor.onchange=function(){t.$emit("change");var e="";t.getText()||(e=t.getHtml()),!1!==t.isRealtime&&t.$emit("input",e)}}},mounted:function(){var t=this;this.initSize(),setTimeout((function(){t.createEditor()}),100)}},d=u,l=i("2877"),h=Object(l["a"])(d,n,s,!1,null,null,null);e["default"]=h.exports},ae2c:function(t,e,i){"use strict";var n=i("1ee8"),s=i.n(n);s.a},c030:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return a})),i.d(e,"d",(function(){return r})),i.d(e,"c",(function(){return o}));var n=i("22b6");function s(t,e){return n["a"].post("project/project_member/inviteMember",{memberCode:t,projectCode:e})}function a(t){return n["a"].post("project/project_member/_joinByInviteLink",{inviteCode:t})}function r(t,e){return n["a"].post("project/project_member/removeMember",{memberCode:t,projectCode:e})}function o(t){return n["a"].post("project/project_member/index",t)}},c995:function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var n=i("22b6");function s(t){return n["a"].post("project/task_member",t)}},ca8d:function(t,e,i){"use strict";i.d(e,"j",(function(){return s})),i.d(e,"h",(function(){return a})),i.d(e,"o",(function(){return r})),i.d(e,"t",(function(){return o})),i.d(e,"r",(function(){return c})),i.d(e,"m",(function(){return u})),i.d(e,"u",(function(){return d})),i.d(e,"q",(function(){return l})),i.d(e,"b",(function(){return h})),i.d(e,"c",(function(){return m})),i.d(e,"s",(function(){return f})),i.d(e,"p",(function(){return g})),i.d(e,"l",(function(){return p})),i.d(e,"k",(function(){return k})),i.d(e,"e",(function(){return v})),i.d(e,"d",(function(){return C})),i.d(e,"i",(function(){return b})),i.d(e,"a",(function(){return y})),i.d(e,"n",(function(){return w})),i.d(e,"g",(function(){return j})),i.d(e,"f",(function(){return T}));var n=i("22b6");function s(t){return n["a"].post("project/task",t)}function a(t){return n["a"].post("project/task/getListByTaskTag",t)}function r(t){return n["a"].post("project/task/selfList",t)}function o(t){return n["a"].post("project/task/taskSources",t)}function c(t){return n["a"].post("project/task/sort",t)}function u(t){return n["a"].post("project/task/save",t)}function d(t){return n["a"].post("project/task/taskToTags",t)}function l(t){return n["a"].post("project/task/setTag",t)}function h(t){return n["a"].post("project/task/assignTask",t)}function m(t){return n["a"].post("project/task/batchAssignTask",t)}function f(t,e){return n["a"].post("project/task/taskDone",{taskCode:t,done:e})}function g(t,e){return n["a"].post("project/task/setPrivate",{taskCode:t,private:e})}function p(t){return n["a"].post("project/task/recycleBatch",t)}function k(t){return n["a"].post("project/task/recovery",{taskCode:t})}function v(t){return n["a"].post("project/task/delete",{taskCode:t})}function C(t){return n["a"].post("project/task/dateTotalForProject",t)}function b(t){return n["a"].post("project/project/getLogBySelfProject",t)}function y(t){return n["a"].post("project/task/_taskWorkTimeList",t)}function w(t){return n["a"].post("project/task/saveTaskWorkTime",t)}function j(t){return n["a"].post("project/task/editTaskWorkTime",t)}function T(t){return n["a"].post("project/task/delTaskWorkTime",t)}},cff3:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return a}));var n=i("22b6");i("2f14");function s(t,e){return n["a"].post("project/department_member/removeMember",{accountCode:t,departmentCode:e})}function a(t){return n["a"].post("project/department_member/detail",t)}},db9e6:function(t,e,i){"use strict";i.d(e,"c",(function(){return s})),i.d(e,"d",(function(){return a})),i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return o}));var n=i("22b6");function s(t){return n["a"].post("project/task_tag",t)}function a(t){return n["a"].post("project/task_tag/save",t)}function r(t){return n["a"].post("project/task_tag/edit",t)}function o(t){return n["a"].post("project/task_tag/delete",{tagCode:t})}},f66c:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"member-menu"},[i("a-spin",{attrs:{spinning:t.listLoading||t.doListLoading}},[i("div",{staticClass:"search-content"},[i("a-input",{attrs:{size:"large",placeholder:"搜索"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[i("a-icon",{attrs:{slot:"prefix",type:"search"},slot:"prefix"})],1)],1),i("div",{staticClass:"member-list"},[i("vue-scroll",[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.keyword,expression:"!keyword"}],staticClass:"list-group"},[i("span",{staticClass:"title muted"},[t._v("执行者")]),t.doList.length||t.doListLoading?t._e():i("div",{staticClass:"member-list-item ant-list-item",on:{click:function(e){return t.assignTask(null)}}},[i("div",{staticClass:"ant-list-item-meta"},[i("div",{staticClass:"ant-list-item-meta-avatar"},[i("a-avatar",{attrs:{icon:"user"}})],1),i("div",{staticClass:"ant-list-item-meta-content"},[i("h4",{staticClass:"ant-list-item-meta-title"},[i("span",[t._v("待认领")])])])]),i("ul",{staticClass:"ant-list-item-action"},[i("li",[i("span",[i("a-icon",{attrs:{type:"check"}})],1)])])]),i("a-list",{directives:[{name:"show",rawName:"v-show",value:t.doList.length,expression:"doList.length"}],staticClass:"list-content",attrs:{itemLayout:"horizontal",dataSource:t.doList},scopedSlots:t._u([{key:"renderItem",fn:function(e){return i("a-list-item",{staticClass:"member-list-item"},[i("span",{attrs:{slot:"actions"},slot:"actions"},[i("a-icon",{directives:[{name:"show",rawName:"v-show",value:t.showCheck(e),expression:"showCheck(item)"}],attrs:{type:"check"}})],1),i("a-list-item-meta",[i("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name))]),i("a-avatar",{attrs:{slot:"avatar",icon:"user",src:e.avatar},slot:"avatar"})],1)],1)}}])})],1),i("div",{staticClass:"list-group"},[i("span",{staticClass:"title muted"},[t._v("其他成员")]),t.doList.length?i("div",{staticClass:"member-list-item ant-list-item",on:{click:function(e){return t.assignTask(null)}}},[i("div",{staticClass:"ant-list-item-meta"},[i("div",{staticClass:"ant-list-item-meta-avatar"},[i("a-avatar",{attrs:{icon:"user"}})],1),i("div",{staticClass:"ant-list-item-meta-content"},[i("h4",{staticClass:"ant-list-item-meta-title"},[i("span",[t._v("待认领")])])])])]):t._e(),i("a-list",{staticClass:"list-content",attrs:{itemLayout:"horizontal",dataSource:t.list,locale:{emptyText:t.keyword&&t.keyword.length>1?"该成员不在任务成员列表中，你可以邀请他进来":""}},scopedSlots:t._u([{key:"renderItem",fn:function(e){return t.showMember(e)?i("a-list-item",{staticClass:"member-list-item",nativeOn:{click:function(i){return t.assignTask(e.code,e)}}},[i("a-list-item-meta",[i("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name))]),i("a-avatar",{attrs:{slot:"avatar",icon:"user",src:e.avatar},slot:"avatar"})],1)],1):t._e()}}],null,!0)})],1)])],1),i("div",{staticClass:"footer"},[i("a-button",{attrs:{type:"primary",size:"large",block:""},on:{click:t.inviteProjectMember}},[t._v("邀请新成员")])],1)])],1)},s=[],a=(i("7f7f"),i("ac6a"),i("386d"),i("c5f6"),i("2ef0")),r=i.n(a),o=i("c030"),c=i("c995"),u=i("ca8d"),d={name:"taskMemberMenu",props:{projectCode:{type:[String,Number],default:function(){return""}},taskCode:{type:[String,Number],default:function(){return""}},isCommit:{type:[Boolean],default:function(){return!0}}},data:function(){return{keyword:"",searching:!1,doListLoading:!1,listLoading:!1,showInviteMember:!1,doList:[],list:[],listTemp:[]}},created:function(){this.init()},watch:{keyword:function(){this.search()}},methods:{init:function(){var t=this;this.projectCode&&(this.listLoading=!0,Object(o["c"])({projectCode:this.projectCode,pageSize:300}).then((function(e){t.list=e.data.list,t.listTemp=e.data.list,t.listLoading=!1}))),this.taskCode&&(this.doListLoading=!0,Object(c["a"])({taskCode:this.taskCode,pageSize:300}).then((function(e){t.doList=e.data.list.filter((function(t){return t.is_executor})),t.doListLoading=!1})))},showMember:function(t){var e=!0;return this.doList.forEach((function(i){t.code==i.code&&(e=!1)})),e},showCheck:function(t){if(t.is_executor)return!0},assignTask:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.isCommit?Object(u["b"])({taskCode:this.taskCode,executorCode:t}).then((function(){e.$emit("close",i)})):this.$emit("close",i)},inviteProjectMember:function(){this.$emit("inviteProjectMember")},search:r.a.debounce((function(){var t=this;if(this.keyword=this.keyword.trim(),this.keyword||(this.list=JSON.parse(JSON.stringify(this.listTemp))),this.keyword.length<=1)return!1;this.searching=!0,this.list=this.list.filter((function(e){return-1!=e.name.indexOf(t.keyword)}))}),500)}},l=d,h=i("2877"),m=Object(h["a"])(l,n,s,!1,null,null,null);e["default"]=m.exports}}]);